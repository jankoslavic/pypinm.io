<!DOCTYPE html>
<html lang="en">
    <head>
<!-- Global site tag (gtag.js) - Google Analytics -->
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-580147-3"></script>
<script>
  window.dataLayer = window.dataLayer || [];
  function gtag(){dataLayer.push(arguments);}
  gtag('js', new Date());

  gtag('config', 'UA-580147-3');
</script>
        <meta charset="utf-8">
        <meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1">
        <meta name="author" content="Janko Slavič">
        <meta name="description" content="">
        <meta name="viewport" content="width=device-width">
        <title>Numerično integriranje | Programiranje in numerične metode v ekosistemu Pythona</title>

	<link rel="shortcut icon" href="/favicon.ico" type="image/x-icon">
	<link rel="icon" href="/favicon.ico" type="image/x-icon">
        <link rel="alternate" type="application/atom+xml" title="Programiranje in numerične metode v ekosistemu Pythona blog atom feed" href="/feeds/all.atom.xml" />
        <link href='https://fonts.googleapis.com/css?family=Source+Sans+Pro:300,400,700' rel='stylesheet' type='text/css'>

        <link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.7/css/bootstrap.min.css" integrity="sha384-BVYiiSIFeK1dGmJRAkycuHAHRg32OmUcww7on3RYdg4Va+PmSTsz/K68vbdEjh4u" crossorigin="anonymous">
        <link rel="stylesheet" type="text/css" href="/theme/css/icons.css"/>
        <style>.highlight .hll { background-color: #ffffcc }
.highlight .c { color: #60a0b0; font-style: italic } /* Comment */
.highlight .err { border: 1px solid #FF0000 } /* Error */
.highlight .k { color: #007020; font-weight: bold } /* Keyword */
.highlight .o { color: #666666 } /* Operator */
.highlight .cm { color: #60a0b0; font-style: italic } /* Comment.Multiline */
.highlight .cp { color: #007020 } /* Comment.Preproc */
.highlight .c1 { color: #60a0b0; font-style: italic } /* Comment.Single */
.highlight .cs { color: #60a0b0; background-color: #fff0f0 } /* Comment.Special */
.highlight .gd { color: #A00000 } /* Generic.Deleted */
.highlight .ge { font-style: italic } /* Generic.Emph */
.highlight .gr { color: #FF0000 } /* Generic.Error */
.highlight .gh { color: #000080; font-weight: bold } /* Generic.Heading */
.highlight .gi { color: #00A000 } /* Generic.Inserted */
.highlight .go { color: #808080 } /* Generic.Output */
.highlight .gp { color: #c65d09; font-weight: bold } /* Generic.Prompt */
.highlight .gs { font-weight: bold } /* Generic.Strong */
.highlight .gu { color: #800080; font-weight: bold } /* Generic.Subheading */
.highlight .gt { color: #0040D0 } /* Generic.Traceback */
.highlight .kc { color: #007020; font-weight: bold } /* Keyword.Constant */
.highlight .kd { color: #007020; font-weight: bold } /* Keyword.Declaration */
.highlight .kn { color: #007020; font-weight: bold } /* Keyword.Namespace */
.highlight .kp { color: #007020 } /* Keyword.Pseudo */
.highlight .kr { color: #007020; font-weight: bold } /* Keyword.Reserved */
.highlight .kt { color: #902000 } /* Keyword.Type */
.highlight .m { color: #40a070 } /* Literal.Number */
.highlight .s { color: #4070a0 } /* Literal.String */
.highlight .na { color: #4070a0 } /* Name.Attribute */
.highlight .nb { color: #007020 } /* Name.Builtin */
.highlight .nc { color: #0e84b5; font-weight: bold } /* Name.Class */
.highlight .no { color: #60add5 } /* Name.Constant */
.highlight .nd { color: #555555; font-weight: bold } /* Name.Decorator */
.highlight .ni { color: #d55537; font-weight: bold } /* Name.Entity */
.highlight .ne { color: #007020 } /* Name.Exception */
.highlight .nf { color: #06287e } /* Name.Function */
.highlight .nl { color: #002070; font-weight: bold } /* Name.Label */
.highlight .nn { color: #0e84b5; font-weight: bold } /* Name.Namespace */
.highlight .nt { color: #062873; font-weight: bold } /* Name.Tag */
.highlight .nv { color: #bb60d5 } /* Name.Variable */
.highlight .ow { color: #007020; font-weight: bold } /* Operator.Word */
.highlight .w { color: #bbbbbb } /* Text.Whitespace */
.highlight .mf { color: #40a070 } /* Literal.Number.Float */
.highlight .mh { color: #40a070 } /* Literal.Number.Hex */
.highlight .mi { color: #40a070 } /* Literal.Number.Integer */
.highlight .mo { color: #40a070 } /* Literal.Number.Oct */
.highlight .sb { color: #4070a0 } /* Literal.String.Backtick */
.highlight .sc { color: #4070a0 } /* Literal.String.Char */
.highlight .sd { color: #4070a0; font-style: italic } /* Literal.String.Doc */
.highlight .s2 { color: #4070a0 } /* Literal.String.Double */
.highlight .se { color: #4070a0; font-weight: bold } /* Literal.String.Escape */
.highlight .sh { color: #4070a0 } /* Literal.String.Heredoc */
.highlight .si { color: #70a0d0; font-style: italic } /* Literal.String.Interpol */
.highlight .sx { color: #c65d09 } /* Literal.String.Other */
.highlight .sr { color: #235388 } /* Literal.String.Regex */
.highlight .s1 { color: #4070a0 } /* Literal.String.Single */
.highlight .ss { color: #517918 } /* Literal.String.Symbol */
.highlight .bp { color: #007020 } /* Name.Builtin.Pseudo */
.highlight .vc { color: #bb60d5 } /* Name.Variable.Class */
.highlight .vg { color: #bb60d5 } /* Name.Variable.Global */
.highlight .vi { color: #bb60d5 } /* Name.Variable.Instance */
.highlight .il { color: #40a070 } /* Literal.Number.Integer.Long */</style>
        <style>body {
  margin: 0;
  padding: 0;
  font: 15px 'Source Sans Pro', sans-serif;
  line-height: 1.6em;
  color: #222;
  text-rendering: optimizeLegibility;
  -webkit-font-smoothing: antialiased;
}
a {
  color: #007EE5;
  text-decoration: none;
}
a:hover {
  color: #007EE5;
  text-decoration: none;
}
header.main-header {
  background: none repeat scroll 0% 0% #205F29;
  margin-bottom: 0px;
}
header.main-header a {
  color: #fff;
}
header.main-header .container {
  max-width: 1000px;
}
header.main-header .container nav a:hover {
  background-color: #5C881C;
}
article {
  margin: 0;
}
article header.about {
  margin-bottom: 0px;
  padding-bottom: 0px;
}
article header {
  margin-bottom: 20px;
  padding-bottom: 20px;
}
article header h1 {
  margin-bottom: 2px;
  font-weight: 700;
  color: #000;
}
article header time {
  color: #9E9E9E;
  font-size: 0.85em;
  float: right;
}
article header time.left {
  color: #9E9E9E;
  font-size: 0.85em;
  float: left;
}
article div.social-links ul {
  padding: 0px;
}
article div.social-links li {
  display: inline;
  font-size: 20px;
}
article div.social-links li a {
  color: #000;
  padding: 10px;
}
article div.social-links li a:hover {
  color: #666;
  text-decoration: none;
}
article p {
  font-size: 16px;
  margin-bottom: 20px;
  line-height: 1.6em;
}
article p.note {
  background: #f5f5f5;
  border: 1px solid #ddd;
  padding: 0.533em 0.733em;
}
article p.update {
  background-color: #FEEFB3;
  border: 1px solid #e6e68a;
  padding: 0.533em 0.733em;
}
article p.alert {
  background-color: #ffe2e2;
  border: 1px solid #ffb2b2;
  padding: 0.533em 0.733em;
}
article ul,
article ol {
  margin-top: 0px;
  margin-bottom: 25px;
}
article li {
  font-size: 16px;
  line-height: 1.6em;
}
article a:hover {
  text-decoration: underline;
}
article blockquote {
  border-left: 2px solid #c7c7cc;
  color: #666;
  margin: 30px 0;
  padding: 0 0 0 25px;
}
article img {
  max-width: 100%;
}
article code {
  color: #333;
  background-color: #EEE;
  border-radius: 0;
  font-size: 13px;
}
article .meta {
  font-size: 11px;
}
article .meta a:hover {
  text-decoration: none;
}
article .meta div {
  margin-bottom: 20px;
  display: block;
}
article .meta a.tag {
  margin: 0 10px 10px 0;
  padding: 1px 12px;
  display: inline-block;
  font-size: 14px;
  color: rgba(0, 0, 0, 0.8);
  background: rgba(0, 0, 0, 0.05);
}
article .meta a.tag:hover {
  background: rgba(0, 0, 0, 0.15);
}
article .meta a.read_more,
article .meta a.comments_btn {
  font-size: 14px;
  font-weight: 800;
  padding: 10px 20px;
  color: #205F29;
  background: #FFF;
  border: 1px solid #205F29;
}
article .meta a.read_more:hover,
article .meta a.comments_btn:hover {
  color: #FFF;
  background: #5C881C;
}
.index {
  max-width: 700px;
}
.index article header h2 {
  font-size: 36px;
  margin-bottom: 2px;
  font-weight: 700;
}
.index article header h2 a {
  color: #000;
}
.index article header h2 a:hover {
  color: #007EE5;
  text-decoration: none;
}
.index .separator {
  padding: 40px 0 0 0;
  margin: 0 0 40px 0;
  height: 10px;
  border-bottom: solid 1px #CCC;
}
.index .pagination {
  display: block;
  margin-bottom: 100px;
}
.index .pagination .left {
  text-align: right;
}
.index .pagination .right {
  text-align: left;
}
.index .pagination a {
  display: inline-block;
  border: 2px solid #5C881C;
  margin: 0 5px;
  padding: 8px 20px;
  font-weight: bold;
  color: #5C881C;
}
.index .pagination a:hover {
  color: #FFF;
  background: #5C881C;
}
.post {
  max-width: 700px;
}
.post h2:before {
  content: "# ";
  font-weight: bold;
  color: #DDD;
}
.post h3:before {
  content: "## ";
  font-weight: bold;
  color: #DDD;
}
.post h4:before {
  content: "### ";
  font-weight: bold;
  color: #DDD;
}
.post article .meta {
  margin: 50px 0 100px;
}
.list {
  max-width: 700px;
}
.list ul.double-list {
  margin: 0 auto 60px;
  padding: 0;
  list-style-type: none;
}
.list ul.double-list li {
  padding: 5px 0;
}
.list ul.double-list li h2 {
  font-size: 1em;
  display: inline;
  font-weight: normal;
}
.list ul.double-list li span {
  font-family: sans-serif;
  text-transform: uppercase;
  text-align: right;
  float: right;
  padding-top: 3px;
  font-size: 12px;
  color: #999;
}
.full-width-content {
  padding-top: 10px;
  padding-left: 0px;
  padding-right: 0px;
  margin-left: -20px;
  margin-right: -20px;
}
.col-xs-1,
.col-sm-1,
.col-md-1,
.col-lg-1,
.col-xs-2,
.col-sm-2,
.col-md-2,
.col-lg-2,
.col-xs-3,
.col-sm-3,
.col-md-3,
.col-lg-3,
.col-xs-4,
.col-sm-4,
.col-md-4,
.col-lg-4,
.col-xs-5,
.col-sm-5,
.col-md-5,
.col-lg-5,
.col-xs-6,
.col-sm-6,
.col-md-6,
.col-lg-6,
.col-xs-7,
.col-sm-7,
.col-md-7,
.col-lg-7,
.col-xs-8,
.col-sm-8,
.col-md-8,
.col-lg-8,
.col-xs-9,
.col-sm-9,
.col-md-9,
.col-lg-9,
.col-xs-10,
.col-sm-10,
.col-md-10,
.col-lg-10,
.col-xs-11,
.col-sm-11,
.col-md-11,
.col-lg-11,
.col-xs-12,
.col-sm-12,
.col-md-12,
.col-lg-12 {
  padding-right: 0px;
  padding-left: 0px;
}</style>

	<script src="https://ajax.googleapis.com/ajax/libs/jquery/3.1.1/jquery.min.js"></script>
	<script src="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.7/js/bootstrap.min.js"></script>

		<script type="text/x-mathjax-config">
		MathJax.Hub.Config({
		  tex2jax: {inlineMath: [['$','$'], ['\\(','\\)']],processEscapes: true}
		});
		</script>
		<script type="text/javascript" async
			  src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.2/MathJax.js?config=TeX-MML-AM_CHTML">
		</script>

    </head>

    <body>
        <header class="navbar navbar-inverse bs-docs-nav">
            <div class="container-fluid">
                <div class="navbar-header">
		  <button type="button" class="navbar-toggle" data-toggle="collapse" data-target="#theNavbar">
		    <span class="icon-bar"></span>
		    <span class="icon-bar"></span>
		    <span class="icon-bar"></span> 
		  </button>
                  <a class="navbar-brand" href="/pypinm.io" title="Home" class="title">Programiranje in numerične metode v ekosistemu Pythona</a>
                </div>
                <nav class="collapse navbar-collapse bs-navbar-collapse" role="navigation" id="theNavbar">
		    <ul class="nav navbar-nav navbar-right">
                            <li><a href="http://ladisk.si/~slavic" title="About">About</a></li>
                    </ul>
                </nav>
            </div>
        </header>

        <div id="wrap">
<div class="container post">

    <article>
        <header>
            <h1>Numerično integriranje</h1>
                <time datetime="page.date.isoformat()" pubdate>Mon 27 September 2021</time>
        </header>

        <div class="article_content">
            <style type="text/css">/*!
*
* IPython notebook
*
*/
/* CSS font colors for translated ANSI escape sequences */
/* The color values are a mix of
   http://www.xcolors.net/dl/baskerville-ivorylight and
   http://www.xcolors.net/dl/euphrasia */
.ansi-black-fg {
  color: #3E424D;
}
.ansi-black-bg {
  background-color: #3E424D;
}
.ansi-black-intense-fg {
  color: #282C36;
}
.ansi-black-intense-bg {
  background-color: #282C36;
}
.ansi-red-fg {
  color: #E75C58;
}
.ansi-red-bg {
  background-color: #E75C58;
}
.ansi-red-intense-fg {
  color: #B22B31;
}
.ansi-red-intense-bg {
  background-color: #B22B31;
}
.ansi-green-fg {
  color: #00A250;
}
.ansi-green-bg {
  background-color: #00A250;
}
.ansi-green-intense-fg {
  color: #007427;
}
.ansi-green-intense-bg {
  background-color: #007427;
}
.ansi-yellow-fg {
  color: #DDB62B;
}
.ansi-yellow-bg {
  background-color: #DDB62B;
}
.ansi-yellow-intense-fg {
  color: #B27D12;
}
.ansi-yellow-intense-bg {
  background-color: #B27D12;
}
.ansi-blue-fg {
  color: #208FFB;
}
.ansi-blue-bg {
  background-color: #208FFB;
}
.ansi-blue-intense-fg {
  color: #0065CA;
}
.ansi-blue-intense-bg {
  background-color: #0065CA;
}
.ansi-magenta-fg {
  color: #D160C4;
}
.ansi-magenta-bg {
  background-color: #D160C4;
}
.ansi-magenta-intense-fg {
  color: #A03196;
}
.ansi-magenta-intense-bg {
  background-color: #A03196;
}
.ansi-cyan-fg {
  color: #60C6C8;
}
.ansi-cyan-bg {
  background-color: #60C6C8;
}
.ansi-cyan-intense-fg {
  color: #258F8F;
}
.ansi-cyan-intense-bg {
  background-color: #258F8F;
}
.ansi-white-fg {
  color: #C5C1B4;
}
.ansi-white-bg {
  background-color: #C5C1B4;
}
.ansi-white-intense-fg {
  color: #A1A6B2;
}
.ansi-white-intense-bg {
  background-color: #A1A6B2;
}
.ansi-default-inverse-fg {
  color: #FFFFFF;
}
.ansi-default-inverse-bg {
  background-color: #000000;
}
.ansi-bold {
  font-weight: bold;
}
.ansi-underline {
  text-decoration: underline;
}
/* The following styles are deprecated an will be removed in a future version */
.ansibold {
  font-weight: bold;
}
.ansi-inverse {
  outline: 0.5px dotted;
}
/* use dark versions for foreground, to improve visibility */
.ansiblack {
  color: black;
}
.ansired {
  color: darkred;
}
.ansigreen {
  color: darkgreen;
}
.ansiyellow {
  color: #c4a000;
}
.ansiblue {
  color: darkblue;
}
.ansipurple {
  color: darkviolet;
}
.ansicyan {
  color: steelblue;
}
.ansigray {
  color: gray;
}
/* and light for background, for the same reason */
.ansibgblack {
  background-color: black;
}
.ansibgred {
  background-color: red;
}
.ansibggreen {
  background-color: green;
}
.ansibgyellow {
  background-color: yellow;
}
.ansibgblue {
  background-color: blue;
}
.ansibgpurple {
  background-color: magenta;
}
.ansibgcyan {
  background-color: cyan;
}
.ansibggray {
  background-color: gray;
}
div.cell {
  /* Old browsers */
  display: -webkit-box;
  -webkit-box-orient: vertical;
  -webkit-box-align: stretch;
  display: -moz-box;
  -moz-box-orient: vertical;
  -moz-box-align: stretch;
  display: box;
  box-orient: vertical;
  box-align: stretch;
  /* Modern browsers */
  display: flex;
  flex-direction: column;
  align-items: stretch;
  border-radius: 2px;
  box-sizing: border-box;
  -moz-box-sizing: border-box;
  -webkit-box-sizing: border-box;
  border-width: 1px;
  border-style: solid;
  border-color: transparent;
  width: 100%;
  padding: 5px;
  /* This acts as a spacer between cells, that is outside the border */
  margin: 0px;
  outline: none;
  position: relative;
  overflow: visible;
}
div.cell:before {
  position: absolute;
  display: block;
  top: -1px;
  left: -1px;
  width: 5px;
  height: calc(100% +  2px);
  content: '';
  background: transparent;
}
div.cell.jupyter-soft-selected {
  border-left-color: #E3F2FD;
  border-left-width: 1px;
  padding-left: 5px;
  border-right-color: #E3F2FD;
  border-right-width: 1px;
  background: #E3F2FD;
}
@media print {
  div.cell.jupyter-soft-selected {
    border-color: transparent;
  }
}
div.cell.selected,
div.cell.selected.jupyter-soft-selected {
  border-color: #ababab;
}
div.cell.selected:before,
div.cell.selected.jupyter-soft-selected:before {
  position: absolute;
  display: block;
  top: -1px;
  left: -1px;
  width: 5px;
  height: calc(100% +  2px);
  content: '';
  background: #42A5F5;
}
@media print {
  div.cell.selected,
  div.cell.selected.jupyter-soft-selected {
    border-color: transparent;
  }
}
.edit_mode div.cell.selected {
  border-color: #66BB6A;
}
.edit_mode div.cell.selected:before {
  position: absolute;
  display: block;
  top: -1px;
  left: -1px;
  width: 5px;
  height: calc(100% +  2px);
  content: '';
  background: #66BB6A;
}
@media print {
  .edit_mode div.cell.selected {
    border-color: transparent;
  }
}
.prompt {
  /* This needs to be wide enough for 3 digit prompt numbers: In[100]: */
  min-width: 14ex;
  /* This padding is tuned to match the padding on the CodeMirror editor. */
  padding: 0.4em;
  margin: 0px;
  font-family: monospace;
  text-align: right;
  /* This has to match that of the the CodeMirror class line-height below */
  line-height: 1.21429em;
  /* Don't highlight prompt number selection */
  -webkit-touch-callout: none;
  -webkit-user-select: none;
  -khtml-user-select: none;
  -moz-user-select: none;
  -ms-user-select: none;
  user-select: none;
  /* Use default cursor */
  cursor: default;
}
@media (max-width: 540px) {
  .prompt {
    text-align: left;
  }
}
div.inner_cell {
  min-width: 0;
  /* Old browsers */
  display: -webkit-box;
  -webkit-box-orient: vertical;
  -webkit-box-align: stretch;
  display: -moz-box;
  -moz-box-orient: vertical;
  -moz-box-align: stretch;
  display: box;
  box-orient: vertical;
  box-align: stretch;
  /* Modern browsers */
  display: flex;
  flex-direction: column;
  align-items: stretch;
  /* Old browsers */
  -webkit-box-flex: 1;
  -moz-box-flex: 1;
  box-flex: 1;
  /* Modern browsers */
  flex: 1;
}
/* input_area and input_prompt must match in top border and margin for alignment */
div.input_area {
  border: 1px solid #cfcfcf;
  border-radius: 2px;
  background: #f7f7f7;
  line-height: 1.21429em;
}
/* This is needed so that empty prompt areas can collapse to zero height when there
   is no content in the output_subarea and the prompt. The main purpose of this is
   to make sure that empty JavaScript output_subareas have no height. */
div.prompt:empty {
  padding-top: 0;
  padding-bottom: 0;
}
div.unrecognized_cell {
  padding: 5px 5px 5px 0px;
  /* Old browsers */
  display: -webkit-box;
  -webkit-box-orient: horizontal;
  -webkit-box-align: stretch;
  display: -moz-box;
  -moz-box-orient: horizontal;
  -moz-box-align: stretch;
  display: box;
  box-orient: horizontal;
  box-align: stretch;
  /* Modern browsers */
  display: flex;
  flex-direction: row;
  align-items: stretch;
}
div.unrecognized_cell .inner_cell {
  border-radius: 2px;
  padding: 5px;
  font-weight: bold;
  color: red;
  border: 1px solid #cfcfcf;
  background: #eaeaea;
}
div.unrecognized_cell .inner_cell a {
  color: inherit;
  text-decoration: none;
}
div.unrecognized_cell .inner_cell a:hover {
  color: inherit;
  text-decoration: none;
}
@media (max-width: 540px) {
  div.unrecognized_cell > div.prompt {
    display: none;
  }
}
div.code_cell {
  /* avoid page breaking on code cells when printing */
}
@media print {
  div.code_cell {
    page-break-inside: avoid;
  }
}
/* any special styling for code cells that are currently running goes here */
div.input {
  page-break-inside: avoid;
  /* Old browsers */
  display: -webkit-box;
  -webkit-box-orient: horizontal;
  -webkit-box-align: stretch;
  display: -moz-box;
  -moz-box-orient: horizontal;
  -moz-box-align: stretch;
  display: box;
  box-orient: horizontal;
  box-align: stretch;
  /* Modern browsers */
  display: flex;
  flex-direction: row;
  align-items: stretch;
}
@media (max-width: 540px) {
  div.input {
    /* Old browsers */
    display: -webkit-box;
    -webkit-box-orient: vertical;
    -webkit-box-align: stretch;
    display: -moz-box;
    -moz-box-orient: vertical;
    -moz-box-align: stretch;
    display: box;
    box-orient: vertical;
    box-align: stretch;
    /* Modern browsers */
    display: flex;
    flex-direction: column;
    align-items: stretch;
  }
}
/* input_area and input_prompt must match in top border and margin for alignment */
div.input_prompt {
  color: #303F9F;
  border-top: 1px solid transparent;
}
div.input_area > div.highlight {
  margin: 0.4em;
  border: none;
  padding: 0px;
  background-color: transparent;
}
div.input_area > div.highlight > pre {
  margin: 0px;
  border: none;
  padding: 0px;
  background-color: transparent;
}
/* The following gets added to the <head> if it is detected that the user has a
 * monospace font with inconsistent normal/bold/italic height.  See
 * notebookmain.js.  Such fonts will have keywords vertically offset with
 * respect to the rest of the text.  The user should select a better font.
 * See: https://github.com/ipython/ipython/issues/1503
 *
 * .CodeMirror span {
 *      vertical-align: bottom;
 * }
 */
.CodeMirror {
  line-height: 1.21429em;
  /* Changed from 1em to our global default */
  font-size: 14px;
  height: auto;
  /* Changed to auto to autogrow */
  background: none;
  /* Changed from white to allow our bg to show through */
}
.CodeMirror-scroll {
  /*  The CodeMirror docs are a bit fuzzy on if overflow-y should be hidden or visible.*/
  /*  We have found that if it is visible, vertical scrollbars appear with font size changes.*/
  overflow-y: hidden;
  overflow-x: auto;
}
.CodeMirror-lines {
  /* In CM2, this used to be 0.4em, but in CM3 it went to 4px. We need the em value because */
  /* we have set a different line-height and want this to scale with that. */
  /* Note that this should set vertical padding only, since CodeMirror assumes
       that horizontal padding will be set on CodeMirror pre */
  padding: 0.4em 0;
}
.CodeMirror-linenumber {
  padding: 0 8px 0 4px;
}
.CodeMirror-gutters {
  border-bottom-left-radius: 2px;
  border-top-left-radius: 2px;
}
.CodeMirror pre {
  /* In CM3 this went to 4px from 0 in CM2. This sets horizontal padding only,
    use .CodeMirror-lines for vertical */
  padding: 0 0.4em;
  border: 0;
  border-radius: 0;
}
.CodeMirror-cursor {
  border-left: 1.4px solid black;
}
@media screen and (min-width: 2138px) and (max-width: 4319px) {
  .CodeMirror-cursor {
    border-left: 2px solid black;
  }
}
@media screen and (min-width: 4320px) {
  .CodeMirror-cursor {
    border-left: 4px solid black;
  }
}
/*

Original style from softwaremaniacs.org (c) Ivan Sagalaev <Maniac@SoftwareManiacs.Org>
Adapted from GitHub theme

*/
.highlight-base {
  color: #000;
}
.highlight-variable {
  color: #000;
}
.highlight-variable-2 {
  color: #1a1a1a;
}
.highlight-variable-3 {
  color: #333333;
}
.highlight-string {
  color: #BA2121;
}
.highlight-comment {
  color: #408080;
  font-style: italic;
}
.highlight-number {
  color: #080;
}
.highlight-atom {
  color: #88F;
}
.highlight-keyword {
  color: #008000;
  font-weight: bold;
}
.highlight-builtin {
  color: #008000;
}
.highlight-error {
  color: #f00;
}
.highlight-operator {
  color: #AA22FF;
  font-weight: bold;
}
.highlight-meta {
  color: #AA22FF;
}
/* previously not defined, copying from default codemirror */
.highlight-def {
  color: #00f;
}
.highlight-string-2 {
  color: #f50;
}
.highlight-qualifier {
  color: #555;
}
.highlight-bracket {
  color: #997;
}
.highlight-tag {
  color: #170;
}
.highlight-attribute {
  color: #00c;
}
.highlight-header {
  color: blue;
}
.highlight-quote {
  color: #090;
}
.highlight-link {
  color: #00c;
}
/* apply the same style to codemirror */
.cm-s-ipython span.cm-keyword {
  color: #008000;
  font-weight: bold;
}
.cm-s-ipython span.cm-atom {
  color: #88F;
}
.cm-s-ipython span.cm-number {
  color: #080;
}
.cm-s-ipython span.cm-def {
  color: #00f;
}
.cm-s-ipython span.cm-variable {
  color: #000;
}
.cm-s-ipython span.cm-operator {
  color: #AA22FF;
  font-weight: bold;
}
.cm-s-ipython span.cm-variable-2 {
  color: #1a1a1a;
}
.cm-s-ipython span.cm-variable-3 {
  color: #333333;
}
.cm-s-ipython span.cm-comment {
  color: #408080;
  font-style: italic;
}
.cm-s-ipython span.cm-string {
  color: #BA2121;
}
.cm-s-ipython span.cm-string-2 {
  color: #f50;
}
.cm-s-ipython span.cm-meta {
  color: #AA22FF;
}
.cm-s-ipython span.cm-qualifier {
  color: #555;
}
.cm-s-ipython span.cm-builtin {
  color: #008000;
}
.cm-s-ipython span.cm-bracket {
  color: #997;
}
.cm-s-ipython span.cm-tag {
  color: #170;
}
.cm-s-ipython span.cm-attribute {
  color: #00c;
}
.cm-s-ipython span.cm-header {
  color: blue;
}
.cm-s-ipython span.cm-quote {
  color: #090;
}
.cm-s-ipython span.cm-link {
  color: #00c;
}
.cm-s-ipython span.cm-error {
  color: #f00;
}
.cm-s-ipython span.cm-tab {
  background: url(data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAADAAAAAMCAYAAAAkuj5RAAAAAXNSR0IArs4c6QAAAGFJREFUSMft1LsRQFAQheHPowAKoACx3IgEKtaEHujDjORSgWTH/ZOdnZOcM/sgk/kFFWY0qV8foQwS4MKBCS3qR6ixBJvElOobYAtivseIE120FaowJPN75GMu8j/LfMwNjh4HUpwg4LUAAAAASUVORK5CYII=);
  background-position: right;
  background-repeat: no-repeat;
}
div.output_wrapper {
  /* this position must be relative to enable descendents to be absolute within it */
  position: relative;
  /* Old browsers */
  display: -webkit-box;
  -webkit-box-orient: vertical;
  -webkit-box-align: stretch;
  display: -moz-box;
  -moz-box-orient: vertical;
  -moz-box-align: stretch;
  display: box;
  box-orient: vertical;
  box-align: stretch;
  /* Modern browsers */
  display: flex;
  flex-direction: column;
  align-items: stretch;
  z-index: 1;
}
/* class for the output area when it should be height-limited */
div.output_scroll {
  /* ideally, this would be max-height, but FF barfs all over that */
  height: 24em;
  /* FF needs this *and the wrapper* to specify full width, or it will shrinkwrap */
  width: 100%;
  overflow: auto;
  border-radius: 2px;
  -webkit-box-shadow: inset 0 2px 8px rgba(0, 0, 0, 0.8);
  box-shadow: inset 0 2px 8px rgba(0, 0, 0, 0.8);
  display: block;
}
/* output div while it is collapsed */
div.output_collapsed {
  margin: 0px;
  padding: 0px;
  /* Old browsers */
  display: -webkit-box;
  -webkit-box-orient: vertical;
  -webkit-box-align: stretch;
  display: -moz-box;
  -moz-box-orient: vertical;
  -moz-box-align: stretch;
  display: box;
  box-orient: vertical;
  box-align: stretch;
  /* Modern browsers */
  display: flex;
  flex-direction: column;
  align-items: stretch;
}
div.out_prompt_overlay {
  height: 100%;
  padding: 0px 0.4em;
  position: absolute;
  border-radius: 2px;
}
div.out_prompt_overlay:hover {
  /* use inner shadow to get border that is computed the same on WebKit/FF */
  -webkit-box-shadow: inset 0 0 1px #000;
  box-shadow: inset 0 0 1px #000;
  background: rgba(240, 240, 240, 0.5);
}
div.output_prompt {
  color: #D84315;
}
/* This class is the outer container of all output sections. */
div.output_area {
  padding: 0px;
  page-break-inside: avoid;
  /* Old browsers */
  display: -webkit-box;
  -webkit-box-orient: horizontal;
  -webkit-box-align: stretch;
  display: -moz-box;
  -moz-box-orient: horizontal;
  -moz-box-align: stretch;
  display: box;
  box-orient: horizontal;
  box-align: stretch;
  /* Modern browsers */
  display: flex;
  flex-direction: row;
  align-items: stretch;
}
div.output_area .MathJax_Display {
  text-align: left !important;
}
div.output_area 
div.output_area 
div.output_area img,
div.output_area svg {
  max-width: 100%;
  height: auto;
}
div.output_area img.unconfined,
div.output_area svg.unconfined {
  max-width: none;
}
div.output_area .mglyph > img {
  max-width: none;
}
/* This is needed to protect the pre formating from global settings such
   as that of bootstrap */
.output {
  /* Old browsers */
  display: -webkit-box;
  -webkit-box-orient: vertical;
  -webkit-box-align: stretch;
  display: -moz-box;
  -moz-box-orient: vertical;
  -moz-box-align: stretch;
  display: box;
  box-orient: vertical;
  box-align: stretch;
  /* Modern browsers */
  display: flex;
  flex-direction: column;
  align-items: stretch;
}
@media (max-width: 540px) {
  div.output_area {
    /* Old browsers */
    display: -webkit-box;
    -webkit-box-orient: vertical;
    -webkit-box-align: stretch;
    display: -moz-box;
    -moz-box-orient: vertical;
    -moz-box-align: stretch;
    display: box;
    box-orient: vertical;
    box-align: stretch;
    /* Modern browsers */
    display: flex;
    flex-direction: column;
    align-items: stretch;
  }
}
div.output_area pre {
  margin: 0;
  padding: 1px 0 1px 0;
  border: 0;
  vertical-align: baseline;
  color: black;
  background-color: transparent;
  border-radius: 0;
}
/* This class is for the output subarea inside the output_area and after
   the prompt div. */
div.output_subarea {
  overflow-x: auto;
  padding: 0.4em;
  /* Old browsers */
  -webkit-box-flex: 1;
  -moz-box-flex: 1;
  box-flex: 1;
  /* Modern browsers */
  flex: 1;
  max-width: calc(100% - 14ex);
}
div.output_scroll div.output_subarea {
  overflow-x: visible;
}
/* The rest of the output_* classes are for special styling of the different
   output types */
/* all text output has this class: */
div.output_text {
  text-align: left;
  color: #000;
  /* This has to match that of the the CodeMirror class line-height below */
  line-height: 1.21429em;
}
/* stdout/stderr are 'text' as well as 'stream', but execute_result/error are *not* streams */
div.output_stderr {
  background: #fdd;
  /* very light red background for stderr */
}
div.output_latex {
  text-align: left;
}
/* Empty output_javascript divs should have no height */
div.output_javascript:empty {
  padding: 0;
}
.js-error {
  color: darkred;
}
/* raw_input styles */
div.raw_input_container {
  line-height: 1.21429em;
  padding-top: 5px;
}
pre.raw_input_prompt {
  /* nothing needed here. */
}
input.raw_input {
  font-family: monospace;
  font-size: inherit;
  color: inherit;
  width: auto;
  /* make sure input baseline aligns with prompt */
  vertical-align: baseline;
  /* padding + margin = 0.5em between prompt and cursor */
  padding: 0em 0.25em;
  margin: 0em 0.25em;
}
input.raw_input:focus {
  box-shadow: none;
}
p.p-space {
  margin-bottom: 10px;
}
div.output_unrecognized {
  padding: 5px;
  font-weight: bold;
  color: red;
}
div.output_unrecognized a {
  color: inherit;
  text-decoration: none;
}
div.output_unrecognized a:hover {
  color: inherit;
  text-decoration: none;
}
.rendered_html {
  color: #000;
  /* any extras will just be numbers: */
}



.rendered_html :link {
  text-decoration: underline;
}
.rendered_html :visited {
  text-decoration: underline;
}






.rendered_html h1:first-child {
  margin-top: 0.538em;
}
.rendered_html h2:first-child {
  margin-top: 0.636em;
}
.rendered_html h3:first-child {
  margin-top: 0.777em;
}
.rendered_html h4:first-child {
  margin-top: 1em;
}
.rendered_html h5:first-child {
  margin-top: 1em;
}
.rendered_html h6:first-child {
  margin-top: 1em;
}
.rendered_html ul:not(.list-inline),
.rendered_html ol:not(.list-inline) {
  padding-left: 2em;
}








.rendered_html * + ul {
  margin-top: 1em;
}
.rendered_html * + ol {
  margin-top: 1em;
}





.rendered_html pre,




.rendered_html tr,
.rendered_html th,


.rendered_html tbody tr:nth-child(odd) {
  background: #f5f5f5;
}
.rendered_html tbody tr:hover {
  background: rgba(66, 165, 245, 0.2);
}
.rendered_html * + table {
  margin-top: 1em;
}

.rendered_html * + p {
  margin-top: 1em;
}

.rendered_html * + img {
  margin-top: 1em;
}
.rendered_html img,

.rendered_html img.unconfined,


.rendered_html * + .alert {
  margin-top: 1em;
}
[dir="rtl"] 
div.text_cell {
  /* Old browsers */
  display: -webkit-box;
  -webkit-box-orient: horizontal;
  -webkit-box-align: stretch;
  display: -moz-box;
  -moz-box-orient: horizontal;
  -moz-box-align: stretch;
  display: box;
  box-orient: horizontal;
  box-align: stretch;
  /* Modern browsers */
  display: flex;
  flex-direction: row;
  align-items: stretch;
}
@media (max-width: 540px) {
  div.text_cell > div.prompt {
    display: none;
  }
}
div.text_cell_render {
  /*font-family: "Helvetica Neue", Arial, Helvetica, Geneva, sans-serif;*/
  outline: none;
  resize: none;
  width: inherit;
  border-style: none;
  padding: 0.5em 0.5em 0.5em 0.4em;
  color: #000;
  box-sizing: border-box;
  -moz-box-sizing: border-box;
  -webkit-box-sizing: border-box;
}
a.anchor-link:link {
  text-decoration: none;
  padding: 0px 20px;
  visibility: hidden;
}
h1:hover .anchor-link,
h2:hover .anchor-link,
h3:hover .anchor-link,
h4:hover .anchor-link,
h5:hover .anchor-link,
h6:hover .anchor-link {
  visibility: visible;
}
.text_cell.rendered .input_area {
  display: none;
}
.text_cell.rendered 
.text_cell.rendered .rendered_html tr,
.text_cell.rendered .rendered_html th,
.text_cell.rendered 
.text_cell.unrendered .text_cell_render {
  display: none;
}
.text_cell .dropzone .input_area {
  border: 2px dashed #bababa;
  margin: -1px;
}
.cm-header-1,
.cm-header-2,
.cm-header-3,
.cm-header-4,
.cm-header-5,
.cm-header-6 {
  font-weight: bold;
  font-family: "Helvetica Neue", Helvetica, Arial, sans-serif;
}
.cm-header-1 {
  font-size: 185.7%;
}
.cm-header-2 {
  font-size: 157.1%;
}
.cm-header-3 {
  font-size: 128.6%;
}
.cm-header-4 {
  font-size: 110%;
}
.cm-header-5 {
  font-size: 100%;
  font-style: italic;
}
.cm-header-6 {
  font-size: 100%;
  font-style: italic;
}
</style>
<style type="text/css">pre { line-height: 125%; }
td.linenos .normal { color: inherit; background-color: transparent; padding-left: 5px; padding-right: 5px; }
span.linenos { color: inherit; background-color: transparent; padding-left: 5px; padding-right: 5px; }
td.linenos .special { color: #000000; background-color: #ffffc0; padding-left: 5px; padding-right: 5px; }
span.linenos.special { color: #000000; background-color: #ffffc0; padding-left: 5px; padding-right: 5px; }
 .highlight pre  .hll { background-color: #ffffcc }
 .highlight pre  { background: #f8f8f8; }
 .highlight pre  .c { color: #408080; font-style: italic } /* Comment */
 .highlight pre  .err { border: 1px solid #FF0000 } /* Error */
 .highlight pre  .k { color: #008000; font-weight: bold } /* Keyword */
 .highlight pre  .o { color: #666666 } /* Operator */
 .highlight pre  .ch { color: #408080; font-style: italic } /* Comment.Hashbang */
 .highlight pre  .cm { color: #408080; font-style: italic } /* Comment.Multiline */
 .highlight pre  .cp { color: #BC7A00 } /* Comment.Preproc */
 .highlight pre  .cpf { color: #408080; font-style: italic } /* Comment.PreprocFile */
 .highlight pre  .c1 { color: #408080; font-style: italic } /* Comment.Single */
 .highlight pre  .cs { color: #408080; font-style: italic } /* Comment.Special */
 .highlight pre  .gd { color: #A00000 } /* Generic.Deleted */
 .highlight pre  .ge { font-style: italic } /* Generic.Emph */
 .highlight pre  .gr { color: #FF0000 } /* Generic.Error */
 .highlight pre  .gh { color: #000080; font-weight: bold } /* Generic.Heading */
 .highlight pre  .gi { color: #00A000 } /* Generic.Inserted */
 .highlight pre  .go { color: #888888 } /* Generic.Output */
 .highlight pre  .gp { color: #000080; font-weight: bold } /* Generic.Prompt */
 .highlight pre  .gs { font-weight: bold } /* Generic.Strong */
 .highlight pre  .gu { color: #800080; font-weight: bold } /* Generic.Subheading */
 .highlight pre  .gt { color: #0044DD } /* Generic.Traceback */
 .highlight pre  .kc { color: #008000; font-weight: bold } /* Keyword.Constant */
 .highlight pre  .kd { color: #008000; font-weight: bold } /* Keyword.Declaration */
 .highlight pre  .kn { color: #008000; font-weight: bold } /* Keyword.Namespace */
 .highlight pre  .kp { color: #008000 } /* Keyword.Pseudo */
 .highlight pre  .kr { color: #008000; font-weight: bold } /* Keyword.Reserved */
 .highlight pre  .kt { color: #B00040 } /* Keyword.Type */
 .highlight pre  .m { color: #666666 } /* Literal.Number */
 .highlight pre  .s { color: #BA2121 } /* Literal.String */
 .highlight pre  .na { color: #7D9029 } /* Name.Attribute */
 .highlight pre  .nb { color: #008000 } /* Name.Builtin */
 .highlight pre  .nc { color: #0000FF; font-weight: bold } /* Name.Class */
 .highlight pre  .no { color: #880000 } /* Name.Constant */
 .highlight pre  .nd { color: #AA22FF } /* Name.Decorator */
 .highlight pre  .ni { color: #999999; font-weight: bold } /* Name.Entity */
 .highlight pre  .ne { color: #D2413A; font-weight: bold } /* Name.Exception */
 .highlight pre  .nf { color: #0000FF } /* Name.Function */
 .highlight pre  .nl { color: #A0A000 } /* Name.Label */
 .highlight pre  .nn { color: #0000FF; font-weight: bold } /* Name.Namespace */
 .highlight pre  .nt { color: #008000; font-weight: bold } /* Name.Tag */
 .highlight pre  .nv { color: #19177C } /* Name.Variable */
 .highlight pre  .ow { color: #AA22FF; font-weight: bold } /* Operator.Word */
 .highlight pre  .w { color: #bbbbbb } /* Text.Whitespace */
 .highlight pre  .mb { color: #666666 } /* Literal.Number.Bin */
 .highlight pre  .mf { color: #666666 } /* Literal.Number.Float */
 .highlight pre  .mh { color: #666666 } /* Literal.Number.Hex */
 .highlight pre  .mi { color: #666666 } /* Literal.Number.Integer */
 .highlight pre  .mo { color: #666666 } /* Literal.Number.Oct */
 .highlight pre  .sa { color: #BA2121 } /* Literal.String.Affix */
 .highlight pre  .sb { color: #BA2121 } /* Literal.String.Backtick */
 .highlight pre  .sc { color: #BA2121 } /* Literal.String.Char */
 .highlight pre  .dl { color: #BA2121 } /* Literal.String.Delimiter */
 .highlight pre  .sd { color: #BA2121; font-style: italic } /* Literal.String.Doc */
 .highlight pre  .s2 { color: #BA2121 } /* Literal.String.Double */
 .highlight pre  .se { color: #BB6622; font-weight: bold } /* Literal.String.Escape */
 .highlight pre  .sh { color: #BA2121 } /* Literal.String.Heredoc */
 .highlight pre  .si { color: #BB6688; font-weight: bold } /* Literal.String.Interpol */
 .highlight pre  .sx { color: #008000 } /* Literal.String.Other */
 .highlight pre  .sr { color: #BB6688 } /* Literal.String.Regex */
 .highlight pre  .s1 { color: #BA2121 } /* Literal.String.Single */
 .highlight pre  .ss { color: #19177C } /* Literal.String.Symbol */
 .highlight pre  .bp { color: #008000 } /* Name.Builtin.Pseudo */
 .highlight pre  .fm { color: #0000FF } /* Name.Function.Magic */
 .highlight pre  .vc { color: #19177C } /* Name.Variable.Class */
 .highlight pre  .vg { color: #19177C } /* Name.Variable.Global */
 .highlight pre  .vi { color: #19177C } /* Name.Variable.Instance */
 .highlight pre  .vm { color: #19177C } /* Name.Variable.Magic */
 .highlight pre  .il { color: #666666 } /* Literal.Number.Integer.Long */</style><div class="cell border-box-sizing text_cell rendered"><div class="prompt input_prompt">
</div><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p><h1>Kazalo<span class="tocSkip"></span></h1></p>
<div class="toc"><ul class="toc-item"><li><span><a href="#Uvod" data-toc-modified-id="Uvod-1"><span class="toc-item-num">1&nbsp;&nbsp;</span>Uvod</a></span><ul class="toc-item"><li><span><a href="#Motivacijski-primer" data-toc-modified-id="Motivacijski-primer-1.1"><span class="toc-item-num">1.1&nbsp;&nbsp;</span>Motivacijski primer</a></span></li></ul></li><li><span><a href="#Newton-Cotesov-pristop" data-toc-modified-id="Newton-Cotesov-pristop-2"><span class="toc-item-num">2&nbsp;&nbsp;</span>Newton-Cotesov pristop</a></span><ul class="toc-item"><li><span><a href="#Trapezno-pravilo" data-toc-modified-id="Trapezno-pravilo-2.1"><span class="toc-item-num">2.1&nbsp;&nbsp;</span>Trapezno pravilo</a></span><ul class="toc-item"><li><span><a href="#Numerična-implementacija" data-toc-modified-id="Numerična-implementacija-2.1.1"><span class="toc-item-num">2.1.1&nbsp;&nbsp;</span>Numerična implementacija</a></span></li><li><span><a href="#Numerični-zgled" data-toc-modified-id="Numerični-zgled-2.1.2"><span class="toc-item-num">2.1.2&nbsp;&nbsp;</span>Numerični zgled</a></span></li><li><span><a href="#Napaka-trapeznega-pravila" data-toc-modified-id="Napaka-trapeznega-pravila-2.1.3"><span class="toc-item-num">2.1.3&nbsp;&nbsp;</span>Napaka trapeznega pravila</a></span></li></ul></li><li><span><a href="#Sestavljeno-trapezno-pravilo" data-toc-modified-id="Sestavljeno-trapezno-pravilo-2.2"><span class="toc-item-num">2.2&nbsp;&nbsp;</span>Sestavljeno trapezno pravilo</a></span><ul class="toc-item"><li><span><a href="#Numerična-implementacija" data-toc-modified-id="Numerična-implementacija-2.2.1"><span class="toc-item-num">2.2.1&nbsp;&nbsp;</span>Numerična implementacija</a></span></li><li><span><a href="#Numerični-zgled" data-toc-modified-id="Numerični-zgled-2.2.2"><span class="toc-item-num">2.2.2&nbsp;&nbsp;</span>Numerični zgled</a></span></li><li><span><a href="#Napaka-sestavljenega-trapeznega-pravila" data-toc-modified-id="Napaka-sestavljenega-trapeznega-pravila-2.2.3"><span class="toc-item-num">2.2.3&nbsp;&nbsp;</span>Napaka sestavljenega trapeznega pravila</a></span></li><li><span><a href="#Boljši-približek-integrala" data-toc-modified-id="Boljši-približek-integrala-2.2.4"><span class="toc-item-num">2.2.4&nbsp;&nbsp;</span>Boljši približek integrala</a></span></li><li><span><a href="#Numerični-zgled" data-toc-modified-id="Numerični-zgled-2.2.5"><span class="toc-item-num">2.2.5&nbsp;&nbsp;</span>Numerični zgled</a></span></li><li><span><a href="#numpy-implementacija-sestavljenega-trapeznega-pravila" data-toc-modified-id="numpy-implementacija-sestavljenega-trapeznega-pravila-2.2.6"><span class="toc-item-num">2.2.6&nbsp;&nbsp;</span><code>numpy</code> implementacija sestavljenega trapeznega pravila</a></span></li></ul></li><li><span><a href="#Simpsonova-in-druge-metode" data-toc-modified-id="Simpsonova-in-druge-metode-2.3"><span class="toc-item-num">2.3&nbsp;&nbsp;</span>Simpsonova in druge metode</a></span><ul class="toc-item"><li><span><a href="#Izpeljava-trapeznega-pravila-z-uporabo-Lagrangevih-polinomov" data-toc-modified-id="Izpeljava-trapeznega-pravila-z-uporabo-Lagrangevih-polinomov-2.3.1"><span class="toc-item-num">2.3.1&nbsp;&nbsp;</span>Izpeljava trapeznega pravila z uporabo Lagrangevih polinomov</a></span></li><li><span><a href="#Izračun-uteži-za-Simpsonovo-pravilo" data-toc-modified-id="Izračun-uteži-za-Simpsonovo-pravilo-2.3.2"><span class="toc-item-num">2.3.2&nbsp;&nbsp;</span>Izračun uteži za Simpsonovo pravilo</a></span></li><li><span><a href="#scipy.integrate.newton_cotes" data-toc-modified-id="scipy.integrate.newton_cotes-2.3.3"><span class="toc-item-num">2.3.3&nbsp;&nbsp;</span><code>scipy.integrate.newton_cotes</code></a></span></li><li><span><a href="#Izračun-uteži-za-Simpsonovo-3/8-pravilo" data-toc-modified-id="Izračun-uteži-za-Simpsonovo-3/8-pravilo-2.3.4"><span class="toc-item-num">2.3.4&nbsp;&nbsp;</span>Izračun uteži za Simpsonovo 3/8 pravilo</a></span></li></ul></li><li><span><a href="#Sestavljeno-Simpsonovo-pravilo" data-toc-modified-id="Sestavljeno-Simpsonovo-pravilo-2.4"><span class="toc-item-num">2.4&nbsp;&nbsp;</span>Sestavljeno Simpsonovo pravilo</a></span><ul class="toc-item"><li><span><a href="#Boljša-ocena-integrala" data-toc-modified-id="Boljša-ocena-integrala-2.4.1"><span class="toc-item-num">2.4.1&nbsp;&nbsp;</span>Boljša ocena integrala</a></span></li><li><span><a href="#Numerični-zgled" data-toc-modified-id="Numerični-zgled-2.4.2"><span class="toc-item-num">2.4.2&nbsp;&nbsp;</span>Numerični zgled</a></span></li><li><span><a href="#Simpsonova-metoda-v-scipy.integrate.simps" data-toc-modified-id="Simpsonova-metoda-v-scipy.integrate.simps-2.4.3"><span class="toc-item-num">2.4.3&nbsp;&nbsp;</span>Simpsonova metoda v <code>scipy.integrate.simps</code></a></span></li></ul></li><li><span><a href="#Rombergova-metoda*" data-toc-modified-id="Rombergova-metoda*-2.5"><span class="toc-item-num">2.5&nbsp;&nbsp;</span>Rombergova metoda*</a></span><ul class="toc-item"><li><span><a href="#Rombergova-metoda-v-scipy.integrate.romb" data-toc-modified-id="Rombergova-metoda-v-scipy.integrate.romb-2.5.1"><span class="toc-item-num">2.5.1&nbsp;&nbsp;</span>Rombergova metoda v <code>scipy.integrate.romb</code></a></span></li></ul></li></ul></li><li><span><a href="#Gaussov-integracijski-pristop" data-toc-modified-id="Gaussov-integracijski-pristop-3"><span class="toc-item-num">3&nbsp;&nbsp;</span>Gaussov integracijski pristop</a></span><ul class="toc-item"><li><span><a href="#Gaussova-kvadratura-z-enim-vozliščem" data-toc-modified-id="Gaussova-kvadratura-z-enim-vozliščem-3.1"><span class="toc-item-num">3.1&nbsp;&nbsp;</span>Gaussova kvadratura z enim vozliščem</a></span><ul class="toc-item"><li><span><a href="#Standardne-meje:-$a=-1$-in-$b=1$" data-toc-modified-id="Standardne-meje:-$a=-1$-in-$b=1$-3.1.1"><span class="toc-item-num">3.1.1&nbsp;&nbsp;</span>Standardne meje: $a=-1$ in $b=1$</a></span></li><li><span><a href="#Strojno-izpeljevanje-uteži-in-Gaussove-točke" data-toc-modified-id="Strojno-izpeljevanje-uteži-in-Gaussove-točke-3.1.2"><span class="toc-item-num">3.1.2&nbsp;&nbsp;</span>Strojno izpeljevanje uteži in Gaussove točke</a></span></li></ul></li><li><span><a href="#Gaussova-integracijska-metoda-z-več-vozlišči" data-toc-modified-id="Gaussova-integracijska-metoda-z-več-vozlišči-3.2"><span class="toc-item-num">3.2&nbsp;&nbsp;</span>Gaussova integracijska metoda z več vozlišči</a></span><ul class="toc-item"><li><span><a href="#Strojno-izpeljevanje" data-toc-modified-id="Strojno-izpeljevanje-3.2.1"><span class="toc-item-num">3.2.1&nbsp;&nbsp;</span>Strojno izpeljevanje</a></span></li><li><span><a href="#Numerična-implementacija" data-toc-modified-id="Numerična-implementacija-3.2.2"><span class="toc-item-num">3.2.2&nbsp;&nbsp;</span>Numerična implementacija</a></span></li><li><span><a href="#scipy.integrate.fixed_quad" data-toc-modified-id="scipy.integrate.fixed_quad-3.2.3"><span class="toc-item-num">3.2.3&nbsp;&nbsp;</span><code>scipy.integrate.fixed_quad</code></a></span></li></ul></li></ul></li><li><span><a href="#scipy.integrate" data-toc-modified-id="scipy.integrate-4"><span class="toc-item-num">4&nbsp;&nbsp;</span><code>scipy.integrate</code></a></span><ul class="toc-item"><li><span><a href="#Intergracijske-funkcije,-ki-zahtevajo-definicijsko-funkcijo:" data-toc-modified-id="Intergracijske-funkcije,-ki-zahtevajo-definicijsko-funkcijo:-4.1"><span class="toc-item-num">4.1&nbsp;&nbsp;</span>Intergracijske funkcije, ki zahtevajo definicijsko <em>funkcijo</em>:</a></span><ul class="toc-item"><li><span><a href="#scipy.integrate.quad" data-toc-modified-id="scipy.integrate.quad-4.1.1"><span class="toc-item-num">4.1.1&nbsp;&nbsp;</span><code>scipy.integrate.quad</code></a></span></li><li><span><a href="#scipy.integrate.dblquad" data-toc-modified-id="scipy.integrate.dblquad-4.1.2"><span class="toc-item-num">4.1.2&nbsp;&nbsp;</span><code>scipy.integrate.dblquad</code></a></span></li></ul></li><li><span><a href="#Intergracijske-funkcije,-ki-zahtevajo-tabelo-vrednosti:" data-toc-modified-id="Intergracijske-funkcije,-ki-zahtevajo-tabelo-vrednosti:-4.2"><span class="toc-item-num">4.2&nbsp;&nbsp;</span>Intergracijske funkcije, ki zahtevajo tabelo vrednosti:</a></span></li></ul></li><li><span><a href="#Nekaj-vprašanj-za-razmislek!" data-toc-modified-id="Nekaj-vprašanj-za-razmislek!-5"><span class="toc-item-num">5&nbsp;&nbsp;</span>Nekaj vprašanj za razmislek!</a></span></li><li><span><a href="#Dodatno" data-toc-modified-id="Dodatno-6"><span class="toc-item-num">6&nbsp;&nbsp;</span>Dodatno</a></span></li></ul></div>
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="prompt input_prompt">
</div><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h1 id="Uvod">Uvod<a class="anchor-link" href="#Uvod">&#182;</a></h1>
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="prompt input_prompt">
</div><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>V okviru tega poglavja bomo za dano funkcijo $f(x)$ izračunali določen integral:
$$\int_a^b\,f(x)\,\textrm{d}x$$
kjer sta $a$ in $b$ meji integriranja, $f(x)$ pa so vrednosti funkcije, ki jih pridobimo iz tabele vrednosti ali s pomočjo analitične funkcije.</p>

</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="prompt input_prompt">
</div><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>Pri numeričnem integriranju integral ocenimo z $I$ in velja
$$\int_a^b\,f(x)\,\textrm{d}x= I + E,$$
kjer je $E$ napaka ocene integrala.</p>

</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="prompt input_prompt">
</div><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>Numerični integral bomo računali na podlagi diskretne vsote:
$$I=\sum_{i=0}^{m}A_i\,f(x_i),$$
kjer so $A_i$ uteži, $x_i$ pa vozlišča na intervalu $[a, b]$ in je $m+1$ število vozlišč.</p>

</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="prompt input_prompt">
</div><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>Ogledali si bomo dva različna pristopa k numerični integraciji:</p>
<ol>
<li><em>Newton-Cotesov pristop</em>, ki temelji na ekvidistantnih vozliščih (konstanten korak integracije) in </li>
<li><em>Gaussov integracijski pristop</em>, kjer so vozlišča postavljena tako, da se doseže natančnost za polinome.</li>
</ol>

</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="prompt input_prompt">
</div><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h2 id="Motivacijski-primer">Motivacijski primer<a class="anchor-link" href="#Motivacijski-primer">&#182;</a></h2>
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="prompt input_prompt">
</div><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>Pri numeričnem integriranju si bomo pomagali s konkretnim primerom:</p>
$$\int_1^2 x\,\sin(x)\,\textrm{d}x$$
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="prompt input_prompt">
</div><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>Pripravimo si vozlišča. Osnovni korak naj bo $h=0.25$, v tem primeru imamo štiri podintervale in pet vozlišč, pri koraku $2h$ so tri vozliščne točke in pri koraku $4h$ samo dve (skrajni):</p>

</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In&nbsp;[1]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>
<span class="n">xg</span><span class="p">,</span> <span class="n">hg</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">100</span><span class="p">,</span> <span class="n">retstep</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span> <span class="c1"># goste točke (za prikaz)</span>
<span class="n">x2v</span><span class="p">,</span> <span class="n">h2v</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="n">retstep</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>  <span class="c1"># korak h2v = 1 (2 vozlišči)</span>
<span class="n">x3v</span><span class="p">,</span> <span class="n">h3v</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="n">retstep</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>  <span class="c1"># korak h3v = 0.5 (3 vozlišča)</span>
<span class="n">x4v</span><span class="p">,</span> <span class="n">h4v</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">4</span><span class="p">,</span> <span class="n">retstep</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>  <span class="c1"># korak h4v = 0.33.. (4 vozlišča)</span>
<span class="n">x5v</span><span class="p">,</span> <span class="n">h5v</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">5</span><span class="p">,</span> <span class="n">retstep</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>  <span class="c1"># korak h5v = 0.25 (5 vozlišč)</span>
</pre></div>

    </div>
</div>
</div>

</div>
<div class="cell border-box-sizing text_cell rendered"><div class="prompt input_prompt">
</div><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>Pripravimo še funkcijske vrednosti:</p>

</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In&nbsp;[2]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">yg</span> <span class="o">=</span> <span class="n">xg</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">sin</span><span class="p">(</span><span class="n">xg</span><span class="p">)</span>
<span class="n">y2v</span> <span class="o">=</span> <span class="n">x2v</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">sin</span><span class="p">(</span><span class="n">x2v</span><span class="p">)</span>
<span class="n">y3v</span> <span class="o">=</span> <span class="n">x3v</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">sin</span><span class="p">(</span><span class="n">x3v</span><span class="p">)</span>
<span class="n">y4v</span> <span class="o">=</span> <span class="n">x4v</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">sin</span><span class="p">(</span><span class="n">x4v</span><span class="p">)</span>
<span class="n">y5v</span> <span class="o">=</span> <span class="n">x5v</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">sin</span><span class="p">(</span><span class="n">x5v</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

</div>
<div class="cell border-box-sizing text_cell rendered"><div class="prompt input_prompt">
</div><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>Pripravimo prikaz podatkov:</p>

</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In&nbsp;[3]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="kn">import</span> <span class="nn">matplotlib.pyplot</span> <span class="k">as</span> <span class="nn">plt</span>
<span class="kn">from</span> <span class="nn">matplotlib</span> <span class="kn">import</span> <span class="n">rc</span> <span class="c1"># to uvozimo, da so fonti na sliki latex ustrezni</span>
<span class="c1">#rc(&#39;font&#39;,**{&#39;family&#39;:&#39;sans-serif&#39;,&#39;sans-serif&#39;:[&#39;Helvetica&#39;]})</span>
<span class="n">rc</span><span class="p">(</span><span class="s1">&#39;text&#39;</span><span class="p">,</span> <span class="n">usetex</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="o">%</span><span class="k">matplotlib</span> inline
<span class="k">def</span> <span class="nf">fig_motivacija</span><span class="p">():</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">fill_between</span><span class="p">(</span><span class="n">xg</span><span class="p">,</span> <span class="n">yg</span><span class="p">,</span> <span class="n">alpha</span><span class="o">=</span><span class="mf">0.25</span><span class="p">,</span> <span class="n">facecolor</span><span class="o">=</span><span class="s1">&#39;r&#39;</span><span class="p">)</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">annotate</span><span class="p">(</span><span class="s1">&#39;$\int_1^2\,x\,\sin(x)\,</span><span class="se">\\</span><span class="s1">textrm</span><span class="si">{d}</span><span class="s1">x$&#39;</span><span class="p">,</span> <span class="p">(</span><span class="mf">1.3</span><span class="p">,</span> <span class="mf">0.5</span><span class="p">),</span> <span class="n">fontsize</span><span class="o">=</span><span class="mi">22</span><span class="p">)</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">xg</span><span class="p">,</span> <span class="n">yg</span><span class="p">,</span> <span class="n">lw</span><span class="o">=</span><span class="mi">3</span><span class="p">,</span> <span class="n">alpha</span><span class="o">=</span><span class="mf">0.5</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s1">&#39;$x\,\sin(x)$&#39;</span><span class="p">)</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">x2v</span><span class="p">,</span> <span class="n">y2v</span><span class="p">,</span> <span class="s1">&#39;s&#39;</span><span class="p">,</span> <span class="n">alpha</span><span class="o">=</span><span class="mf">0.5</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="sa">f</span><span class="s1">&#39;$h=</span><span class="si">{</span><span class="n">h2v</span><span class="si">}</span><span class="s1">$&#39;</span><span class="p">,</span> <span class="n">markersize</span><span class="o">=</span><span class="mi">14</span><span class="p">)</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">x3v</span><span class="p">,</span> <span class="n">y3v</span><span class="p">,</span> <span class="s1">&#39;o&#39;</span><span class="p">,</span> <span class="n">alpha</span><span class="o">=</span><span class="mf">0.5</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="sa">f</span><span class="s1">&#39;$h=</span><span class="si">{</span><span class="n">h3v</span><span class="si">}</span><span class="s1">$&#39;</span><span class="p">,</span> <span class="n">markersize</span><span class="o">=</span><span class="mi">10</span><span class="p">)</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">legend</span><span class="p">(</span><span class="n">loc</span><span class="o">=</span><span class="p">(</span><span class="mf">1.01</span><span class="p">,</span> <span class="mi">0</span><span class="p">))</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">ylim</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">2</span><span class="p">)</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>

    </div>
</div>
</div>

</div>
<div class="cell border-box-sizing text_cell rendered"><div class="prompt input_prompt">
</div><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>Prikažimo podatke:</p>

</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In&nbsp;[4]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">fig_motivacija</span><span class="p">()</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">


<div class="output_area">

    <div class="prompt"></div>


<div class="output_subarea output_text output_error">
<pre>
<span class="ansi-red-intense-fg ansi-bold">---------------------------------------------------------------------------</span>
<span class="ansi-red-intense-fg ansi-bold">CalledProcessError</span>                        Traceback (most recent call last)
<span class="ansi-green-intense-fg ansi-bold">~\AppData\Roaming\Python\Python38\site-packages\matplotlib\texmanager.py</span> in <span class="ansi-cyan-fg">_run_checked_subprocess</span><span class="ansi-blue-intense-fg ansi-bold">(self, command, tex, cwd)</span>
<span class="ansi-green-fg">    251</span>         <span class="ansi-green-intense-fg ansi-bold">try</span><span class="ansi-yellow-intense-fg ansi-bold">:</span>
<span class="ansi-green-intense-fg ansi-bold">--&gt; 252</span><span class="ansi-yellow-intense-fg ansi-bold">             report = subprocess.check_output(
</span><span class="ansi-green-fg">    253</span>                 command<span class="ansi-yellow-intense-fg ansi-bold">,</span> cwd<span class="ansi-yellow-intense-fg ansi-bold">=</span>cwd <span class="ansi-green-intense-fg ansi-bold">if</span> cwd <span class="ansi-green-intense-fg ansi-bold">is</span> <span class="ansi-green-intense-fg ansi-bold">not</span> <span class="ansi-green-intense-fg ansi-bold">None</span> <span class="ansi-green-intense-fg ansi-bold">else</span> self<span class="ansi-yellow-intense-fg ansi-bold">.</span>texcache<span class="ansi-yellow-intense-fg ansi-bold">,</span>

<span class="ansi-green-intense-fg ansi-bold">c:\program files\python38\lib\subprocess.py</span> in <span class="ansi-cyan-fg">check_output</span><span class="ansi-blue-intense-fg ansi-bold">(timeout, *popenargs, **kwargs)</span>
<span class="ansi-green-fg">    414</span> 
<span class="ansi-green-intense-fg ansi-bold">--&gt; 415</span><span class="ansi-yellow-intense-fg ansi-bold">     return run(*popenargs, stdout=PIPE, timeout=timeout, check=True,
</span><span class="ansi-green-fg">    416</span>                **kwargs).stdout

<span class="ansi-green-intense-fg ansi-bold">c:\program files\python38\lib\subprocess.py</span> in <span class="ansi-cyan-fg">run</span><span class="ansi-blue-intense-fg ansi-bold">(input, capture_output, timeout, check, *popenargs, **kwargs)</span>
<span class="ansi-green-fg">    515</span>         <span class="ansi-green-intense-fg ansi-bold">if</span> check <span class="ansi-green-intense-fg ansi-bold">and</span> retcode<span class="ansi-yellow-intense-fg ansi-bold">:</span>
<span class="ansi-green-intense-fg ansi-bold">--&gt; 516</span><span class="ansi-yellow-intense-fg ansi-bold">             raise CalledProcessError(retcode, process.args,
</span><span class="ansi-green-fg">    517</span>                                      output=stdout, stderr=stderr)

<span class="ansi-red-intense-fg ansi-bold">CalledProcessError</span>: Command &#39;[&#39;latex&#39;, &#39;-interaction=nonstopmode&#39;, &#39;--halt-on-error&#39;, &#39;C:\\Users\\janko\\.matplotlib\\tex.cache\\1acea6f6c115d0ec7a634ed0529287b9.tex&#39;]&#39; returned non-zero exit status 1.

The above exception was the direct cause of the following exception:

<span class="ansi-red-intense-fg ansi-bold">RuntimeError</span>                              Traceback (most recent call last)
<span class="ansi-green-intense-fg ansi-bold">c:\program files\python38\lib\site-packages\IPython\core\formatters.py</span> in <span class="ansi-cyan-fg">__call__</span><span class="ansi-blue-intense-fg ansi-bold">(self, obj)</span>
<span class="ansi-green-fg">    339</span>                 <span class="ansi-green-intense-fg ansi-bold">pass</span>
<span class="ansi-green-fg">    340</span>             <span class="ansi-green-intense-fg ansi-bold">else</span><span class="ansi-yellow-intense-fg ansi-bold">:</span>
<span class="ansi-green-intense-fg ansi-bold">--&gt; 341</span><span class="ansi-yellow-intense-fg ansi-bold">                 </span><span class="ansi-green-intense-fg ansi-bold">return</span> printer<span class="ansi-yellow-intense-fg ansi-bold">(</span>obj<span class="ansi-yellow-intense-fg ansi-bold">)</span>
<span class="ansi-green-fg">    342</span>             <span class="ansi-red-intense-fg ansi-bold"># Finally look for special method names</span>
<span class="ansi-green-fg">    343</span>             method <span class="ansi-yellow-intense-fg ansi-bold">=</span> get_real_method<span class="ansi-yellow-intense-fg ansi-bold">(</span>obj<span class="ansi-yellow-intense-fg ansi-bold">,</span> self<span class="ansi-yellow-intense-fg ansi-bold">.</span>print_method<span class="ansi-yellow-intense-fg ansi-bold">)</span>

<span class="ansi-green-intense-fg ansi-bold">c:\program files\python38\lib\site-packages\IPython\core\pylabtools.py</span> in <span class="ansi-cyan-fg">&lt;lambda&gt;</span><span class="ansi-blue-intense-fg ansi-bold">(fig)</span>
<span class="ansi-green-fg">    246</span> 
<span class="ansi-green-fg">    247</span>     <span class="ansi-green-intense-fg ansi-bold">if</span> <span class="ansi-blue-intense-fg ansi-bold">&#39;png&#39;</span> <span class="ansi-green-intense-fg ansi-bold">in</span> formats<span class="ansi-yellow-intense-fg ansi-bold">:</span>
<span class="ansi-green-intense-fg ansi-bold">--&gt; 248</span><span class="ansi-yellow-intense-fg ansi-bold">         </span>png_formatter<span class="ansi-yellow-intense-fg ansi-bold">.</span>for_type<span class="ansi-yellow-intense-fg ansi-bold">(</span>Figure<span class="ansi-yellow-intense-fg ansi-bold">,</span> <span class="ansi-green-intense-fg ansi-bold">lambda</span> fig<span class="ansi-yellow-intense-fg ansi-bold">:</span> print_figure<span class="ansi-yellow-intense-fg ansi-bold">(</span>fig<span class="ansi-yellow-intense-fg ansi-bold">,</span> <span class="ansi-blue-intense-fg ansi-bold">&#39;png&#39;</span><span class="ansi-yellow-intense-fg ansi-bold">,</span> <span class="ansi-yellow-intense-fg ansi-bold">**</span>kwargs<span class="ansi-yellow-intense-fg ansi-bold">)</span><span class="ansi-yellow-intense-fg ansi-bold">)</span>
<span class="ansi-green-fg">    249</span>     <span class="ansi-green-intense-fg ansi-bold">if</span> <span class="ansi-blue-intense-fg ansi-bold">&#39;retina&#39;</span> <span class="ansi-green-intense-fg ansi-bold">in</span> formats <span class="ansi-green-intense-fg ansi-bold">or</span> <span class="ansi-blue-intense-fg ansi-bold">&#39;png2x&#39;</span> <span class="ansi-green-intense-fg ansi-bold">in</span> formats<span class="ansi-yellow-intense-fg ansi-bold">:</span>
<span class="ansi-green-fg">    250</span>         png_formatter<span class="ansi-yellow-intense-fg ansi-bold">.</span>for_type<span class="ansi-yellow-intense-fg ansi-bold">(</span>Figure<span class="ansi-yellow-intense-fg ansi-bold">,</span> <span class="ansi-green-intense-fg ansi-bold">lambda</span> fig<span class="ansi-yellow-intense-fg ansi-bold">:</span> retina_figure<span class="ansi-yellow-intense-fg ansi-bold">(</span>fig<span class="ansi-yellow-intense-fg ansi-bold">,</span> <span class="ansi-yellow-intense-fg ansi-bold">**</span>kwargs<span class="ansi-yellow-intense-fg ansi-bold">)</span><span class="ansi-yellow-intense-fg ansi-bold">)</span>

<span class="ansi-green-intense-fg ansi-bold">c:\program files\python38\lib\site-packages\IPython\core\pylabtools.py</span> in <span class="ansi-cyan-fg">print_figure</span><span class="ansi-blue-intense-fg ansi-bold">(fig, fmt, bbox_inches, **kwargs)</span>
<span class="ansi-green-fg">    130</span>         FigureCanvasBase<span class="ansi-yellow-intense-fg ansi-bold">(</span>fig<span class="ansi-yellow-intense-fg ansi-bold">)</span>
<span class="ansi-green-fg">    131</span> 
<span class="ansi-green-intense-fg ansi-bold">--&gt; 132</span><span class="ansi-yellow-intense-fg ansi-bold">     </span>fig<span class="ansi-yellow-intense-fg ansi-bold">.</span>canvas<span class="ansi-yellow-intense-fg ansi-bold">.</span>print_figure<span class="ansi-yellow-intense-fg ansi-bold">(</span>bytes_io<span class="ansi-yellow-intense-fg ansi-bold">,</span> <span class="ansi-yellow-intense-fg ansi-bold">**</span>kw<span class="ansi-yellow-intense-fg ansi-bold">)</span>
<span class="ansi-green-fg">    133</span>     data <span class="ansi-yellow-intense-fg ansi-bold">=</span> bytes_io<span class="ansi-yellow-intense-fg ansi-bold">.</span>getvalue<span class="ansi-yellow-intense-fg ansi-bold">(</span><span class="ansi-yellow-intense-fg ansi-bold">)</span>
<span class="ansi-green-fg">    134</span>     <span class="ansi-green-intense-fg ansi-bold">if</span> fmt <span class="ansi-yellow-intense-fg ansi-bold">==</span> <span class="ansi-blue-intense-fg ansi-bold">&#39;svg&#39;</span><span class="ansi-yellow-intense-fg ansi-bold">:</span>

<span class="ansi-green-intense-fg ansi-bold">~\AppData\Roaming\Python\Python38\site-packages\matplotlib\backend_bases.py</span> in <span class="ansi-cyan-fg">print_figure</span><span class="ansi-blue-intense-fg ansi-bold">(self, filename, dpi, facecolor, edgecolor, orientation, format, bbox_inches, pad_inches, bbox_extra_artists, backend, **kwargs)</span>
<span class="ansi-green-fg">   2228</span>                        else suppress())
<span class="ansi-green-fg">   2229</span>                 <span class="ansi-green-intense-fg ansi-bold">with</span> ctx<span class="ansi-yellow-intense-fg ansi-bold">:</span>
<span class="ansi-green-intense-fg ansi-bold">-&gt; 2230</span><span class="ansi-yellow-intense-fg ansi-bold">                     </span>self<span class="ansi-yellow-intense-fg ansi-bold">.</span>figure<span class="ansi-yellow-intense-fg ansi-bold">.</span>draw<span class="ansi-yellow-intense-fg ansi-bold">(</span>renderer<span class="ansi-yellow-intense-fg ansi-bold">)</span>
<span class="ansi-green-fg">   2231</span> 
<span class="ansi-green-fg">   2232</span>             <span class="ansi-green-intense-fg ansi-bold">if</span> bbox_inches<span class="ansi-yellow-intense-fg ansi-bold">:</span>

<span class="ansi-green-intense-fg ansi-bold">~\AppData\Roaming\Python\Python38\site-packages\matplotlib\artist.py</span> in <span class="ansi-cyan-fg">draw_wrapper</span><span class="ansi-blue-intense-fg ansi-bold">(artist, renderer, *args, **kwargs)</span>
<span class="ansi-green-fg">     72</span>     <span class="ansi-yellow-intense-fg ansi-bold">@</span>wraps<span class="ansi-yellow-intense-fg ansi-bold">(</span>draw<span class="ansi-yellow-intense-fg ansi-bold">)</span>
<span class="ansi-green-fg">     73</span>     <span class="ansi-green-intense-fg ansi-bold">def</span> draw_wrapper<span class="ansi-yellow-intense-fg ansi-bold">(</span>artist<span class="ansi-yellow-intense-fg ansi-bold">,</span> renderer<span class="ansi-yellow-intense-fg ansi-bold">,</span> <span class="ansi-yellow-intense-fg ansi-bold">*</span>args<span class="ansi-yellow-intense-fg ansi-bold">,</span> <span class="ansi-yellow-intense-fg ansi-bold">**</span>kwargs<span class="ansi-yellow-intense-fg ansi-bold">)</span><span class="ansi-yellow-intense-fg ansi-bold">:</span>
<span class="ansi-green-intense-fg ansi-bold">---&gt; 74</span><span class="ansi-yellow-intense-fg ansi-bold">         </span>result <span class="ansi-yellow-intense-fg ansi-bold">=</span> draw<span class="ansi-yellow-intense-fg ansi-bold">(</span>artist<span class="ansi-yellow-intense-fg ansi-bold">,</span> renderer<span class="ansi-yellow-intense-fg ansi-bold">,</span> <span class="ansi-yellow-intense-fg ansi-bold">*</span>args<span class="ansi-yellow-intense-fg ansi-bold">,</span> <span class="ansi-yellow-intense-fg ansi-bold">**</span>kwargs<span class="ansi-yellow-intense-fg ansi-bold">)</span>
<span class="ansi-green-fg">     75</span>         <span class="ansi-green-intense-fg ansi-bold">if</span> renderer<span class="ansi-yellow-intense-fg ansi-bold">.</span>_rasterizing<span class="ansi-yellow-intense-fg ansi-bold">:</span>
<span class="ansi-green-fg">     76</span>             renderer<span class="ansi-yellow-intense-fg ansi-bold">.</span>stop_rasterizing<span class="ansi-yellow-intense-fg ansi-bold">(</span><span class="ansi-yellow-intense-fg ansi-bold">)</span>

<span class="ansi-green-intense-fg ansi-bold">~\AppData\Roaming\Python\Python38\site-packages\matplotlib\artist.py</span> in <span class="ansi-cyan-fg">draw_wrapper</span><span class="ansi-blue-intense-fg ansi-bold">(artist, renderer, *args, **kwargs)</span>
<span class="ansi-green-fg">     49</span>                 renderer<span class="ansi-yellow-intense-fg ansi-bold">.</span>start_filter<span class="ansi-yellow-intense-fg ansi-bold">(</span><span class="ansi-yellow-intense-fg ansi-bold">)</span>
<span class="ansi-green-fg">     50</span> 
<span class="ansi-green-intense-fg ansi-bold">---&gt; 51</span><span class="ansi-yellow-intense-fg ansi-bold">             </span><span class="ansi-green-intense-fg ansi-bold">return</span> draw<span class="ansi-yellow-intense-fg ansi-bold">(</span>artist<span class="ansi-yellow-intense-fg ansi-bold">,</span> renderer<span class="ansi-yellow-intense-fg ansi-bold">,</span> <span class="ansi-yellow-intense-fg ansi-bold">*</span>args<span class="ansi-yellow-intense-fg ansi-bold">,</span> <span class="ansi-yellow-intense-fg ansi-bold">**</span>kwargs<span class="ansi-yellow-intense-fg ansi-bold">)</span>
<span class="ansi-green-fg">     52</span>         <span class="ansi-green-intense-fg ansi-bold">finally</span><span class="ansi-yellow-intense-fg ansi-bold">:</span>
<span class="ansi-green-fg">     53</span>             <span class="ansi-green-intense-fg ansi-bold">if</span> artist<span class="ansi-yellow-intense-fg ansi-bold">.</span>get_agg_filter<span class="ansi-yellow-intense-fg ansi-bold">(</span><span class="ansi-yellow-intense-fg ansi-bold">)</span> <span class="ansi-green-intense-fg ansi-bold">is</span> <span class="ansi-green-intense-fg ansi-bold">not</span> <span class="ansi-green-intense-fg ansi-bold">None</span><span class="ansi-yellow-intense-fg ansi-bold">:</span>

<span class="ansi-green-intense-fg ansi-bold">~\AppData\Roaming\Python\Python38\site-packages\matplotlib\figure.py</span> in <span class="ansi-cyan-fg">draw</span><span class="ansi-blue-intense-fg ansi-bold">(self, renderer)</span>
<span class="ansi-green-fg">   2735</span> 
<span class="ansi-green-fg">   2736</span>             self<span class="ansi-yellow-intense-fg ansi-bold">.</span>patch<span class="ansi-yellow-intense-fg ansi-bold">.</span>draw<span class="ansi-yellow-intense-fg ansi-bold">(</span>renderer<span class="ansi-yellow-intense-fg ansi-bold">)</span>
<span class="ansi-green-intense-fg ansi-bold">-&gt; 2737</span><span class="ansi-yellow-intense-fg ansi-bold">             mimage._draw_list_compositing_images(
</span><span class="ansi-green-fg">   2738</span>                 renderer, self, artists, self.suppressComposite)
<span class="ansi-green-fg">   2739</span> 

<span class="ansi-green-intense-fg ansi-bold">~\AppData\Roaming\Python\Python38\site-packages\matplotlib\image.py</span> in <span class="ansi-cyan-fg">_draw_list_compositing_images</span><span class="ansi-blue-intense-fg ansi-bold">(renderer, parent, artists, suppress_composite)</span>
<span class="ansi-green-fg">    130</span>     <span class="ansi-green-intense-fg ansi-bold">if</span> not_composite <span class="ansi-green-intense-fg ansi-bold">or</span> <span class="ansi-green-intense-fg ansi-bold">not</span> has_images<span class="ansi-yellow-intense-fg ansi-bold">:</span>
<span class="ansi-green-fg">    131</span>         <span class="ansi-green-intense-fg ansi-bold">for</span> a <span class="ansi-green-intense-fg ansi-bold">in</span> artists<span class="ansi-yellow-intense-fg ansi-bold">:</span>
<span class="ansi-green-intense-fg ansi-bold">--&gt; 132</span><span class="ansi-yellow-intense-fg ansi-bold">             </span>a<span class="ansi-yellow-intense-fg ansi-bold">.</span>draw<span class="ansi-yellow-intense-fg ansi-bold">(</span>renderer<span class="ansi-yellow-intense-fg ansi-bold">)</span>
<span class="ansi-green-fg">    133</span>     <span class="ansi-green-intense-fg ansi-bold">else</span><span class="ansi-yellow-intense-fg ansi-bold">:</span>
<span class="ansi-green-fg">    134</span>         <span class="ansi-red-intense-fg ansi-bold"># Composite any adjacent images together</span>

<span class="ansi-green-intense-fg ansi-bold">~\AppData\Roaming\Python\Python38\site-packages\matplotlib\artist.py</span> in <span class="ansi-cyan-fg">draw_wrapper</span><span class="ansi-blue-intense-fg ansi-bold">(artist, renderer, *args, **kwargs)</span>
<span class="ansi-green-fg">     49</span>                 renderer<span class="ansi-yellow-intense-fg ansi-bold">.</span>start_filter<span class="ansi-yellow-intense-fg ansi-bold">(</span><span class="ansi-yellow-intense-fg ansi-bold">)</span>
<span class="ansi-green-fg">     50</span> 
<span class="ansi-green-intense-fg ansi-bold">---&gt; 51</span><span class="ansi-yellow-intense-fg ansi-bold">             </span><span class="ansi-green-intense-fg ansi-bold">return</span> draw<span class="ansi-yellow-intense-fg ansi-bold">(</span>artist<span class="ansi-yellow-intense-fg ansi-bold">,</span> renderer<span class="ansi-yellow-intense-fg ansi-bold">,</span> <span class="ansi-yellow-intense-fg ansi-bold">*</span>args<span class="ansi-yellow-intense-fg ansi-bold">,</span> <span class="ansi-yellow-intense-fg ansi-bold">**</span>kwargs<span class="ansi-yellow-intense-fg ansi-bold">)</span>
<span class="ansi-green-fg">     52</span>         <span class="ansi-green-intense-fg ansi-bold">finally</span><span class="ansi-yellow-intense-fg ansi-bold">:</span>
<span class="ansi-green-fg">     53</span>             <span class="ansi-green-intense-fg ansi-bold">if</span> artist<span class="ansi-yellow-intense-fg ansi-bold">.</span>get_agg_filter<span class="ansi-yellow-intense-fg ansi-bold">(</span><span class="ansi-yellow-intense-fg ansi-bold">)</span> <span class="ansi-green-intense-fg ansi-bold">is</span> <span class="ansi-green-intense-fg ansi-bold">not</span> <span class="ansi-green-intense-fg ansi-bold">None</span><span class="ansi-yellow-intense-fg ansi-bold">:</span>

<span class="ansi-green-intense-fg ansi-bold">~\AppData\Roaming\Python\Python38\site-packages\matplotlib\_api\deprecation.py</span> in <span class="ansi-cyan-fg">wrapper</span><span class="ansi-blue-intense-fg ansi-bold">(*inner_args, **inner_kwargs)</span>
<span class="ansi-green-fg">    429</span>                          <span class="ansi-green-intense-fg ansi-bold">else</span> deprecation_addendum<span class="ansi-yellow-intense-fg ansi-bold">,</span>
<span class="ansi-green-fg">    430</span>                 **kwargs)
<span class="ansi-green-intense-fg ansi-bold">--&gt; 431</span><span class="ansi-yellow-intense-fg ansi-bold">         </span><span class="ansi-green-intense-fg ansi-bold">return</span> func<span class="ansi-yellow-intense-fg ansi-bold">(</span><span class="ansi-yellow-intense-fg ansi-bold">*</span>inner_args<span class="ansi-yellow-intense-fg ansi-bold">,</span> <span class="ansi-yellow-intense-fg ansi-bold">**</span>inner_kwargs<span class="ansi-yellow-intense-fg ansi-bold">)</span>
<span class="ansi-green-fg">    432</span> 
<span class="ansi-green-fg">    433</span>     <span class="ansi-green-intense-fg ansi-bold">return</span> wrapper

<span class="ansi-green-intense-fg ansi-bold">~\AppData\Roaming\Python\Python38\site-packages\matplotlib\axes\_base.py</span> in <span class="ansi-cyan-fg">draw</span><span class="ansi-blue-intense-fg ansi-bold">(self, renderer, inframe)</span>
<span class="ansi-green-fg">   2923</span>             renderer<span class="ansi-yellow-intense-fg ansi-bold">.</span>stop_rasterizing<span class="ansi-yellow-intense-fg ansi-bold">(</span><span class="ansi-yellow-intense-fg ansi-bold">)</span>
<span class="ansi-green-fg">   2924</span> 
<span class="ansi-green-intense-fg ansi-bold">-&gt; 2925</span><span class="ansi-yellow-intense-fg ansi-bold">         </span>mimage<span class="ansi-yellow-intense-fg ansi-bold">.</span>_draw_list_compositing_images<span class="ansi-yellow-intense-fg ansi-bold">(</span>renderer<span class="ansi-yellow-intense-fg ansi-bold">,</span> self<span class="ansi-yellow-intense-fg ansi-bold">,</span> artists<span class="ansi-yellow-intense-fg ansi-bold">)</span>
<span class="ansi-green-fg">   2926</span> 
<span class="ansi-green-fg">   2927</span>         renderer<span class="ansi-yellow-intense-fg ansi-bold">.</span>close_group<span class="ansi-yellow-intense-fg ansi-bold">(</span><span class="ansi-blue-intense-fg ansi-bold">&#39;axes&#39;</span><span class="ansi-yellow-intense-fg ansi-bold">)</span>

<span class="ansi-green-intense-fg ansi-bold">~\AppData\Roaming\Python\Python38\site-packages\matplotlib\image.py</span> in <span class="ansi-cyan-fg">_draw_list_compositing_images</span><span class="ansi-blue-intense-fg ansi-bold">(renderer, parent, artists, suppress_composite)</span>
<span class="ansi-green-fg">    130</span>     <span class="ansi-green-intense-fg ansi-bold">if</span> not_composite <span class="ansi-green-intense-fg ansi-bold">or</span> <span class="ansi-green-intense-fg ansi-bold">not</span> has_images<span class="ansi-yellow-intense-fg ansi-bold">:</span>
<span class="ansi-green-fg">    131</span>         <span class="ansi-green-intense-fg ansi-bold">for</span> a <span class="ansi-green-intense-fg ansi-bold">in</span> artists<span class="ansi-yellow-intense-fg ansi-bold">:</span>
<span class="ansi-green-intense-fg ansi-bold">--&gt; 132</span><span class="ansi-yellow-intense-fg ansi-bold">             </span>a<span class="ansi-yellow-intense-fg ansi-bold">.</span>draw<span class="ansi-yellow-intense-fg ansi-bold">(</span>renderer<span class="ansi-yellow-intense-fg ansi-bold">)</span>
<span class="ansi-green-fg">    133</span>     <span class="ansi-green-intense-fg ansi-bold">else</span><span class="ansi-yellow-intense-fg ansi-bold">:</span>
<span class="ansi-green-fg">    134</span>         <span class="ansi-red-intense-fg ansi-bold"># Composite any adjacent images together</span>

<span class="ansi-green-intense-fg ansi-bold">~\AppData\Roaming\Python\Python38\site-packages\matplotlib\artist.py</span> in <span class="ansi-cyan-fg">draw_wrapper</span><span class="ansi-blue-intense-fg ansi-bold">(artist, renderer, *args, **kwargs)</span>
<span class="ansi-green-fg">     49</span>                 renderer<span class="ansi-yellow-intense-fg ansi-bold">.</span>start_filter<span class="ansi-yellow-intense-fg ansi-bold">(</span><span class="ansi-yellow-intense-fg ansi-bold">)</span>
<span class="ansi-green-fg">     50</span> 
<span class="ansi-green-intense-fg ansi-bold">---&gt; 51</span><span class="ansi-yellow-intense-fg ansi-bold">             </span><span class="ansi-green-intense-fg ansi-bold">return</span> draw<span class="ansi-yellow-intense-fg ansi-bold">(</span>artist<span class="ansi-yellow-intense-fg ansi-bold">,</span> renderer<span class="ansi-yellow-intense-fg ansi-bold">,</span> <span class="ansi-yellow-intense-fg ansi-bold">*</span>args<span class="ansi-yellow-intense-fg ansi-bold">,</span> <span class="ansi-yellow-intense-fg ansi-bold">**</span>kwargs<span class="ansi-yellow-intense-fg ansi-bold">)</span>
<span class="ansi-green-fg">     52</span>         <span class="ansi-green-intense-fg ansi-bold">finally</span><span class="ansi-yellow-intense-fg ansi-bold">:</span>
<span class="ansi-green-fg">     53</span>             <span class="ansi-green-intense-fg ansi-bold">if</span> artist<span class="ansi-yellow-intense-fg ansi-bold">.</span>get_agg_filter<span class="ansi-yellow-intense-fg ansi-bold">(</span><span class="ansi-yellow-intense-fg ansi-bold">)</span> <span class="ansi-green-intense-fg ansi-bold">is</span> <span class="ansi-green-intense-fg ansi-bold">not</span> <span class="ansi-green-intense-fg ansi-bold">None</span><span class="ansi-yellow-intense-fg ansi-bold">:</span>

<span class="ansi-green-intense-fg ansi-bold">~\AppData\Roaming\Python\Python38\site-packages\matplotlib\axis.py</span> in <span class="ansi-cyan-fg">draw</span><span class="ansi-blue-intense-fg ansi-bold">(self, renderer, *args, **kwargs)</span>
<span class="ansi-green-fg">   1129</span> 
<span class="ansi-green-fg">   1130</span>         ticks_to_draw <span class="ansi-yellow-intense-fg ansi-bold">=</span> self<span class="ansi-yellow-intense-fg ansi-bold">.</span>_update_ticks<span class="ansi-yellow-intense-fg ansi-bold">(</span><span class="ansi-yellow-intense-fg ansi-bold">)</span>
<span class="ansi-green-intense-fg ansi-bold">-&gt; 1131</span><span class="ansi-yellow-intense-fg ansi-bold">         ticklabelBoxes, ticklabelBoxes2 = self._get_tick_bboxes(ticks_to_draw,
</span><span class="ansi-green-fg">   1132</span>                                                                 renderer)
<span class="ansi-green-fg">   1133</span> 

<span class="ansi-green-intense-fg ansi-bold">~\AppData\Roaming\Python\Python38\site-packages\matplotlib\axis.py</span> in <span class="ansi-cyan-fg">_get_tick_bboxes</span><span class="ansi-blue-intense-fg ansi-bold">(self, ticks, renderer)</span>
<span class="ansi-green-fg">   1055</span>     <span class="ansi-green-intense-fg ansi-bold">def</span> _get_tick_bboxes<span class="ansi-yellow-intense-fg ansi-bold">(</span>self<span class="ansi-yellow-intense-fg ansi-bold">,</span> ticks<span class="ansi-yellow-intense-fg ansi-bold">,</span> renderer<span class="ansi-yellow-intense-fg ansi-bold">)</span><span class="ansi-yellow-intense-fg ansi-bold">:</span>
<span class="ansi-green-fg">   1056</span>         <span class="ansi-blue-intense-fg ansi-bold">&#34;&#34;&#34;Return lists of bboxes for ticks&#39; label1&#39;s and label2&#39;s.&#34;&#34;&#34;</span>
<span class="ansi-green-intense-fg ansi-bold">-&gt; 1057</span><span class="ansi-yellow-intense-fg ansi-bold">         return ([tick.label1.get_window_extent(renderer)
</span><span class="ansi-green-fg">   1058</span>                  for tick in ticks if tick.label1.get_visible()],
<span class="ansi-green-fg">   1059</span>                 [tick.label2.get_window_extent(renderer)

<span class="ansi-green-intense-fg ansi-bold">~\AppData\Roaming\Python\Python38\site-packages\matplotlib\axis.py</span> in <span class="ansi-cyan-fg">&lt;listcomp&gt;</span><span class="ansi-blue-intense-fg ansi-bold">(.0)</span>
<span class="ansi-green-fg">   1055</span>     <span class="ansi-green-intense-fg ansi-bold">def</span> _get_tick_bboxes<span class="ansi-yellow-intense-fg ansi-bold">(</span>self<span class="ansi-yellow-intense-fg ansi-bold">,</span> ticks<span class="ansi-yellow-intense-fg ansi-bold">,</span> renderer<span class="ansi-yellow-intense-fg ansi-bold">)</span><span class="ansi-yellow-intense-fg ansi-bold">:</span>
<span class="ansi-green-fg">   1056</span>         <span class="ansi-blue-intense-fg ansi-bold">&#34;&#34;&#34;Return lists of bboxes for ticks&#39; label1&#39;s and label2&#39;s.&#34;&#34;&#34;</span>
<span class="ansi-green-intense-fg ansi-bold">-&gt; 1057</span><span class="ansi-yellow-intense-fg ansi-bold">         return ([tick.label1.get_window_extent(renderer)
</span><span class="ansi-green-fg">   1058</span>                  for tick in ticks if tick.label1.get_visible()],
<span class="ansi-green-fg">   1059</span>                 [tick.label2.get_window_extent(renderer)

<span class="ansi-green-intense-fg ansi-bold">~\AppData\Roaming\Python\Python38\site-packages\matplotlib\text.py</span> in <span class="ansi-cyan-fg">get_window_extent</span><span class="ansi-blue-intense-fg ansi-bold">(self, renderer, dpi)</span>
<span class="ansi-green-fg">    901</span> 
<span class="ansi-green-fg">    902</span>         <span class="ansi-green-intense-fg ansi-bold">with</span> cbook<span class="ansi-yellow-intense-fg ansi-bold">.</span>_setattr_cm<span class="ansi-yellow-intense-fg ansi-bold">(</span>self<span class="ansi-yellow-intense-fg ansi-bold">.</span>figure<span class="ansi-yellow-intense-fg ansi-bold">,</span> dpi<span class="ansi-yellow-intense-fg ansi-bold">=</span>dpi<span class="ansi-yellow-intense-fg ansi-bold">)</span><span class="ansi-yellow-intense-fg ansi-bold">:</span>
<span class="ansi-green-intense-fg ansi-bold">--&gt; 903</span><span class="ansi-yellow-intense-fg ansi-bold">             </span>bbox<span class="ansi-yellow-intense-fg ansi-bold">,</span> info<span class="ansi-yellow-intense-fg ansi-bold">,</span> descent <span class="ansi-yellow-intense-fg ansi-bold">=</span> self<span class="ansi-yellow-intense-fg ansi-bold">.</span>_get_layout<span class="ansi-yellow-intense-fg ansi-bold">(</span>self<span class="ansi-yellow-intense-fg ansi-bold">.</span>_renderer<span class="ansi-yellow-intense-fg ansi-bold">)</span>
<span class="ansi-green-fg">    904</span>             x<span class="ansi-yellow-intense-fg ansi-bold">,</span> y <span class="ansi-yellow-intense-fg ansi-bold">=</span> self<span class="ansi-yellow-intense-fg ansi-bold">.</span>get_unitless_position<span class="ansi-yellow-intense-fg ansi-bold">(</span><span class="ansi-yellow-intense-fg ansi-bold">)</span>
<span class="ansi-green-fg">    905</span>             x<span class="ansi-yellow-intense-fg ansi-bold">,</span> y <span class="ansi-yellow-intense-fg ansi-bold">=</span> self<span class="ansi-yellow-intense-fg ansi-bold">.</span>get_transform<span class="ansi-yellow-intense-fg ansi-bold">(</span><span class="ansi-yellow-intense-fg ansi-bold">)</span><span class="ansi-yellow-intense-fg ansi-bold">.</span>transform<span class="ansi-yellow-intense-fg ansi-bold">(</span><span class="ansi-yellow-intense-fg ansi-bold">(</span>x<span class="ansi-yellow-intense-fg ansi-bold">,</span> y<span class="ansi-yellow-intense-fg ansi-bold">)</span><span class="ansi-yellow-intense-fg ansi-bold">)</span>

<span class="ansi-green-intense-fg ansi-bold">~\AppData\Roaming\Python\Python38\site-packages\matplotlib\text.py</span> in <span class="ansi-cyan-fg">_get_layout</span><span class="ansi-blue-intense-fg ansi-bold">(self, renderer)</span>
<span class="ansi-green-fg">    304</span> 
<span class="ansi-green-fg">    305</span>         <span class="ansi-red-intense-fg ansi-bold"># Full vertical extent of font, including ascenders and descenders:</span>
<span class="ansi-green-intense-fg ansi-bold">--&gt; 306</span><span class="ansi-yellow-intense-fg ansi-bold">         _, lp_h, lp_d = renderer.get_text_width_height_descent(
</span><span class="ansi-green-fg">    307</span>             <span class="ansi-blue-intense-fg ansi-bold">&#34;lp&#34;</span><span class="ansi-yellow-intense-fg ansi-bold">,</span> self<span class="ansi-yellow-intense-fg ansi-bold">.</span>_fontproperties<span class="ansi-yellow-intense-fg ansi-bold">,</span>
<span class="ansi-green-fg">    308</span>             ismath=&#34;TeX&#34; if self.get_usetex() else False)

<span class="ansi-green-intense-fg ansi-bold">~\AppData\Roaming\Python\Python38\site-packages\matplotlib\backends\backend_agg.py</span> in <span class="ansi-cyan-fg">get_text_width_height_descent</span><span class="ansi-blue-intense-fg ansi-bold">(self, s, prop, ismath)</span>
<span class="ansi-green-fg">    227</span>             texmanager <span class="ansi-yellow-intense-fg ansi-bold">=</span> self<span class="ansi-yellow-intense-fg ansi-bold">.</span>get_texmanager<span class="ansi-yellow-intense-fg ansi-bold">(</span><span class="ansi-yellow-intense-fg ansi-bold">)</span>
<span class="ansi-green-fg">    228</span>             fontsize <span class="ansi-yellow-intense-fg ansi-bold">=</span> prop<span class="ansi-yellow-intense-fg ansi-bold">.</span>get_size_in_points<span class="ansi-yellow-intense-fg ansi-bold">(</span><span class="ansi-yellow-intense-fg ansi-bold">)</span>
<span class="ansi-green-intense-fg ansi-bold">--&gt; 229</span><span class="ansi-yellow-intense-fg ansi-bold">             w, h, d = texmanager.get_text_width_height_descent(
</span><span class="ansi-green-fg">    230</span>                 s, fontsize, renderer=self)
<span class="ansi-green-fg">    231</span>             <span class="ansi-green-intense-fg ansi-bold">return</span> w<span class="ansi-yellow-intense-fg ansi-bold">,</span> h<span class="ansi-yellow-intense-fg ansi-bold">,</span> d

<span class="ansi-green-intense-fg ansi-bold">~\AppData\Roaming\Python\Python38\site-packages\matplotlib\texmanager.py</span> in <span class="ansi-cyan-fg">get_text_width_height_descent</span><span class="ansi-blue-intense-fg ansi-bold">(self, tex, fontsize, renderer)</span>
<span class="ansi-green-fg">    397</span>         <span class="ansi-green-intense-fg ansi-bold">else</span><span class="ansi-yellow-intense-fg ansi-bold">:</span>
<span class="ansi-green-fg">    398</span>             <span class="ansi-red-intense-fg ansi-bold"># use dviread.</span>
<span class="ansi-green-intense-fg ansi-bold">--&gt; 399</span><span class="ansi-yellow-intense-fg ansi-bold">             </span>dvifile <span class="ansi-yellow-intense-fg ansi-bold">=</span> self<span class="ansi-yellow-intense-fg ansi-bold">.</span>make_dvi<span class="ansi-yellow-intense-fg ansi-bold">(</span>tex<span class="ansi-yellow-intense-fg ansi-bold">,</span> fontsize<span class="ansi-yellow-intense-fg ansi-bold">)</span>
<span class="ansi-green-fg">    400</span>             <span class="ansi-green-intense-fg ansi-bold">with</span> dviread<span class="ansi-yellow-intense-fg ansi-bold">.</span>Dvi<span class="ansi-yellow-intense-fg ansi-bold">(</span>dvifile<span class="ansi-yellow-intense-fg ansi-bold">,</span> <span class="ansi-cyan-intense-fg ansi-bold">72</span> <span class="ansi-yellow-intense-fg ansi-bold">*</span> dpi_fraction<span class="ansi-yellow-intense-fg ansi-bold">)</span> <span class="ansi-green-intense-fg ansi-bold">as</span> dvi<span class="ansi-yellow-intense-fg ansi-bold">:</span>
<span class="ansi-green-fg">    401</span>                 page<span class="ansi-yellow-intense-fg ansi-bold">,</span> <span class="ansi-yellow-intense-fg ansi-bold">=</span> dvi

<span class="ansi-green-intense-fg ansi-bold">~\AppData\Roaming\Python\Python38\site-packages\matplotlib\texmanager.py</span> in <span class="ansi-cyan-fg">make_dvi</span><span class="ansi-blue-intense-fg ansi-bold">(self, tex, fontsize)</span>
<span class="ansi-green-fg">    289</span>             <span class="ansi-red-intense-fg ansi-bold"># and thus replace() works atomically.</span>
<span class="ansi-green-fg">    290</span>             <span class="ansi-green-intense-fg ansi-bold">with</span> TemporaryDirectory<span class="ansi-yellow-intense-fg ansi-bold">(</span>dir<span class="ansi-yellow-intense-fg ansi-bold">=</span>Path<span class="ansi-yellow-intense-fg ansi-bold">(</span>dvifile<span class="ansi-yellow-intense-fg ansi-bold">)</span><span class="ansi-yellow-intense-fg ansi-bold">.</span>parent<span class="ansi-yellow-intense-fg ansi-bold">)</span> <span class="ansi-green-intense-fg ansi-bold">as</span> tmpdir<span class="ansi-yellow-intense-fg ansi-bold">:</span>
<span class="ansi-green-intense-fg ansi-bold">--&gt; 291</span><span class="ansi-yellow-intense-fg ansi-bold">                 self._run_checked_subprocess(
</span><span class="ansi-green-fg">    292</span>                     [&#34;latex&#34;, &#34;-interaction=nonstopmode&#34;, &#34;--halt-on-error&#34;,
<span class="ansi-green-fg">    293</span>                      texfile], tex, cwd=tmpdir)

<span class="ansi-green-intense-fg ansi-bold">~\AppData\Roaming\Python\Python38\site-packages\matplotlib\texmanager.py</span> in <span class="ansi-cyan-fg">_run_checked_subprocess</span><span class="ansi-blue-intense-fg ansi-bold">(self, command, tex, cwd)</span>
<span class="ansi-green-fg">    258</span>                 &#39;found&#39;.format(command[0])) from exc
<span class="ansi-green-fg">    259</span>         <span class="ansi-green-intense-fg ansi-bold">except</span> subprocess<span class="ansi-yellow-intense-fg ansi-bold">.</span>CalledProcessError <span class="ansi-green-intense-fg ansi-bold">as</span> exc<span class="ansi-yellow-intense-fg ansi-bold">:</span>
<span class="ansi-green-intense-fg ansi-bold">--&gt; 260</span><span class="ansi-yellow-intense-fg ansi-bold">             raise RuntimeError(
</span><span class="ansi-green-fg">    261</span>                 <span class="ansi-blue-intense-fg ansi-bold">&#39;{prog} was not able to process the following string:\n&#39;</span>
<span class="ansi-green-fg">    262</span>                 <span class="ansi-blue-intense-fg ansi-bold">&#39;{tex!r}\n\n&#39;</span>

<span class="ansi-red-intense-fg ansi-bold">RuntimeError</span>: latex was not able to process the following string:
b&#39;lp&#39;

Here is the full report generated by latex:
This is pdfTeX, Version 3.141592653-2.6-1.40.22 (MiKTeX 21.3)
entering extended mode
(C:/Users/janko/.matplotlib/tex.cache/1acea6f6c115d0ec7a634ed0529287b9.tex
LaTeX2e &lt;2020-10-01&gt; patch level 4
L3 programming layer &lt;2021-02-18&gt;
(C:\Users\janko\AppData\Local\Programs\MiKTeX\tex/latex/base\article.cls
Document Class: article 2020/04/10 v1.4m Standard LaTeX document class
(C:\Users\janko\AppData\Local\Programs\MiKTeX\tex/latex/base\size10.clo))
(C:\Users\janko\AppData\Local\Programs\MiKTeX\tex/latex/type1cm\type1cm.sty)
======================================================================
starting package maintenance...
installation directory: C:\Users\janko\AppData\Local\Programs\MiKTeX
package repository: http://ctan.mirror.ftn.uns.ac.rs/systems/win32/miktex/tm/packages/

Unfortunately, the package cm-super could not be installed.
Please check the log file:
C:\Users\janko\AppData\Local\MiKTeX\miktex\log\latex.log
======================================================================


! LaTeX Error: File `type1ec.sty&#39; not found.

Type X to quit or &lt;RETURN&gt; to proceed,
or enter new name. (Default extension: sty)

Enter file name: 
! Emergency stop.
&lt;read *&gt; 
         
l.6 \usepackage
               {type1ec}
No pages of output.
Transcript written on 1acea6f6c115d0ec7a634ed0529287b9.log.


</pre>
</div>
</div>

<div class="output_area">

    <div class="prompt"></div>




<div class="output_text output_subarea ">
<pre>&lt;Figure size 432x288 with 1 Axes&gt;</pre>
</div>

</div>

</div>
</div>

</div>
<div class="cell border-box-sizing text_cell rendered"><div class="prompt input_prompt">
</div><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>Analitično izračunajmo točen rezultat:</p>

</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In&nbsp;[5]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="kn">import</span> <span class="nn">sympy</span> <span class="k">as</span> <span class="nn">sym</span>
<span class="n">sym</span><span class="o">.</span><span class="n">init_printing</span><span class="p">()</span>
<span class="n">x</span> <span class="o">=</span> <span class="n">sym</span><span class="o">.</span><span class="n">symbols</span><span class="p">(</span><span class="s1">&#39;x&#39;</span><span class="p">)</span>
<span class="n">I_točno</span> <span class="o">=</span> <span class="nb">float</span><span class="p">(</span><span class="n">sym</span><span class="o">.</span><span class="n">integrate</span><span class="p">(</span><span class="n">x</span><span class="o">*</span><span class="n">sym</span><span class="o">.</span><span class="n">sin</span><span class="p">(</span><span class="n">x</span><span class="p">),</span> <span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">))</span><span class="o">.</span><span class="n">evalf</span><span class="p">())</span>
<span class="n">I_točno</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">


<div class="output_area">

    <div class="prompt output_prompt">Out[5]:</div>




<div class="output_latex output_subarea output_execute_result">
$\displaystyle 1.44042242098021$
</div>

</div>

</div>
</div>

</div>
<div class="cell border-box-sizing text_cell rendered"><div class="prompt input_prompt">
</div><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h1 id="Newton-Cotesov-pristop">Newton-Cotesov pristop<a class="anchor-link" href="#Newton-Cotesov-pristop">&#182;</a></h1>
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="prompt input_prompt">
</div><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>Na sliki je prikazan splošen primer, kjer je razdalja med vozlišči $x_i$ enaka $h$ (gre za <strong>ekvidistantno delitev</strong>).
<img src='./fig/integriranje.png' width=400></p>

</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="prompt input_prompt">
</div><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>V okviru tega poglavja si bomo najprej pogledali trapezno ter sestavljeno trapezno pravilo, pozneje pa bosta sledili še Simpsonova ter Rombergova metoda.</p>

</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="prompt input_prompt">
</div><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h2 id="Trapezno-pravilo">Trapezno pravilo<a class="anchor-link" href="#Trapezno-pravilo">&#182;</a></h2>
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="prompt input_prompt">
</div><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>Trapezno pravilo vrednosti podintegralske funkcije $f(x)$ na (pod)intervalu $[x_0, x_1]$ interpolira z linearno funkcijo. Za dve vozliščni točki to pomeni, da površino pod grafom funkcije približno izračunamo kot:</p>
$$I_{\textrm{trapezno}}=\sum_{i=0}^{n=1}A_i\,f(x_i)=\frac{h}{2}\cdot\left(f(x_0)+f(x_1)\right).$$<p>In so uteži:</p>
$$A_0 = A_1 = \frac{1}{2}\,h.$$
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="prompt input_prompt">
</div><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h3 id="Numeri&#269;na-implementacija">Numeri&#269;na implementacija<a class="anchor-link" href="#Numeri&#269;na-implementacija">&#182;</a></h3>
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="prompt input_prompt">
</div><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>Numerična implementacija je:</p>

</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In&nbsp;[6]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="k">def</span> <span class="nf">trapezno</span><span class="p">(</span><span class="n">y</span><span class="p">,</span> <span class="n">h</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Trapezno pravilo integriranja.</span>
<span class="sd">    </span>
<span class="sd">    :param y: funkcijske vrednosti</span>
<span class="sd">    :param h: korak integriranja</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">return</span> <span class="p">(</span><span class="n">y</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">+</span> <span class="n">y</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">])</span><span class="o">*</span><span class="n">h</span><span class="o">/</span><span class="mi">2</span>
</pre></div>

    </div>
</div>
</div>

</div>
<div class="cell border-box-sizing text_cell rendered"><div class="prompt input_prompt">
</div><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h3 id="Numeri&#269;ni-zgled">Numeri&#269;ni zgled<a class="anchor-link" href="#Numeri&#269;ni-zgled">&#182;</a></h3><p>V konkretnem primeru to pomeni, da prvo in zadnjo funkcijsko vrednost utežimo s $h/2$. V našem primeru je $h=1$:</p>

</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In&nbsp;[7]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">I_trapezno</span> <span class="o">=</span> <span class="n">trapezno</span><span class="p">(</span><span class="n">y2v</span><span class="p">,</span> <span class="n">h</span><span class="o">=</span><span class="n">h2v</span><span class="p">)</span>
<span class="n">I_trapezno</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">


<div class="output_area">

    <div class="prompt output_prompt">Out[7]:</div>




<div class="output_latex output_subarea output_execute_result">
$\displaystyle 1.33003291922963$
</div>

</div>

</div>
</div>

</div>
<div class="cell border-box-sizing text_cell rendered"><div class="prompt input_prompt">
</div><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>Pripravimo sliko:</p>

</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In&nbsp;[8]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="k">def</span> <span class="nf">fig_trapezno</span><span class="p">():</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">fill_between</span><span class="p">(</span><span class="n">x2v</span><span class="p">,</span> <span class="n">y2v</span><span class="p">,</span> <span class="n">alpha</span><span class="o">=</span><span class="mf">0.25</span><span class="p">,</span> <span class="n">facecolor</span><span class="o">=</span><span class="s1">&#39;r&#39;</span><span class="p">)</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">vlines</span><span class="p">(</span><span class="n">x2v</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="n">y2v</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;r&#39;</span><span class="p">,</span> <span class="n">linestyles</span><span class="o">=</span><span class="s1">&#39;dashed&#39;</span><span class="p">,</span> <span class="n">lw</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">annotate</span><span class="p">(</span><span class="s1">&#39;$I_{</span><span class="se">\\</span><span class="s1">textrm</span><span class="si">{trapezno}</span><span class="s1">}$&#39;</span><span class="p">,</span> <span class="p">(</span><span class="mf">1.4</span><span class="p">,</span> <span class="mf">0.5</span><span class="p">),</span> <span class="n">fontsize</span><span class="o">=</span><span class="mi">22</span><span class="p">)</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">annotate</span><span class="p">(</span><span class="s1">&#39;Napaka&#39;</span><span class="p">,</span> <span class="n">fontsize</span><span class="o">=</span><span class="mi">20</span><span class="p">,</span> <span class="n">xy</span><span class="o">=</span><span class="p">(</span><span class="mf">1.5</span><span class="p">,</span> <span class="mf">1.4</span><span class="p">),</span> <span class="n">xytext</span><span class="o">=</span><span class="p">(</span><span class="mf">1.6</span><span class="p">,</span> <span class="mf">1.8</span><span class="p">),</span>
            <span class="n">arrowprops</span><span class="o">=</span><span class="nb">dict</span><span class="p">(</span><span class="n">facecolor</span><span class="o">=</span><span class="s1">&#39;gray&#39;</span><span class="p">,</span> <span class="n">shrink</span><span class="o">=</span><span class="mf">0.05</span><span class="p">))</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">xg</span><span class="p">,</span> <span class="n">yg</span><span class="p">,</span> <span class="n">lw</span><span class="o">=</span><span class="mi">3</span><span class="p">,</span> <span class="n">alpha</span><span class="o">=</span><span class="mf">0.5</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s1">&#39;$x\,\sin(x)$&#39;</span><span class="p">)</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">x2v</span><span class="p">,</span> <span class="n">y2v</span><span class="p">,</span> <span class="s1">&#39;o&#39;</span><span class="p">,</span> <span class="n">alpha</span><span class="o">=</span><span class="mf">0.5</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="sa">f</span><span class="s1">&#39;$h=</span><span class="si">{</span><span class="n">h2v</span><span class="si">}</span><span class="s1">$&#39;</span><span class="p">)</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">legend</span><span class="p">(</span><span class="n">loc</span><span class="o">=</span><span class="p">(</span><span class="mf">1.01</span><span class="p">,</span> <span class="mi">0</span><span class="p">))</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">ylim</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">2</span><span class="p">)</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>

    </div>
</div>
</div>

</div>
<div class="cell border-box-sizing text_cell rendered"><div class="prompt input_prompt">
</div><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>Prikažemo:</p>

</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In&nbsp;[9]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">fig_trapezno</span><span class="p">()</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">


<div class="output_area">

    <div class="prompt"></div>


<div class="output_subarea output_text output_error">
<pre>
<span class="ansi-red-intense-fg ansi-bold">---------------------------------------------------------------------------</span>
<span class="ansi-red-intense-fg ansi-bold">CalledProcessError</span>                        Traceback (most recent call last)
<span class="ansi-green-intense-fg ansi-bold">~\AppData\Roaming\Python\Python38\site-packages\matplotlib\texmanager.py</span> in <span class="ansi-cyan-fg">_run_checked_subprocess</span><span class="ansi-blue-intense-fg ansi-bold">(self, command, tex, cwd)</span>
<span class="ansi-green-fg">    251</span>         <span class="ansi-green-intense-fg ansi-bold">try</span><span class="ansi-yellow-intense-fg ansi-bold">:</span>
<span class="ansi-green-intense-fg ansi-bold">--&gt; 252</span><span class="ansi-yellow-intense-fg ansi-bold">             report = subprocess.check_output(
</span><span class="ansi-green-fg">    253</span>                 command<span class="ansi-yellow-intense-fg ansi-bold">,</span> cwd<span class="ansi-yellow-intense-fg ansi-bold">=</span>cwd <span class="ansi-green-intense-fg ansi-bold">if</span> cwd <span class="ansi-green-intense-fg ansi-bold">is</span> <span class="ansi-green-intense-fg ansi-bold">not</span> <span class="ansi-green-intense-fg ansi-bold">None</span> <span class="ansi-green-intense-fg ansi-bold">else</span> self<span class="ansi-yellow-intense-fg ansi-bold">.</span>texcache<span class="ansi-yellow-intense-fg ansi-bold">,</span>

<span class="ansi-green-intense-fg ansi-bold">c:\program files\python38\lib\subprocess.py</span> in <span class="ansi-cyan-fg">check_output</span><span class="ansi-blue-intense-fg ansi-bold">(timeout, *popenargs, **kwargs)</span>
<span class="ansi-green-fg">    414</span> 
<span class="ansi-green-intense-fg ansi-bold">--&gt; 415</span><span class="ansi-yellow-intense-fg ansi-bold">     return run(*popenargs, stdout=PIPE, timeout=timeout, check=True,
</span><span class="ansi-green-fg">    416</span>                **kwargs).stdout

<span class="ansi-green-intense-fg ansi-bold">c:\program files\python38\lib\subprocess.py</span> in <span class="ansi-cyan-fg">run</span><span class="ansi-blue-intense-fg ansi-bold">(input, capture_output, timeout, check, *popenargs, **kwargs)</span>
<span class="ansi-green-fg">    515</span>         <span class="ansi-green-intense-fg ansi-bold">if</span> check <span class="ansi-green-intense-fg ansi-bold">and</span> retcode<span class="ansi-yellow-intense-fg ansi-bold">:</span>
<span class="ansi-green-intense-fg ansi-bold">--&gt; 516</span><span class="ansi-yellow-intense-fg ansi-bold">             raise CalledProcessError(retcode, process.args,
</span><span class="ansi-green-fg">    517</span>                                      output=stdout, stderr=stderr)

<span class="ansi-red-intense-fg ansi-bold">CalledProcessError</span>: Command &#39;[&#39;latex&#39;, &#39;-interaction=nonstopmode&#39;, &#39;--halt-on-error&#39;, &#39;C:\\Users\\janko\\.matplotlib\\tex.cache\\1acea6f6c115d0ec7a634ed0529287b9.tex&#39;]&#39; returned non-zero exit status 1.

The above exception was the direct cause of the following exception:

<span class="ansi-red-intense-fg ansi-bold">RuntimeError</span>                              Traceback (most recent call last)
<span class="ansi-green-intense-fg ansi-bold">c:\program files\python38\lib\site-packages\IPython\core\formatters.py</span> in <span class="ansi-cyan-fg">__call__</span><span class="ansi-blue-intense-fg ansi-bold">(self, obj)</span>
<span class="ansi-green-fg">    339</span>                 <span class="ansi-green-intense-fg ansi-bold">pass</span>
<span class="ansi-green-fg">    340</span>             <span class="ansi-green-intense-fg ansi-bold">else</span><span class="ansi-yellow-intense-fg ansi-bold">:</span>
<span class="ansi-green-intense-fg ansi-bold">--&gt; 341</span><span class="ansi-yellow-intense-fg ansi-bold">                 </span><span class="ansi-green-intense-fg ansi-bold">return</span> printer<span class="ansi-yellow-intense-fg ansi-bold">(</span>obj<span class="ansi-yellow-intense-fg ansi-bold">)</span>
<span class="ansi-green-fg">    342</span>             <span class="ansi-red-intense-fg ansi-bold"># Finally look for special method names</span>
<span class="ansi-green-fg">    343</span>             method <span class="ansi-yellow-intense-fg ansi-bold">=</span> get_real_method<span class="ansi-yellow-intense-fg ansi-bold">(</span>obj<span class="ansi-yellow-intense-fg ansi-bold">,</span> self<span class="ansi-yellow-intense-fg ansi-bold">.</span>print_method<span class="ansi-yellow-intense-fg ansi-bold">)</span>

<span class="ansi-green-intense-fg ansi-bold">c:\program files\python38\lib\site-packages\IPython\core\pylabtools.py</span> in <span class="ansi-cyan-fg">&lt;lambda&gt;</span><span class="ansi-blue-intense-fg ansi-bold">(fig)</span>
<span class="ansi-green-fg">    246</span> 
<span class="ansi-green-fg">    247</span>     <span class="ansi-green-intense-fg ansi-bold">if</span> <span class="ansi-blue-intense-fg ansi-bold">&#39;png&#39;</span> <span class="ansi-green-intense-fg ansi-bold">in</span> formats<span class="ansi-yellow-intense-fg ansi-bold">:</span>
<span class="ansi-green-intense-fg ansi-bold">--&gt; 248</span><span class="ansi-yellow-intense-fg ansi-bold">         </span>png_formatter<span class="ansi-yellow-intense-fg ansi-bold">.</span>for_type<span class="ansi-yellow-intense-fg ansi-bold">(</span>Figure<span class="ansi-yellow-intense-fg ansi-bold">,</span> <span class="ansi-green-intense-fg ansi-bold">lambda</span> fig<span class="ansi-yellow-intense-fg ansi-bold">:</span> print_figure<span class="ansi-yellow-intense-fg ansi-bold">(</span>fig<span class="ansi-yellow-intense-fg ansi-bold">,</span> <span class="ansi-blue-intense-fg ansi-bold">&#39;png&#39;</span><span class="ansi-yellow-intense-fg ansi-bold">,</span> <span class="ansi-yellow-intense-fg ansi-bold">**</span>kwargs<span class="ansi-yellow-intense-fg ansi-bold">)</span><span class="ansi-yellow-intense-fg ansi-bold">)</span>
<span class="ansi-green-fg">    249</span>     <span class="ansi-green-intense-fg ansi-bold">if</span> <span class="ansi-blue-intense-fg ansi-bold">&#39;retina&#39;</span> <span class="ansi-green-intense-fg ansi-bold">in</span> formats <span class="ansi-green-intense-fg ansi-bold">or</span> <span class="ansi-blue-intense-fg ansi-bold">&#39;png2x&#39;</span> <span class="ansi-green-intense-fg ansi-bold">in</span> formats<span class="ansi-yellow-intense-fg ansi-bold">:</span>
<span class="ansi-green-fg">    250</span>         png_formatter<span class="ansi-yellow-intense-fg ansi-bold">.</span>for_type<span class="ansi-yellow-intense-fg ansi-bold">(</span>Figure<span class="ansi-yellow-intense-fg ansi-bold">,</span> <span class="ansi-green-intense-fg ansi-bold">lambda</span> fig<span class="ansi-yellow-intense-fg ansi-bold">:</span> retina_figure<span class="ansi-yellow-intense-fg ansi-bold">(</span>fig<span class="ansi-yellow-intense-fg ansi-bold">,</span> <span class="ansi-yellow-intense-fg ansi-bold">**</span>kwargs<span class="ansi-yellow-intense-fg ansi-bold">)</span><span class="ansi-yellow-intense-fg ansi-bold">)</span>

<span class="ansi-green-intense-fg ansi-bold">c:\program files\python38\lib\site-packages\IPython\core\pylabtools.py</span> in <span class="ansi-cyan-fg">print_figure</span><span class="ansi-blue-intense-fg ansi-bold">(fig, fmt, bbox_inches, **kwargs)</span>
<span class="ansi-green-fg">    130</span>         FigureCanvasBase<span class="ansi-yellow-intense-fg ansi-bold">(</span>fig<span class="ansi-yellow-intense-fg ansi-bold">)</span>
<span class="ansi-green-fg">    131</span> 
<span class="ansi-green-intense-fg ansi-bold">--&gt; 132</span><span class="ansi-yellow-intense-fg ansi-bold">     </span>fig<span class="ansi-yellow-intense-fg ansi-bold">.</span>canvas<span class="ansi-yellow-intense-fg ansi-bold">.</span>print_figure<span class="ansi-yellow-intense-fg ansi-bold">(</span>bytes_io<span class="ansi-yellow-intense-fg ansi-bold">,</span> <span class="ansi-yellow-intense-fg ansi-bold">**</span>kw<span class="ansi-yellow-intense-fg ansi-bold">)</span>
<span class="ansi-green-fg">    133</span>     data <span class="ansi-yellow-intense-fg ansi-bold">=</span> bytes_io<span class="ansi-yellow-intense-fg ansi-bold">.</span>getvalue<span class="ansi-yellow-intense-fg ansi-bold">(</span><span class="ansi-yellow-intense-fg ansi-bold">)</span>
<span class="ansi-green-fg">    134</span>     <span class="ansi-green-intense-fg ansi-bold">if</span> fmt <span class="ansi-yellow-intense-fg ansi-bold">==</span> <span class="ansi-blue-intense-fg ansi-bold">&#39;svg&#39;</span><span class="ansi-yellow-intense-fg ansi-bold">:</span>

<span class="ansi-green-intense-fg ansi-bold">~\AppData\Roaming\Python\Python38\site-packages\matplotlib\backend_bases.py</span> in <span class="ansi-cyan-fg">print_figure</span><span class="ansi-blue-intense-fg ansi-bold">(self, filename, dpi, facecolor, edgecolor, orientation, format, bbox_inches, pad_inches, bbox_extra_artists, backend, **kwargs)</span>
<span class="ansi-green-fg">   2228</span>                        else suppress())
<span class="ansi-green-fg">   2229</span>                 <span class="ansi-green-intense-fg ansi-bold">with</span> ctx<span class="ansi-yellow-intense-fg ansi-bold">:</span>
<span class="ansi-green-intense-fg ansi-bold">-&gt; 2230</span><span class="ansi-yellow-intense-fg ansi-bold">                     </span>self<span class="ansi-yellow-intense-fg ansi-bold">.</span>figure<span class="ansi-yellow-intense-fg ansi-bold">.</span>draw<span class="ansi-yellow-intense-fg ansi-bold">(</span>renderer<span class="ansi-yellow-intense-fg ansi-bold">)</span>
<span class="ansi-green-fg">   2231</span> 
<span class="ansi-green-fg">   2232</span>             <span class="ansi-green-intense-fg ansi-bold">if</span> bbox_inches<span class="ansi-yellow-intense-fg ansi-bold">:</span>

<span class="ansi-green-intense-fg ansi-bold">~\AppData\Roaming\Python\Python38\site-packages\matplotlib\artist.py</span> in <span class="ansi-cyan-fg">draw_wrapper</span><span class="ansi-blue-intense-fg ansi-bold">(artist, renderer, *args, **kwargs)</span>
<span class="ansi-green-fg">     72</span>     <span class="ansi-yellow-intense-fg ansi-bold">@</span>wraps<span class="ansi-yellow-intense-fg ansi-bold">(</span>draw<span class="ansi-yellow-intense-fg ansi-bold">)</span>
<span class="ansi-green-fg">     73</span>     <span class="ansi-green-intense-fg ansi-bold">def</span> draw_wrapper<span class="ansi-yellow-intense-fg ansi-bold">(</span>artist<span class="ansi-yellow-intense-fg ansi-bold">,</span> renderer<span class="ansi-yellow-intense-fg ansi-bold">,</span> <span class="ansi-yellow-intense-fg ansi-bold">*</span>args<span class="ansi-yellow-intense-fg ansi-bold">,</span> <span class="ansi-yellow-intense-fg ansi-bold">**</span>kwargs<span class="ansi-yellow-intense-fg ansi-bold">)</span><span class="ansi-yellow-intense-fg ansi-bold">:</span>
<span class="ansi-green-intense-fg ansi-bold">---&gt; 74</span><span class="ansi-yellow-intense-fg ansi-bold">         </span>result <span class="ansi-yellow-intense-fg ansi-bold">=</span> draw<span class="ansi-yellow-intense-fg ansi-bold">(</span>artist<span class="ansi-yellow-intense-fg ansi-bold">,</span> renderer<span class="ansi-yellow-intense-fg ansi-bold">,</span> <span class="ansi-yellow-intense-fg ansi-bold">*</span>args<span class="ansi-yellow-intense-fg ansi-bold">,</span> <span class="ansi-yellow-intense-fg ansi-bold">**</span>kwargs<span class="ansi-yellow-intense-fg ansi-bold">)</span>
<span class="ansi-green-fg">     75</span>         <span class="ansi-green-intense-fg ansi-bold">if</span> renderer<span class="ansi-yellow-intense-fg ansi-bold">.</span>_rasterizing<span class="ansi-yellow-intense-fg ansi-bold">:</span>
<span class="ansi-green-fg">     76</span>             renderer<span class="ansi-yellow-intense-fg ansi-bold">.</span>stop_rasterizing<span class="ansi-yellow-intense-fg ansi-bold">(</span><span class="ansi-yellow-intense-fg ansi-bold">)</span>

<span class="ansi-green-intense-fg ansi-bold">~\AppData\Roaming\Python\Python38\site-packages\matplotlib\artist.py</span> in <span class="ansi-cyan-fg">draw_wrapper</span><span class="ansi-blue-intense-fg ansi-bold">(artist, renderer, *args, **kwargs)</span>
<span class="ansi-green-fg">     49</span>                 renderer<span class="ansi-yellow-intense-fg ansi-bold">.</span>start_filter<span class="ansi-yellow-intense-fg ansi-bold">(</span><span class="ansi-yellow-intense-fg ansi-bold">)</span>
<span class="ansi-green-fg">     50</span> 
<span class="ansi-green-intense-fg ansi-bold">---&gt; 51</span><span class="ansi-yellow-intense-fg ansi-bold">             </span><span class="ansi-green-intense-fg ansi-bold">return</span> draw<span class="ansi-yellow-intense-fg ansi-bold">(</span>artist<span class="ansi-yellow-intense-fg ansi-bold">,</span> renderer<span class="ansi-yellow-intense-fg ansi-bold">,</span> <span class="ansi-yellow-intense-fg ansi-bold">*</span>args<span class="ansi-yellow-intense-fg ansi-bold">,</span> <span class="ansi-yellow-intense-fg ansi-bold">**</span>kwargs<span class="ansi-yellow-intense-fg ansi-bold">)</span>
<span class="ansi-green-fg">     52</span>         <span class="ansi-green-intense-fg ansi-bold">finally</span><span class="ansi-yellow-intense-fg ansi-bold">:</span>
<span class="ansi-green-fg">     53</span>             <span class="ansi-green-intense-fg ansi-bold">if</span> artist<span class="ansi-yellow-intense-fg ansi-bold">.</span>get_agg_filter<span class="ansi-yellow-intense-fg ansi-bold">(</span><span class="ansi-yellow-intense-fg ansi-bold">)</span> <span class="ansi-green-intense-fg ansi-bold">is</span> <span class="ansi-green-intense-fg ansi-bold">not</span> <span class="ansi-green-intense-fg ansi-bold">None</span><span class="ansi-yellow-intense-fg ansi-bold">:</span>

<span class="ansi-green-intense-fg ansi-bold">~\AppData\Roaming\Python\Python38\site-packages\matplotlib\figure.py</span> in <span class="ansi-cyan-fg">draw</span><span class="ansi-blue-intense-fg ansi-bold">(self, renderer)</span>
<span class="ansi-green-fg">   2735</span> 
<span class="ansi-green-fg">   2736</span>             self<span class="ansi-yellow-intense-fg ansi-bold">.</span>patch<span class="ansi-yellow-intense-fg ansi-bold">.</span>draw<span class="ansi-yellow-intense-fg ansi-bold">(</span>renderer<span class="ansi-yellow-intense-fg ansi-bold">)</span>
<span class="ansi-green-intense-fg ansi-bold">-&gt; 2737</span><span class="ansi-yellow-intense-fg ansi-bold">             mimage._draw_list_compositing_images(
</span><span class="ansi-green-fg">   2738</span>                 renderer, self, artists, self.suppressComposite)
<span class="ansi-green-fg">   2739</span> 

<span class="ansi-green-intense-fg ansi-bold">~\AppData\Roaming\Python\Python38\site-packages\matplotlib\image.py</span> in <span class="ansi-cyan-fg">_draw_list_compositing_images</span><span class="ansi-blue-intense-fg ansi-bold">(renderer, parent, artists, suppress_composite)</span>
<span class="ansi-green-fg">    130</span>     <span class="ansi-green-intense-fg ansi-bold">if</span> not_composite <span class="ansi-green-intense-fg ansi-bold">or</span> <span class="ansi-green-intense-fg ansi-bold">not</span> has_images<span class="ansi-yellow-intense-fg ansi-bold">:</span>
<span class="ansi-green-fg">    131</span>         <span class="ansi-green-intense-fg ansi-bold">for</span> a <span class="ansi-green-intense-fg ansi-bold">in</span> artists<span class="ansi-yellow-intense-fg ansi-bold">:</span>
<span class="ansi-green-intense-fg ansi-bold">--&gt; 132</span><span class="ansi-yellow-intense-fg ansi-bold">             </span>a<span class="ansi-yellow-intense-fg ansi-bold">.</span>draw<span class="ansi-yellow-intense-fg ansi-bold">(</span>renderer<span class="ansi-yellow-intense-fg ansi-bold">)</span>
<span class="ansi-green-fg">    133</span>     <span class="ansi-green-intense-fg ansi-bold">else</span><span class="ansi-yellow-intense-fg ansi-bold">:</span>
<span class="ansi-green-fg">    134</span>         <span class="ansi-red-intense-fg ansi-bold"># Composite any adjacent images together</span>

<span class="ansi-green-intense-fg ansi-bold">~\AppData\Roaming\Python\Python38\site-packages\matplotlib\artist.py</span> in <span class="ansi-cyan-fg">draw_wrapper</span><span class="ansi-blue-intense-fg ansi-bold">(artist, renderer, *args, **kwargs)</span>
<span class="ansi-green-fg">     49</span>                 renderer<span class="ansi-yellow-intense-fg ansi-bold">.</span>start_filter<span class="ansi-yellow-intense-fg ansi-bold">(</span><span class="ansi-yellow-intense-fg ansi-bold">)</span>
<span class="ansi-green-fg">     50</span> 
<span class="ansi-green-intense-fg ansi-bold">---&gt; 51</span><span class="ansi-yellow-intense-fg ansi-bold">             </span><span class="ansi-green-intense-fg ansi-bold">return</span> draw<span class="ansi-yellow-intense-fg ansi-bold">(</span>artist<span class="ansi-yellow-intense-fg ansi-bold">,</span> renderer<span class="ansi-yellow-intense-fg ansi-bold">,</span> <span class="ansi-yellow-intense-fg ansi-bold">*</span>args<span class="ansi-yellow-intense-fg ansi-bold">,</span> <span class="ansi-yellow-intense-fg ansi-bold">**</span>kwargs<span class="ansi-yellow-intense-fg ansi-bold">)</span>
<span class="ansi-green-fg">     52</span>         <span class="ansi-green-intense-fg ansi-bold">finally</span><span class="ansi-yellow-intense-fg ansi-bold">:</span>
<span class="ansi-green-fg">     53</span>             <span class="ansi-green-intense-fg ansi-bold">if</span> artist<span class="ansi-yellow-intense-fg ansi-bold">.</span>get_agg_filter<span class="ansi-yellow-intense-fg ansi-bold">(</span><span class="ansi-yellow-intense-fg ansi-bold">)</span> <span class="ansi-green-intense-fg ansi-bold">is</span> <span class="ansi-green-intense-fg ansi-bold">not</span> <span class="ansi-green-intense-fg ansi-bold">None</span><span class="ansi-yellow-intense-fg ansi-bold">:</span>

<span class="ansi-green-intense-fg ansi-bold">~\AppData\Roaming\Python\Python38\site-packages\matplotlib\_api\deprecation.py</span> in <span class="ansi-cyan-fg">wrapper</span><span class="ansi-blue-intense-fg ansi-bold">(*inner_args, **inner_kwargs)</span>
<span class="ansi-green-fg">    429</span>                          <span class="ansi-green-intense-fg ansi-bold">else</span> deprecation_addendum<span class="ansi-yellow-intense-fg ansi-bold">,</span>
<span class="ansi-green-fg">    430</span>                 **kwargs)
<span class="ansi-green-intense-fg ansi-bold">--&gt; 431</span><span class="ansi-yellow-intense-fg ansi-bold">         </span><span class="ansi-green-intense-fg ansi-bold">return</span> func<span class="ansi-yellow-intense-fg ansi-bold">(</span><span class="ansi-yellow-intense-fg ansi-bold">*</span>inner_args<span class="ansi-yellow-intense-fg ansi-bold">,</span> <span class="ansi-yellow-intense-fg ansi-bold">**</span>inner_kwargs<span class="ansi-yellow-intense-fg ansi-bold">)</span>
<span class="ansi-green-fg">    432</span> 
<span class="ansi-green-fg">    433</span>     <span class="ansi-green-intense-fg ansi-bold">return</span> wrapper

<span class="ansi-green-intense-fg ansi-bold">~\AppData\Roaming\Python\Python38\site-packages\matplotlib\axes\_base.py</span> in <span class="ansi-cyan-fg">draw</span><span class="ansi-blue-intense-fg ansi-bold">(self, renderer, inframe)</span>
<span class="ansi-green-fg">   2923</span>             renderer<span class="ansi-yellow-intense-fg ansi-bold">.</span>stop_rasterizing<span class="ansi-yellow-intense-fg ansi-bold">(</span><span class="ansi-yellow-intense-fg ansi-bold">)</span>
<span class="ansi-green-fg">   2924</span> 
<span class="ansi-green-intense-fg ansi-bold">-&gt; 2925</span><span class="ansi-yellow-intense-fg ansi-bold">         </span>mimage<span class="ansi-yellow-intense-fg ansi-bold">.</span>_draw_list_compositing_images<span class="ansi-yellow-intense-fg ansi-bold">(</span>renderer<span class="ansi-yellow-intense-fg ansi-bold">,</span> self<span class="ansi-yellow-intense-fg ansi-bold">,</span> artists<span class="ansi-yellow-intense-fg ansi-bold">)</span>
<span class="ansi-green-fg">   2926</span> 
<span class="ansi-green-fg">   2927</span>         renderer<span class="ansi-yellow-intense-fg ansi-bold">.</span>close_group<span class="ansi-yellow-intense-fg ansi-bold">(</span><span class="ansi-blue-intense-fg ansi-bold">&#39;axes&#39;</span><span class="ansi-yellow-intense-fg ansi-bold">)</span>

<span class="ansi-green-intense-fg ansi-bold">~\AppData\Roaming\Python\Python38\site-packages\matplotlib\image.py</span> in <span class="ansi-cyan-fg">_draw_list_compositing_images</span><span class="ansi-blue-intense-fg ansi-bold">(renderer, parent, artists, suppress_composite)</span>
<span class="ansi-green-fg">    130</span>     <span class="ansi-green-intense-fg ansi-bold">if</span> not_composite <span class="ansi-green-intense-fg ansi-bold">or</span> <span class="ansi-green-intense-fg ansi-bold">not</span> has_images<span class="ansi-yellow-intense-fg ansi-bold">:</span>
<span class="ansi-green-fg">    131</span>         <span class="ansi-green-intense-fg ansi-bold">for</span> a <span class="ansi-green-intense-fg ansi-bold">in</span> artists<span class="ansi-yellow-intense-fg ansi-bold">:</span>
<span class="ansi-green-intense-fg ansi-bold">--&gt; 132</span><span class="ansi-yellow-intense-fg ansi-bold">             </span>a<span class="ansi-yellow-intense-fg ansi-bold">.</span>draw<span class="ansi-yellow-intense-fg ansi-bold">(</span>renderer<span class="ansi-yellow-intense-fg ansi-bold">)</span>
<span class="ansi-green-fg">    133</span>     <span class="ansi-green-intense-fg ansi-bold">else</span><span class="ansi-yellow-intense-fg ansi-bold">:</span>
<span class="ansi-green-fg">    134</span>         <span class="ansi-red-intense-fg ansi-bold"># Composite any adjacent images together</span>

<span class="ansi-green-intense-fg ansi-bold">~\AppData\Roaming\Python\Python38\site-packages\matplotlib\artist.py</span> in <span class="ansi-cyan-fg">draw_wrapper</span><span class="ansi-blue-intense-fg ansi-bold">(artist, renderer, *args, **kwargs)</span>
<span class="ansi-green-fg">     49</span>                 renderer<span class="ansi-yellow-intense-fg ansi-bold">.</span>start_filter<span class="ansi-yellow-intense-fg ansi-bold">(</span><span class="ansi-yellow-intense-fg ansi-bold">)</span>
<span class="ansi-green-fg">     50</span> 
<span class="ansi-green-intense-fg ansi-bold">---&gt; 51</span><span class="ansi-yellow-intense-fg ansi-bold">             </span><span class="ansi-green-intense-fg ansi-bold">return</span> draw<span class="ansi-yellow-intense-fg ansi-bold">(</span>artist<span class="ansi-yellow-intense-fg ansi-bold">,</span> renderer<span class="ansi-yellow-intense-fg ansi-bold">,</span> <span class="ansi-yellow-intense-fg ansi-bold">*</span>args<span class="ansi-yellow-intense-fg ansi-bold">,</span> <span class="ansi-yellow-intense-fg ansi-bold">**</span>kwargs<span class="ansi-yellow-intense-fg ansi-bold">)</span>
<span class="ansi-green-fg">     52</span>         <span class="ansi-green-intense-fg ansi-bold">finally</span><span class="ansi-yellow-intense-fg ansi-bold">:</span>
<span class="ansi-green-fg">     53</span>             <span class="ansi-green-intense-fg ansi-bold">if</span> artist<span class="ansi-yellow-intense-fg ansi-bold">.</span>get_agg_filter<span class="ansi-yellow-intense-fg ansi-bold">(</span><span class="ansi-yellow-intense-fg ansi-bold">)</span> <span class="ansi-green-intense-fg ansi-bold">is</span> <span class="ansi-green-intense-fg ansi-bold">not</span> <span class="ansi-green-intense-fg ansi-bold">None</span><span class="ansi-yellow-intense-fg ansi-bold">:</span>

<span class="ansi-green-intense-fg ansi-bold">~\AppData\Roaming\Python\Python38\site-packages\matplotlib\axis.py</span> in <span class="ansi-cyan-fg">draw</span><span class="ansi-blue-intense-fg ansi-bold">(self, renderer, *args, **kwargs)</span>
<span class="ansi-green-fg">   1129</span> 
<span class="ansi-green-fg">   1130</span>         ticks_to_draw <span class="ansi-yellow-intense-fg ansi-bold">=</span> self<span class="ansi-yellow-intense-fg ansi-bold">.</span>_update_ticks<span class="ansi-yellow-intense-fg ansi-bold">(</span><span class="ansi-yellow-intense-fg ansi-bold">)</span>
<span class="ansi-green-intense-fg ansi-bold">-&gt; 1131</span><span class="ansi-yellow-intense-fg ansi-bold">         ticklabelBoxes, ticklabelBoxes2 = self._get_tick_bboxes(ticks_to_draw,
</span><span class="ansi-green-fg">   1132</span>                                                                 renderer)
<span class="ansi-green-fg">   1133</span> 

<span class="ansi-green-intense-fg ansi-bold">~\AppData\Roaming\Python\Python38\site-packages\matplotlib\axis.py</span> in <span class="ansi-cyan-fg">_get_tick_bboxes</span><span class="ansi-blue-intense-fg ansi-bold">(self, ticks, renderer)</span>
<span class="ansi-green-fg">   1055</span>     <span class="ansi-green-intense-fg ansi-bold">def</span> _get_tick_bboxes<span class="ansi-yellow-intense-fg ansi-bold">(</span>self<span class="ansi-yellow-intense-fg ansi-bold">,</span> ticks<span class="ansi-yellow-intense-fg ansi-bold">,</span> renderer<span class="ansi-yellow-intense-fg ansi-bold">)</span><span class="ansi-yellow-intense-fg ansi-bold">:</span>
<span class="ansi-green-fg">   1056</span>         <span class="ansi-blue-intense-fg ansi-bold">&#34;&#34;&#34;Return lists of bboxes for ticks&#39; label1&#39;s and label2&#39;s.&#34;&#34;&#34;</span>
<span class="ansi-green-intense-fg ansi-bold">-&gt; 1057</span><span class="ansi-yellow-intense-fg ansi-bold">         return ([tick.label1.get_window_extent(renderer)
</span><span class="ansi-green-fg">   1058</span>                  for tick in ticks if tick.label1.get_visible()],
<span class="ansi-green-fg">   1059</span>                 [tick.label2.get_window_extent(renderer)

<span class="ansi-green-intense-fg ansi-bold">~\AppData\Roaming\Python\Python38\site-packages\matplotlib\axis.py</span> in <span class="ansi-cyan-fg">&lt;listcomp&gt;</span><span class="ansi-blue-intense-fg ansi-bold">(.0)</span>
<span class="ansi-green-fg">   1055</span>     <span class="ansi-green-intense-fg ansi-bold">def</span> _get_tick_bboxes<span class="ansi-yellow-intense-fg ansi-bold">(</span>self<span class="ansi-yellow-intense-fg ansi-bold">,</span> ticks<span class="ansi-yellow-intense-fg ansi-bold">,</span> renderer<span class="ansi-yellow-intense-fg ansi-bold">)</span><span class="ansi-yellow-intense-fg ansi-bold">:</span>
<span class="ansi-green-fg">   1056</span>         <span class="ansi-blue-intense-fg ansi-bold">&#34;&#34;&#34;Return lists of bboxes for ticks&#39; label1&#39;s and label2&#39;s.&#34;&#34;&#34;</span>
<span class="ansi-green-intense-fg ansi-bold">-&gt; 1057</span><span class="ansi-yellow-intense-fg ansi-bold">         return ([tick.label1.get_window_extent(renderer)
</span><span class="ansi-green-fg">   1058</span>                  for tick in ticks if tick.label1.get_visible()],
<span class="ansi-green-fg">   1059</span>                 [tick.label2.get_window_extent(renderer)

<span class="ansi-green-intense-fg ansi-bold">~\AppData\Roaming\Python\Python38\site-packages\matplotlib\text.py</span> in <span class="ansi-cyan-fg">get_window_extent</span><span class="ansi-blue-intense-fg ansi-bold">(self, renderer, dpi)</span>
<span class="ansi-green-fg">    901</span> 
<span class="ansi-green-fg">    902</span>         <span class="ansi-green-intense-fg ansi-bold">with</span> cbook<span class="ansi-yellow-intense-fg ansi-bold">.</span>_setattr_cm<span class="ansi-yellow-intense-fg ansi-bold">(</span>self<span class="ansi-yellow-intense-fg ansi-bold">.</span>figure<span class="ansi-yellow-intense-fg ansi-bold">,</span> dpi<span class="ansi-yellow-intense-fg ansi-bold">=</span>dpi<span class="ansi-yellow-intense-fg ansi-bold">)</span><span class="ansi-yellow-intense-fg ansi-bold">:</span>
<span class="ansi-green-intense-fg ansi-bold">--&gt; 903</span><span class="ansi-yellow-intense-fg ansi-bold">             </span>bbox<span class="ansi-yellow-intense-fg ansi-bold">,</span> info<span class="ansi-yellow-intense-fg ansi-bold">,</span> descent <span class="ansi-yellow-intense-fg ansi-bold">=</span> self<span class="ansi-yellow-intense-fg ansi-bold">.</span>_get_layout<span class="ansi-yellow-intense-fg ansi-bold">(</span>self<span class="ansi-yellow-intense-fg ansi-bold">.</span>_renderer<span class="ansi-yellow-intense-fg ansi-bold">)</span>
<span class="ansi-green-fg">    904</span>             x<span class="ansi-yellow-intense-fg ansi-bold">,</span> y <span class="ansi-yellow-intense-fg ansi-bold">=</span> self<span class="ansi-yellow-intense-fg ansi-bold">.</span>get_unitless_position<span class="ansi-yellow-intense-fg ansi-bold">(</span><span class="ansi-yellow-intense-fg ansi-bold">)</span>
<span class="ansi-green-fg">    905</span>             x<span class="ansi-yellow-intense-fg ansi-bold">,</span> y <span class="ansi-yellow-intense-fg ansi-bold">=</span> self<span class="ansi-yellow-intense-fg ansi-bold">.</span>get_transform<span class="ansi-yellow-intense-fg ansi-bold">(</span><span class="ansi-yellow-intense-fg ansi-bold">)</span><span class="ansi-yellow-intense-fg ansi-bold">.</span>transform<span class="ansi-yellow-intense-fg ansi-bold">(</span><span class="ansi-yellow-intense-fg ansi-bold">(</span>x<span class="ansi-yellow-intense-fg ansi-bold">,</span> y<span class="ansi-yellow-intense-fg ansi-bold">)</span><span class="ansi-yellow-intense-fg ansi-bold">)</span>

<span class="ansi-green-intense-fg ansi-bold">~\AppData\Roaming\Python\Python38\site-packages\matplotlib\text.py</span> in <span class="ansi-cyan-fg">_get_layout</span><span class="ansi-blue-intense-fg ansi-bold">(self, renderer)</span>
<span class="ansi-green-fg">    304</span> 
<span class="ansi-green-fg">    305</span>         <span class="ansi-red-intense-fg ansi-bold"># Full vertical extent of font, including ascenders and descenders:</span>
<span class="ansi-green-intense-fg ansi-bold">--&gt; 306</span><span class="ansi-yellow-intense-fg ansi-bold">         _, lp_h, lp_d = renderer.get_text_width_height_descent(
</span><span class="ansi-green-fg">    307</span>             <span class="ansi-blue-intense-fg ansi-bold">&#34;lp&#34;</span><span class="ansi-yellow-intense-fg ansi-bold">,</span> self<span class="ansi-yellow-intense-fg ansi-bold">.</span>_fontproperties<span class="ansi-yellow-intense-fg ansi-bold">,</span>
<span class="ansi-green-fg">    308</span>             ismath=&#34;TeX&#34; if self.get_usetex() else False)

<span class="ansi-green-intense-fg ansi-bold">~\AppData\Roaming\Python\Python38\site-packages\matplotlib\backends\backend_agg.py</span> in <span class="ansi-cyan-fg">get_text_width_height_descent</span><span class="ansi-blue-intense-fg ansi-bold">(self, s, prop, ismath)</span>
<span class="ansi-green-fg">    227</span>             texmanager <span class="ansi-yellow-intense-fg ansi-bold">=</span> self<span class="ansi-yellow-intense-fg ansi-bold">.</span>get_texmanager<span class="ansi-yellow-intense-fg ansi-bold">(</span><span class="ansi-yellow-intense-fg ansi-bold">)</span>
<span class="ansi-green-fg">    228</span>             fontsize <span class="ansi-yellow-intense-fg ansi-bold">=</span> prop<span class="ansi-yellow-intense-fg ansi-bold">.</span>get_size_in_points<span class="ansi-yellow-intense-fg ansi-bold">(</span><span class="ansi-yellow-intense-fg ansi-bold">)</span>
<span class="ansi-green-intense-fg ansi-bold">--&gt; 229</span><span class="ansi-yellow-intense-fg ansi-bold">             w, h, d = texmanager.get_text_width_height_descent(
</span><span class="ansi-green-fg">    230</span>                 s, fontsize, renderer=self)
<span class="ansi-green-fg">    231</span>             <span class="ansi-green-intense-fg ansi-bold">return</span> w<span class="ansi-yellow-intense-fg ansi-bold">,</span> h<span class="ansi-yellow-intense-fg ansi-bold">,</span> d

<span class="ansi-green-intense-fg ansi-bold">~\AppData\Roaming\Python\Python38\site-packages\matplotlib\texmanager.py</span> in <span class="ansi-cyan-fg">get_text_width_height_descent</span><span class="ansi-blue-intense-fg ansi-bold">(self, tex, fontsize, renderer)</span>
<span class="ansi-green-fg">    397</span>         <span class="ansi-green-intense-fg ansi-bold">else</span><span class="ansi-yellow-intense-fg ansi-bold">:</span>
<span class="ansi-green-fg">    398</span>             <span class="ansi-red-intense-fg ansi-bold"># use dviread.</span>
<span class="ansi-green-intense-fg ansi-bold">--&gt; 399</span><span class="ansi-yellow-intense-fg ansi-bold">             </span>dvifile <span class="ansi-yellow-intense-fg ansi-bold">=</span> self<span class="ansi-yellow-intense-fg ansi-bold">.</span>make_dvi<span class="ansi-yellow-intense-fg ansi-bold">(</span>tex<span class="ansi-yellow-intense-fg ansi-bold">,</span> fontsize<span class="ansi-yellow-intense-fg ansi-bold">)</span>
<span class="ansi-green-fg">    400</span>             <span class="ansi-green-intense-fg ansi-bold">with</span> dviread<span class="ansi-yellow-intense-fg ansi-bold">.</span>Dvi<span class="ansi-yellow-intense-fg ansi-bold">(</span>dvifile<span class="ansi-yellow-intense-fg ansi-bold">,</span> <span class="ansi-cyan-intense-fg ansi-bold">72</span> <span class="ansi-yellow-intense-fg ansi-bold">*</span> dpi_fraction<span class="ansi-yellow-intense-fg ansi-bold">)</span> <span class="ansi-green-intense-fg ansi-bold">as</span> dvi<span class="ansi-yellow-intense-fg ansi-bold">:</span>
<span class="ansi-green-fg">    401</span>                 page<span class="ansi-yellow-intense-fg ansi-bold">,</span> <span class="ansi-yellow-intense-fg ansi-bold">=</span> dvi

<span class="ansi-green-intense-fg ansi-bold">~\AppData\Roaming\Python\Python38\site-packages\matplotlib\texmanager.py</span> in <span class="ansi-cyan-fg">make_dvi</span><span class="ansi-blue-intense-fg ansi-bold">(self, tex, fontsize)</span>
<span class="ansi-green-fg">    289</span>             <span class="ansi-red-intense-fg ansi-bold"># and thus replace() works atomically.</span>
<span class="ansi-green-fg">    290</span>             <span class="ansi-green-intense-fg ansi-bold">with</span> TemporaryDirectory<span class="ansi-yellow-intense-fg ansi-bold">(</span>dir<span class="ansi-yellow-intense-fg ansi-bold">=</span>Path<span class="ansi-yellow-intense-fg ansi-bold">(</span>dvifile<span class="ansi-yellow-intense-fg ansi-bold">)</span><span class="ansi-yellow-intense-fg ansi-bold">.</span>parent<span class="ansi-yellow-intense-fg ansi-bold">)</span> <span class="ansi-green-intense-fg ansi-bold">as</span> tmpdir<span class="ansi-yellow-intense-fg ansi-bold">:</span>
<span class="ansi-green-intense-fg ansi-bold">--&gt; 291</span><span class="ansi-yellow-intense-fg ansi-bold">                 self._run_checked_subprocess(
</span><span class="ansi-green-fg">    292</span>                     [&#34;latex&#34;, &#34;-interaction=nonstopmode&#34;, &#34;--halt-on-error&#34;,
<span class="ansi-green-fg">    293</span>                      texfile], tex, cwd=tmpdir)

<span class="ansi-green-intense-fg ansi-bold">~\AppData\Roaming\Python\Python38\site-packages\matplotlib\texmanager.py</span> in <span class="ansi-cyan-fg">_run_checked_subprocess</span><span class="ansi-blue-intense-fg ansi-bold">(self, command, tex, cwd)</span>
<span class="ansi-green-fg">    258</span>                 &#39;found&#39;.format(command[0])) from exc
<span class="ansi-green-fg">    259</span>         <span class="ansi-green-intense-fg ansi-bold">except</span> subprocess<span class="ansi-yellow-intense-fg ansi-bold">.</span>CalledProcessError <span class="ansi-green-intense-fg ansi-bold">as</span> exc<span class="ansi-yellow-intense-fg ansi-bold">:</span>
<span class="ansi-green-intense-fg ansi-bold">--&gt; 260</span><span class="ansi-yellow-intense-fg ansi-bold">             raise RuntimeError(
</span><span class="ansi-green-fg">    261</span>                 <span class="ansi-blue-intense-fg ansi-bold">&#39;{prog} was not able to process the following string:\n&#39;</span>
<span class="ansi-green-fg">    262</span>                 <span class="ansi-blue-intense-fg ansi-bold">&#39;{tex!r}\n\n&#39;</span>

<span class="ansi-red-intense-fg ansi-bold">RuntimeError</span>: latex was not able to process the following string:
b&#39;lp&#39;

Here is the full report generated by latex:
This is pdfTeX, Version 3.141592653-2.6-1.40.22 (MiKTeX 21.3)
entering extended mode
(C:/Users/janko/.matplotlib/tex.cache/1acea6f6c115d0ec7a634ed0529287b9.tex
LaTeX2e &lt;2020-10-01&gt; patch level 4
L3 programming layer &lt;2021-02-18&gt;
(C:\Users\janko\AppData\Local\Programs\MiKTeX\tex/latex/base\article.cls
Document Class: article 2020/04/10 v1.4m Standard LaTeX document class
(C:\Users\janko\AppData\Local\Programs\MiKTeX\tex/latex/base\size10.clo))
(C:\Users\janko\AppData\Local\Programs\MiKTeX\tex/latex/type1cm\type1cm.sty)
======================================================================
starting package maintenance...
installation directory: C:\Users\janko\AppData\Local\Programs\MiKTeX
package repository: https://ftp.fau.de/ctan/systems/win32/miktex/tm/packages/

Unfortunately, the package cm-super could not be installed.
Please check the log file:
C:\Users\janko\AppData\Local\MiKTeX\miktex\log\latex.log
======================================================================


! LaTeX Error: File `type1ec.sty&#39; not found.

Type X to quit or &lt;RETURN&gt; to proceed,
or enter new name. (Default extension: sty)

Enter file name: 
! Emergency stop.
&lt;read *&gt; 
         
l.6 \usepackage
               {type1ec}
No pages of output.
Transcript written on 1acea6f6c115d0ec7a634ed0529287b9.log.


</pre>
</div>
</div>

<div class="output_area">

    <div class="prompt"></div>




<div class="output_text output_subarea ">
<pre>&lt;Figure size 432x288 with 1 Axes&gt;</pre>
</div>

</div>

</div>
</div>

</div>
<div class="cell border-box-sizing text_cell rendered"><div class="prompt input_prompt">
</div><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h3 id="Napaka-trapeznega-pravila">Napaka trapeznega pravila<a class="anchor-link" href="#Napaka-trapeznega-pravila">&#182;</a></h3>
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="prompt input_prompt">
</div><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>Razlika med analitično vrednostjo integrala in numeričnim približkom $I$ je napaka metode:</p>
$$E = \int_a^bf(x)\,d x-I,$$
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="prompt input_prompt">
</div><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>Če je funkcija $f(x)$ vsaj dvakrat odvedljiva, se lahko (glejte npr. vir: Burden, Faires, Burden: Numerical Analysis 10th Ed) izpelje ocena napake, ki velja samo za trapezni približek prek celega integracijskega intervala:
$$E_{\textrm{trapezno}}=-\frac{h^3}{12}f''(\xi),$$
kjer je $h=b-a$ in $\xi$ neznana vrednost na intervalu $[a,b]$.</p>

</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="prompt input_prompt">
</div><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h2 id="Sestavljeno-trapezno-pravilo">Sestavljeno trapezno pravilo<a class="anchor-link" href="#Sestavljeno-trapezno-pravilo">&#182;</a></h2>
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="prompt input_prompt">
</div><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>Če razdelimo interval $[a, b]$ na $n$ podintervalov in na vsakem uporabimo trapezno pravilo integriranja,  govorimo o <em>sestavljenem trapeznem pravilu</em> (angl. <em>composite trapezoidal rule</em>).</p>

</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="prompt input_prompt">
</div><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>V tem primeru za vsak podinterval $i$ uporabimo trapezno pravilo in torej za meje podinterval $x_i$ in $x_{i+1}$ uporabimo uteži $A_i=A_{i+i}=h/2$. Ker so notranja vozlišča podvojena, sledi:
$$A_0=A_{n}=\frac{h}{2}\quad\textrm{in za ostala vozlišča:}\quad A_i=h.$$
Pri tem smo predpostavili podintervale enake širine:
$$h=\frac{x_{n}-x_0}{n}$$</p>

</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="prompt input_prompt">
</div><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>Sledi torej:
$$I_{\textrm{trapezno sest}}=\sum_{i=0}^{n}A_i\,f(x_i)=\left(\frac{y_0}{2} + y_1+y_2+\cdots+y_{n-1}+\frac{y_{n}}{2}\right)\,h.$$</p>

</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="prompt input_prompt">
</div><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h3 id="Numeri&#269;na-implementacija">Numeri&#269;na implementacija<a class="anchor-link" href="#Numeri&#269;na-implementacija">&#182;</a></h3>
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="prompt input_prompt">
</div><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>Numerična implementacija je:</p>

</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In&nbsp;[10]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="k">def</span> <span class="nf">trapezno_sest</span><span class="p">(</span><span class="n">y</span><span class="p">,</span> <span class="n">h</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Sestavljeno trapezno pravilo integriranja.</span>
<span class="sd">    </span>
<span class="sd">    :param y: funkcijske vrednosti</span>
<span class="sd">    :param h: korak integriranja</span>
<span class="sd">    &quot;&quot;&quot;</span>    
    <span class="k">return</span> <span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">sum</span><span class="p">(</span><span class="n">y</span><span class="p">)</span> <span class="o">-</span> <span class="mf">0.5</span><span class="o">*</span><span class="n">y</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">-</span> <span class="mf">0.5</span><span class="o">*</span><span class="n">y</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">])</span><span class="o">*</span><span class="n">h</span>
</pre></div>

    </div>
</div>
</div>

</div>
<div class="cell border-box-sizing text_cell rendered"><div class="prompt input_prompt">
</div><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h3 id="Numeri&#269;ni-zgled">Numeri&#269;ni zgled<a class="anchor-link" href="#Numeri&#269;ni-zgled">&#182;</a></h3><p>Zgoraj smo že pripravili podatke za dva podintervala (tri vozlišča):</p>

</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In&nbsp;[11]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">x3v</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">


<div class="output_area">

    <div class="prompt output_prompt">Out[11]:</div>




<div class="output_text output_subarea output_execute_result">
<pre>array([1. , 1.5, 2. ])</pre>
</div>

</div>

</div>
</div>

</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In&nbsp;[12]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">h3v</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">


<div class="output_area">

    <div class="prompt output_prompt">Out[12]:</div>




<div class="output_latex output_subarea output_execute_result">
$\displaystyle 0.5$
</div>

</div>

</div>
</div>

</div>
<div class="cell border-box-sizing text_cell rendered"><div class="prompt input_prompt">
</div><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>Izračunajmo oceno integrala s sestavljenim trapeznim pravilom:</p>

</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In&nbsp;[13]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">I_trapezno_sest</span> <span class="o">=</span> <span class="n">trapezno_sest</span><span class="p">(</span><span class="n">y3v</span><span class="p">,</span> <span class="n">h</span><span class="o">=</span><span class="n">h3v</span><span class="p">)</span>
<span class="n">I_trapezno_sest</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">


<div class="output_area">

    <div class="prompt output_prompt">Out[13]:</div>




<div class="output_latex output_subarea output_execute_result">
$\displaystyle 1.41313769956786$
</div>

</div>

</div>
</div>

</div>
<div class="cell border-box-sizing text_cell rendered"><div class="prompt input_prompt">
</div><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>Pripravimo sliko:</p>

</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In&nbsp;[14]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="k">def</span> <span class="nf">fig_trapezno_sest</span><span class="p">():</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">fill_between</span><span class="p">(</span><span class="n">x3v</span><span class="p">,</span> <span class="n">y3v</span><span class="p">,</span> <span class="n">alpha</span><span class="o">=</span><span class="mf">0.25</span><span class="p">,</span> <span class="n">facecolor</span><span class="o">=</span><span class="s1">&#39;r&#39;</span><span class="p">)</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">vlines</span><span class="p">(</span><span class="n">x3v</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="n">y3v</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;r&#39;</span><span class="p">,</span> <span class="n">linestyles</span><span class="o">=</span><span class="s1">&#39;dashed&#39;</span><span class="p">,</span> <span class="n">lw</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">annotate</span><span class="p">(</span><span class="s1">&#39;$I_{</span><span class="se">\\</span><span class="s1">textrm{trapezno sestavljeno}}$&#39;</span><span class="p">,</span> <span class="p">(</span><span class="mf">1.2</span><span class="p">,</span> <span class="mf">0.5</span><span class="p">),</span> <span class="n">fontsize</span><span class="o">=</span><span class="mi">22</span><span class="p">)</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">annotate</span><span class="p">(</span><span class="s1">&#39;Napaka&#39;</span><span class="p">,</span> <span class="n">fontsize</span><span class="o">=</span><span class="mi">20</span><span class="p">,</span> <span class="n">xy</span><span class="o">=</span><span class="p">(</span><span class="mf">1.75</span><span class="p">,</span> <span class="mf">1.68</span><span class="p">),</span> <span class="n">xytext</span><span class="o">=</span><span class="p">(</span><span class="mf">1.4</span><span class="p">,</span> <span class="mf">1.8</span><span class="p">),</span>
            <span class="n">arrowprops</span><span class="o">=</span><span class="nb">dict</span><span class="p">(</span><span class="n">facecolor</span><span class="o">=</span><span class="s1">&#39;gray&#39;</span><span class="p">,</span> <span class="n">shrink</span><span class="o">=</span><span class="mf">0.05</span><span class="p">))</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">annotate</span><span class="p">(</span><span class="s1">&#39;Napaka&#39;</span><span class="p">,</span> <span class="n">fontsize</span><span class="o">=</span><span class="mi">20</span><span class="p">,</span> <span class="n">xy</span><span class="o">=</span><span class="p">(</span><span class="mf">1.2</span><span class="p">,</span> <span class="mf">1.1</span><span class="p">),</span> <span class="n">xytext</span><span class="o">=</span><span class="p">(</span><span class="mf">1.</span><span class="p">,</span> <span class="mf">1.4</span><span class="p">),</span>
            <span class="n">arrowprops</span><span class="o">=</span><span class="nb">dict</span><span class="p">(</span><span class="n">facecolor</span><span class="o">=</span><span class="s1">&#39;gray&#39;</span><span class="p">,</span> <span class="n">shrink</span><span class="o">=</span><span class="mf">0.05</span><span class="p">))</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">xg</span><span class="p">,</span> <span class="n">yg</span><span class="p">,</span> <span class="n">lw</span><span class="o">=</span><span class="mi">3</span><span class="p">,</span> <span class="n">alpha</span><span class="o">=</span><span class="mf">0.5</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s1">&#39;$x\,\sin(x)$&#39;</span><span class="p">)</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">x3v</span><span class="p">,</span> <span class="n">y3v</span><span class="p">,</span> <span class="s1">&#39;o&#39;</span><span class="p">,</span> <span class="n">alpha</span><span class="o">=</span><span class="mf">0.5</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="sa">f</span><span class="s1">&#39;$h=</span><span class="si">{</span><span class="n">h3v</span><span class="si">}</span><span class="s1">$&#39;</span><span class="p">)</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">legend</span><span class="p">(</span><span class="n">loc</span><span class="o">=</span><span class="p">(</span><span class="mf">1.01</span><span class="p">,</span> <span class="mi">0</span><span class="p">))</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">ylim</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">2</span><span class="p">)</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>

    </div>
</div>
</div>

</div>
<div class="cell border-box-sizing text_cell rendered"><div class="prompt input_prompt">
</div><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>Prikažemo:</p>

</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In&nbsp;[15]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">fig_trapezno_sest</span><span class="p">()</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">


<div class="output_area">

    <div class="prompt"></div>


<div class="output_subarea output_text output_error">
<pre>
<span class="ansi-red-intense-fg ansi-bold">---------------------------------------------------------------------------</span>
<span class="ansi-red-intense-fg ansi-bold">CalledProcessError</span>                        Traceback (most recent call last)
<span class="ansi-green-intense-fg ansi-bold">~\AppData\Roaming\Python\Python38\site-packages\matplotlib\texmanager.py</span> in <span class="ansi-cyan-fg">_run_checked_subprocess</span><span class="ansi-blue-intense-fg ansi-bold">(self, command, tex, cwd)</span>
<span class="ansi-green-fg">    251</span>         <span class="ansi-green-intense-fg ansi-bold">try</span><span class="ansi-yellow-intense-fg ansi-bold">:</span>
<span class="ansi-green-intense-fg ansi-bold">--&gt; 252</span><span class="ansi-yellow-intense-fg ansi-bold">             report = subprocess.check_output(
</span><span class="ansi-green-fg">    253</span>                 command<span class="ansi-yellow-intense-fg ansi-bold">,</span> cwd<span class="ansi-yellow-intense-fg ansi-bold">=</span>cwd <span class="ansi-green-intense-fg ansi-bold">if</span> cwd <span class="ansi-green-intense-fg ansi-bold">is</span> <span class="ansi-green-intense-fg ansi-bold">not</span> <span class="ansi-green-intense-fg ansi-bold">None</span> <span class="ansi-green-intense-fg ansi-bold">else</span> self<span class="ansi-yellow-intense-fg ansi-bold">.</span>texcache<span class="ansi-yellow-intense-fg ansi-bold">,</span>

<span class="ansi-green-intense-fg ansi-bold">c:\program files\python38\lib\subprocess.py</span> in <span class="ansi-cyan-fg">check_output</span><span class="ansi-blue-intense-fg ansi-bold">(timeout, *popenargs, **kwargs)</span>
<span class="ansi-green-fg">    414</span> 
<span class="ansi-green-intense-fg ansi-bold">--&gt; 415</span><span class="ansi-yellow-intense-fg ansi-bold">     return run(*popenargs, stdout=PIPE, timeout=timeout, check=True,
</span><span class="ansi-green-fg">    416</span>                **kwargs).stdout

<span class="ansi-green-intense-fg ansi-bold">c:\program files\python38\lib\subprocess.py</span> in <span class="ansi-cyan-fg">run</span><span class="ansi-blue-intense-fg ansi-bold">(input, capture_output, timeout, check, *popenargs, **kwargs)</span>
<span class="ansi-green-fg">    515</span>         <span class="ansi-green-intense-fg ansi-bold">if</span> check <span class="ansi-green-intense-fg ansi-bold">and</span> retcode<span class="ansi-yellow-intense-fg ansi-bold">:</span>
<span class="ansi-green-intense-fg ansi-bold">--&gt; 516</span><span class="ansi-yellow-intense-fg ansi-bold">             raise CalledProcessError(retcode, process.args,
</span><span class="ansi-green-fg">    517</span>                                      output=stdout, stderr=stderr)

<span class="ansi-red-intense-fg ansi-bold">CalledProcessError</span>: Command &#39;[&#39;latex&#39;, &#39;-interaction=nonstopmode&#39;, &#39;--halt-on-error&#39;, &#39;C:\\Users\\janko\\.matplotlib\\tex.cache\\1acea6f6c115d0ec7a634ed0529287b9.tex&#39;]&#39; returned non-zero exit status 1.

The above exception was the direct cause of the following exception:

<span class="ansi-red-intense-fg ansi-bold">RuntimeError</span>                              Traceback (most recent call last)
<span class="ansi-green-intense-fg ansi-bold">c:\program files\python38\lib\site-packages\IPython\core\formatters.py</span> in <span class="ansi-cyan-fg">__call__</span><span class="ansi-blue-intense-fg ansi-bold">(self, obj)</span>
<span class="ansi-green-fg">    339</span>                 <span class="ansi-green-intense-fg ansi-bold">pass</span>
<span class="ansi-green-fg">    340</span>             <span class="ansi-green-intense-fg ansi-bold">else</span><span class="ansi-yellow-intense-fg ansi-bold">:</span>
<span class="ansi-green-intense-fg ansi-bold">--&gt; 341</span><span class="ansi-yellow-intense-fg ansi-bold">                 </span><span class="ansi-green-intense-fg ansi-bold">return</span> printer<span class="ansi-yellow-intense-fg ansi-bold">(</span>obj<span class="ansi-yellow-intense-fg ansi-bold">)</span>
<span class="ansi-green-fg">    342</span>             <span class="ansi-red-intense-fg ansi-bold"># Finally look for special method names</span>
<span class="ansi-green-fg">    343</span>             method <span class="ansi-yellow-intense-fg ansi-bold">=</span> get_real_method<span class="ansi-yellow-intense-fg ansi-bold">(</span>obj<span class="ansi-yellow-intense-fg ansi-bold">,</span> self<span class="ansi-yellow-intense-fg ansi-bold">.</span>print_method<span class="ansi-yellow-intense-fg ansi-bold">)</span>

<span class="ansi-green-intense-fg ansi-bold">c:\program files\python38\lib\site-packages\IPython\core\pylabtools.py</span> in <span class="ansi-cyan-fg">&lt;lambda&gt;</span><span class="ansi-blue-intense-fg ansi-bold">(fig)</span>
<span class="ansi-green-fg">    246</span> 
<span class="ansi-green-fg">    247</span>     <span class="ansi-green-intense-fg ansi-bold">if</span> <span class="ansi-blue-intense-fg ansi-bold">&#39;png&#39;</span> <span class="ansi-green-intense-fg ansi-bold">in</span> formats<span class="ansi-yellow-intense-fg ansi-bold">:</span>
<span class="ansi-green-intense-fg ansi-bold">--&gt; 248</span><span class="ansi-yellow-intense-fg ansi-bold">         </span>png_formatter<span class="ansi-yellow-intense-fg ansi-bold">.</span>for_type<span class="ansi-yellow-intense-fg ansi-bold">(</span>Figure<span class="ansi-yellow-intense-fg ansi-bold">,</span> <span class="ansi-green-intense-fg ansi-bold">lambda</span> fig<span class="ansi-yellow-intense-fg ansi-bold">:</span> print_figure<span class="ansi-yellow-intense-fg ansi-bold">(</span>fig<span class="ansi-yellow-intense-fg ansi-bold">,</span> <span class="ansi-blue-intense-fg ansi-bold">&#39;png&#39;</span><span class="ansi-yellow-intense-fg ansi-bold">,</span> <span class="ansi-yellow-intense-fg ansi-bold">**</span>kwargs<span class="ansi-yellow-intense-fg ansi-bold">)</span><span class="ansi-yellow-intense-fg ansi-bold">)</span>
<span class="ansi-green-fg">    249</span>     <span class="ansi-green-intense-fg ansi-bold">if</span> <span class="ansi-blue-intense-fg ansi-bold">&#39;retina&#39;</span> <span class="ansi-green-intense-fg ansi-bold">in</span> formats <span class="ansi-green-intense-fg ansi-bold">or</span> <span class="ansi-blue-intense-fg ansi-bold">&#39;png2x&#39;</span> <span class="ansi-green-intense-fg ansi-bold">in</span> formats<span class="ansi-yellow-intense-fg ansi-bold">:</span>
<span class="ansi-green-fg">    250</span>         png_formatter<span class="ansi-yellow-intense-fg ansi-bold">.</span>for_type<span class="ansi-yellow-intense-fg ansi-bold">(</span>Figure<span class="ansi-yellow-intense-fg ansi-bold">,</span> <span class="ansi-green-intense-fg ansi-bold">lambda</span> fig<span class="ansi-yellow-intense-fg ansi-bold">:</span> retina_figure<span class="ansi-yellow-intense-fg ansi-bold">(</span>fig<span class="ansi-yellow-intense-fg ansi-bold">,</span> <span class="ansi-yellow-intense-fg ansi-bold">**</span>kwargs<span class="ansi-yellow-intense-fg ansi-bold">)</span><span class="ansi-yellow-intense-fg ansi-bold">)</span>

<span class="ansi-green-intense-fg ansi-bold">c:\program files\python38\lib\site-packages\IPython\core\pylabtools.py</span> in <span class="ansi-cyan-fg">print_figure</span><span class="ansi-blue-intense-fg ansi-bold">(fig, fmt, bbox_inches, **kwargs)</span>
<span class="ansi-green-fg">    130</span>         FigureCanvasBase<span class="ansi-yellow-intense-fg ansi-bold">(</span>fig<span class="ansi-yellow-intense-fg ansi-bold">)</span>
<span class="ansi-green-fg">    131</span> 
<span class="ansi-green-intense-fg ansi-bold">--&gt; 132</span><span class="ansi-yellow-intense-fg ansi-bold">     </span>fig<span class="ansi-yellow-intense-fg ansi-bold">.</span>canvas<span class="ansi-yellow-intense-fg ansi-bold">.</span>print_figure<span class="ansi-yellow-intense-fg ansi-bold">(</span>bytes_io<span class="ansi-yellow-intense-fg ansi-bold">,</span> <span class="ansi-yellow-intense-fg ansi-bold">**</span>kw<span class="ansi-yellow-intense-fg ansi-bold">)</span>
<span class="ansi-green-fg">    133</span>     data <span class="ansi-yellow-intense-fg ansi-bold">=</span> bytes_io<span class="ansi-yellow-intense-fg ansi-bold">.</span>getvalue<span class="ansi-yellow-intense-fg ansi-bold">(</span><span class="ansi-yellow-intense-fg ansi-bold">)</span>
<span class="ansi-green-fg">    134</span>     <span class="ansi-green-intense-fg ansi-bold">if</span> fmt <span class="ansi-yellow-intense-fg ansi-bold">==</span> <span class="ansi-blue-intense-fg ansi-bold">&#39;svg&#39;</span><span class="ansi-yellow-intense-fg ansi-bold">:</span>

<span class="ansi-green-intense-fg ansi-bold">~\AppData\Roaming\Python\Python38\site-packages\matplotlib\backend_bases.py</span> in <span class="ansi-cyan-fg">print_figure</span><span class="ansi-blue-intense-fg ansi-bold">(self, filename, dpi, facecolor, edgecolor, orientation, format, bbox_inches, pad_inches, bbox_extra_artists, backend, **kwargs)</span>
<span class="ansi-green-fg">   2228</span>                        else suppress())
<span class="ansi-green-fg">   2229</span>                 <span class="ansi-green-intense-fg ansi-bold">with</span> ctx<span class="ansi-yellow-intense-fg ansi-bold">:</span>
<span class="ansi-green-intense-fg ansi-bold">-&gt; 2230</span><span class="ansi-yellow-intense-fg ansi-bold">                     </span>self<span class="ansi-yellow-intense-fg ansi-bold">.</span>figure<span class="ansi-yellow-intense-fg ansi-bold">.</span>draw<span class="ansi-yellow-intense-fg ansi-bold">(</span>renderer<span class="ansi-yellow-intense-fg ansi-bold">)</span>
<span class="ansi-green-fg">   2231</span> 
<span class="ansi-green-fg">   2232</span>             <span class="ansi-green-intense-fg ansi-bold">if</span> bbox_inches<span class="ansi-yellow-intense-fg ansi-bold">:</span>

<span class="ansi-green-intense-fg ansi-bold">~\AppData\Roaming\Python\Python38\site-packages\matplotlib\artist.py</span> in <span class="ansi-cyan-fg">draw_wrapper</span><span class="ansi-blue-intense-fg ansi-bold">(artist, renderer, *args, **kwargs)</span>
<span class="ansi-green-fg">     72</span>     <span class="ansi-yellow-intense-fg ansi-bold">@</span>wraps<span class="ansi-yellow-intense-fg ansi-bold">(</span>draw<span class="ansi-yellow-intense-fg ansi-bold">)</span>
<span class="ansi-green-fg">     73</span>     <span class="ansi-green-intense-fg ansi-bold">def</span> draw_wrapper<span class="ansi-yellow-intense-fg ansi-bold">(</span>artist<span class="ansi-yellow-intense-fg ansi-bold">,</span> renderer<span class="ansi-yellow-intense-fg ansi-bold">,</span> <span class="ansi-yellow-intense-fg ansi-bold">*</span>args<span class="ansi-yellow-intense-fg ansi-bold">,</span> <span class="ansi-yellow-intense-fg ansi-bold">**</span>kwargs<span class="ansi-yellow-intense-fg ansi-bold">)</span><span class="ansi-yellow-intense-fg ansi-bold">:</span>
<span class="ansi-green-intense-fg ansi-bold">---&gt; 74</span><span class="ansi-yellow-intense-fg ansi-bold">         </span>result <span class="ansi-yellow-intense-fg ansi-bold">=</span> draw<span class="ansi-yellow-intense-fg ansi-bold">(</span>artist<span class="ansi-yellow-intense-fg ansi-bold">,</span> renderer<span class="ansi-yellow-intense-fg ansi-bold">,</span> <span class="ansi-yellow-intense-fg ansi-bold">*</span>args<span class="ansi-yellow-intense-fg ansi-bold">,</span> <span class="ansi-yellow-intense-fg ansi-bold">**</span>kwargs<span class="ansi-yellow-intense-fg ansi-bold">)</span>
<span class="ansi-green-fg">     75</span>         <span class="ansi-green-intense-fg ansi-bold">if</span> renderer<span class="ansi-yellow-intense-fg ansi-bold">.</span>_rasterizing<span class="ansi-yellow-intense-fg ansi-bold">:</span>
<span class="ansi-green-fg">     76</span>             renderer<span class="ansi-yellow-intense-fg ansi-bold">.</span>stop_rasterizing<span class="ansi-yellow-intense-fg ansi-bold">(</span><span class="ansi-yellow-intense-fg ansi-bold">)</span>

<span class="ansi-green-intense-fg ansi-bold">~\AppData\Roaming\Python\Python38\site-packages\matplotlib\artist.py</span> in <span class="ansi-cyan-fg">draw_wrapper</span><span class="ansi-blue-intense-fg ansi-bold">(artist, renderer, *args, **kwargs)</span>
<span class="ansi-green-fg">     49</span>                 renderer<span class="ansi-yellow-intense-fg ansi-bold">.</span>start_filter<span class="ansi-yellow-intense-fg ansi-bold">(</span><span class="ansi-yellow-intense-fg ansi-bold">)</span>
<span class="ansi-green-fg">     50</span> 
<span class="ansi-green-intense-fg ansi-bold">---&gt; 51</span><span class="ansi-yellow-intense-fg ansi-bold">             </span><span class="ansi-green-intense-fg ansi-bold">return</span> draw<span class="ansi-yellow-intense-fg ansi-bold">(</span>artist<span class="ansi-yellow-intense-fg ansi-bold">,</span> renderer<span class="ansi-yellow-intense-fg ansi-bold">,</span> <span class="ansi-yellow-intense-fg ansi-bold">*</span>args<span class="ansi-yellow-intense-fg ansi-bold">,</span> <span class="ansi-yellow-intense-fg ansi-bold">**</span>kwargs<span class="ansi-yellow-intense-fg ansi-bold">)</span>
<span class="ansi-green-fg">     52</span>         <span class="ansi-green-intense-fg ansi-bold">finally</span><span class="ansi-yellow-intense-fg ansi-bold">:</span>
<span class="ansi-green-fg">     53</span>             <span class="ansi-green-intense-fg ansi-bold">if</span> artist<span class="ansi-yellow-intense-fg ansi-bold">.</span>get_agg_filter<span class="ansi-yellow-intense-fg ansi-bold">(</span><span class="ansi-yellow-intense-fg ansi-bold">)</span> <span class="ansi-green-intense-fg ansi-bold">is</span> <span class="ansi-green-intense-fg ansi-bold">not</span> <span class="ansi-green-intense-fg ansi-bold">None</span><span class="ansi-yellow-intense-fg ansi-bold">:</span>

<span class="ansi-green-intense-fg ansi-bold">~\AppData\Roaming\Python\Python38\site-packages\matplotlib\figure.py</span> in <span class="ansi-cyan-fg">draw</span><span class="ansi-blue-intense-fg ansi-bold">(self, renderer)</span>
<span class="ansi-green-fg">   2735</span> 
<span class="ansi-green-fg">   2736</span>             self<span class="ansi-yellow-intense-fg ansi-bold">.</span>patch<span class="ansi-yellow-intense-fg ansi-bold">.</span>draw<span class="ansi-yellow-intense-fg ansi-bold">(</span>renderer<span class="ansi-yellow-intense-fg ansi-bold">)</span>
<span class="ansi-green-intense-fg ansi-bold">-&gt; 2737</span><span class="ansi-yellow-intense-fg ansi-bold">             mimage._draw_list_compositing_images(
</span><span class="ansi-green-fg">   2738</span>                 renderer, self, artists, self.suppressComposite)
<span class="ansi-green-fg">   2739</span> 

<span class="ansi-green-intense-fg ansi-bold">~\AppData\Roaming\Python\Python38\site-packages\matplotlib\image.py</span> in <span class="ansi-cyan-fg">_draw_list_compositing_images</span><span class="ansi-blue-intense-fg ansi-bold">(renderer, parent, artists, suppress_composite)</span>
<span class="ansi-green-fg">    130</span>     <span class="ansi-green-intense-fg ansi-bold">if</span> not_composite <span class="ansi-green-intense-fg ansi-bold">or</span> <span class="ansi-green-intense-fg ansi-bold">not</span> has_images<span class="ansi-yellow-intense-fg ansi-bold">:</span>
<span class="ansi-green-fg">    131</span>         <span class="ansi-green-intense-fg ansi-bold">for</span> a <span class="ansi-green-intense-fg ansi-bold">in</span> artists<span class="ansi-yellow-intense-fg ansi-bold">:</span>
<span class="ansi-green-intense-fg ansi-bold">--&gt; 132</span><span class="ansi-yellow-intense-fg ansi-bold">             </span>a<span class="ansi-yellow-intense-fg ansi-bold">.</span>draw<span class="ansi-yellow-intense-fg ansi-bold">(</span>renderer<span class="ansi-yellow-intense-fg ansi-bold">)</span>
<span class="ansi-green-fg">    133</span>     <span class="ansi-green-intense-fg ansi-bold">else</span><span class="ansi-yellow-intense-fg ansi-bold">:</span>
<span class="ansi-green-fg">    134</span>         <span class="ansi-red-intense-fg ansi-bold"># Composite any adjacent images together</span>

<span class="ansi-green-intense-fg ansi-bold">~\AppData\Roaming\Python\Python38\site-packages\matplotlib\artist.py</span> in <span class="ansi-cyan-fg">draw_wrapper</span><span class="ansi-blue-intense-fg ansi-bold">(artist, renderer, *args, **kwargs)</span>
<span class="ansi-green-fg">     49</span>                 renderer<span class="ansi-yellow-intense-fg ansi-bold">.</span>start_filter<span class="ansi-yellow-intense-fg ansi-bold">(</span><span class="ansi-yellow-intense-fg ansi-bold">)</span>
<span class="ansi-green-fg">     50</span> 
<span class="ansi-green-intense-fg ansi-bold">---&gt; 51</span><span class="ansi-yellow-intense-fg ansi-bold">             </span><span class="ansi-green-intense-fg ansi-bold">return</span> draw<span class="ansi-yellow-intense-fg ansi-bold">(</span>artist<span class="ansi-yellow-intense-fg ansi-bold">,</span> renderer<span class="ansi-yellow-intense-fg ansi-bold">,</span> <span class="ansi-yellow-intense-fg ansi-bold">*</span>args<span class="ansi-yellow-intense-fg ansi-bold">,</span> <span class="ansi-yellow-intense-fg ansi-bold">**</span>kwargs<span class="ansi-yellow-intense-fg ansi-bold">)</span>
<span class="ansi-green-fg">     52</span>         <span class="ansi-green-intense-fg ansi-bold">finally</span><span class="ansi-yellow-intense-fg ansi-bold">:</span>
<span class="ansi-green-fg">     53</span>             <span class="ansi-green-intense-fg ansi-bold">if</span> artist<span class="ansi-yellow-intense-fg ansi-bold">.</span>get_agg_filter<span class="ansi-yellow-intense-fg ansi-bold">(</span><span class="ansi-yellow-intense-fg ansi-bold">)</span> <span class="ansi-green-intense-fg ansi-bold">is</span> <span class="ansi-green-intense-fg ansi-bold">not</span> <span class="ansi-green-intense-fg ansi-bold">None</span><span class="ansi-yellow-intense-fg ansi-bold">:</span>

<span class="ansi-green-intense-fg ansi-bold">~\AppData\Roaming\Python\Python38\site-packages\matplotlib\_api\deprecation.py</span> in <span class="ansi-cyan-fg">wrapper</span><span class="ansi-blue-intense-fg ansi-bold">(*inner_args, **inner_kwargs)</span>
<span class="ansi-green-fg">    429</span>                          <span class="ansi-green-intense-fg ansi-bold">else</span> deprecation_addendum<span class="ansi-yellow-intense-fg ansi-bold">,</span>
<span class="ansi-green-fg">    430</span>                 **kwargs)
<span class="ansi-green-intense-fg ansi-bold">--&gt; 431</span><span class="ansi-yellow-intense-fg ansi-bold">         </span><span class="ansi-green-intense-fg ansi-bold">return</span> func<span class="ansi-yellow-intense-fg ansi-bold">(</span><span class="ansi-yellow-intense-fg ansi-bold">*</span>inner_args<span class="ansi-yellow-intense-fg ansi-bold">,</span> <span class="ansi-yellow-intense-fg ansi-bold">**</span>inner_kwargs<span class="ansi-yellow-intense-fg ansi-bold">)</span>
<span class="ansi-green-fg">    432</span> 
<span class="ansi-green-fg">    433</span>     <span class="ansi-green-intense-fg ansi-bold">return</span> wrapper

<span class="ansi-green-intense-fg ansi-bold">~\AppData\Roaming\Python\Python38\site-packages\matplotlib\axes\_base.py</span> in <span class="ansi-cyan-fg">draw</span><span class="ansi-blue-intense-fg ansi-bold">(self, renderer, inframe)</span>
<span class="ansi-green-fg">   2923</span>             renderer<span class="ansi-yellow-intense-fg ansi-bold">.</span>stop_rasterizing<span class="ansi-yellow-intense-fg ansi-bold">(</span><span class="ansi-yellow-intense-fg ansi-bold">)</span>
<span class="ansi-green-fg">   2924</span> 
<span class="ansi-green-intense-fg ansi-bold">-&gt; 2925</span><span class="ansi-yellow-intense-fg ansi-bold">         </span>mimage<span class="ansi-yellow-intense-fg ansi-bold">.</span>_draw_list_compositing_images<span class="ansi-yellow-intense-fg ansi-bold">(</span>renderer<span class="ansi-yellow-intense-fg ansi-bold">,</span> self<span class="ansi-yellow-intense-fg ansi-bold">,</span> artists<span class="ansi-yellow-intense-fg ansi-bold">)</span>
<span class="ansi-green-fg">   2926</span> 
<span class="ansi-green-fg">   2927</span>         renderer<span class="ansi-yellow-intense-fg ansi-bold">.</span>close_group<span class="ansi-yellow-intense-fg ansi-bold">(</span><span class="ansi-blue-intense-fg ansi-bold">&#39;axes&#39;</span><span class="ansi-yellow-intense-fg ansi-bold">)</span>

<span class="ansi-green-intense-fg ansi-bold">~\AppData\Roaming\Python\Python38\site-packages\matplotlib\image.py</span> in <span class="ansi-cyan-fg">_draw_list_compositing_images</span><span class="ansi-blue-intense-fg ansi-bold">(renderer, parent, artists, suppress_composite)</span>
<span class="ansi-green-fg">    130</span>     <span class="ansi-green-intense-fg ansi-bold">if</span> not_composite <span class="ansi-green-intense-fg ansi-bold">or</span> <span class="ansi-green-intense-fg ansi-bold">not</span> has_images<span class="ansi-yellow-intense-fg ansi-bold">:</span>
<span class="ansi-green-fg">    131</span>         <span class="ansi-green-intense-fg ansi-bold">for</span> a <span class="ansi-green-intense-fg ansi-bold">in</span> artists<span class="ansi-yellow-intense-fg ansi-bold">:</span>
<span class="ansi-green-intense-fg ansi-bold">--&gt; 132</span><span class="ansi-yellow-intense-fg ansi-bold">             </span>a<span class="ansi-yellow-intense-fg ansi-bold">.</span>draw<span class="ansi-yellow-intense-fg ansi-bold">(</span>renderer<span class="ansi-yellow-intense-fg ansi-bold">)</span>
<span class="ansi-green-fg">    133</span>     <span class="ansi-green-intense-fg ansi-bold">else</span><span class="ansi-yellow-intense-fg ansi-bold">:</span>
<span class="ansi-green-fg">    134</span>         <span class="ansi-red-intense-fg ansi-bold"># Composite any adjacent images together</span>

<span class="ansi-green-intense-fg ansi-bold">~\AppData\Roaming\Python\Python38\site-packages\matplotlib\artist.py</span> in <span class="ansi-cyan-fg">draw_wrapper</span><span class="ansi-blue-intense-fg ansi-bold">(artist, renderer, *args, **kwargs)</span>
<span class="ansi-green-fg">     49</span>                 renderer<span class="ansi-yellow-intense-fg ansi-bold">.</span>start_filter<span class="ansi-yellow-intense-fg ansi-bold">(</span><span class="ansi-yellow-intense-fg ansi-bold">)</span>
<span class="ansi-green-fg">     50</span> 
<span class="ansi-green-intense-fg ansi-bold">---&gt; 51</span><span class="ansi-yellow-intense-fg ansi-bold">             </span><span class="ansi-green-intense-fg ansi-bold">return</span> draw<span class="ansi-yellow-intense-fg ansi-bold">(</span>artist<span class="ansi-yellow-intense-fg ansi-bold">,</span> renderer<span class="ansi-yellow-intense-fg ansi-bold">,</span> <span class="ansi-yellow-intense-fg ansi-bold">*</span>args<span class="ansi-yellow-intense-fg ansi-bold">,</span> <span class="ansi-yellow-intense-fg ansi-bold">**</span>kwargs<span class="ansi-yellow-intense-fg ansi-bold">)</span>
<span class="ansi-green-fg">     52</span>         <span class="ansi-green-intense-fg ansi-bold">finally</span><span class="ansi-yellow-intense-fg ansi-bold">:</span>
<span class="ansi-green-fg">     53</span>             <span class="ansi-green-intense-fg ansi-bold">if</span> artist<span class="ansi-yellow-intense-fg ansi-bold">.</span>get_agg_filter<span class="ansi-yellow-intense-fg ansi-bold">(</span><span class="ansi-yellow-intense-fg ansi-bold">)</span> <span class="ansi-green-intense-fg ansi-bold">is</span> <span class="ansi-green-intense-fg ansi-bold">not</span> <span class="ansi-green-intense-fg ansi-bold">None</span><span class="ansi-yellow-intense-fg ansi-bold">:</span>

<span class="ansi-green-intense-fg ansi-bold">~\AppData\Roaming\Python\Python38\site-packages\matplotlib\axis.py</span> in <span class="ansi-cyan-fg">draw</span><span class="ansi-blue-intense-fg ansi-bold">(self, renderer, *args, **kwargs)</span>
<span class="ansi-green-fg">   1129</span> 
<span class="ansi-green-fg">   1130</span>         ticks_to_draw <span class="ansi-yellow-intense-fg ansi-bold">=</span> self<span class="ansi-yellow-intense-fg ansi-bold">.</span>_update_ticks<span class="ansi-yellow-intense-fg ansi-bold">(</span><span class="ansi-yellow-intense-fg ansi-bold">)</span>
<span class="ansi-green-intense-fg ansi-bold">-&gt; 1131</span><span class="ansi-yellow-intense-fg ansi-bold">         ticklabelBoxes, ticklabelBoxes2 = self._get_tick_bboxes(ticks_to_draw,
</span><span class="ansi-green-fg">   1132</span>                                                                 renderer)
<span class="ansi-green-fg">   1133</span> 

<span class="ansi-green-intense-fg ansi-bold">~\AppData\Roaming\Python\Python38\site-packages\matplotlib\axis.py</span> in <span class="ansi-cyan-fg">_get_tick_bboxes</span><span class="ansi-blue-intense-fg ansi-bold">(self, ticks, renderer)</span>
<span class="ansi-green-fg">   1055</span>     <span class="ansi-green-intense-fg ansi-bold">def</span> _get_tick_bboxes<span class="ansi-yellow-intense-fg ansi-bold">(</span>self<span class="ansi-yellow-intense-fg ansi-bold">,</span> ticks<span class="ansi-yellow-intense-fg ansi-bold">,</span> renderer<span class="ansi-yellow-intense-fg ansi-bold">)</span><span class="ansi-yellow-intense-fg ansi-bold">:</span>
<span class="ansi-green-fg">   1056</span>         <span class="ansi-blue-intense-fg ansi-bold">&#34;&#34;&#34;Return lists of bboxes for ticks&#39; label1&#39;s and label2&#39;s.&#34;&#34;&#34;</span>
<span class="ansi-green-intense-fg ansi-bold">-&gt; 1057</span><span class="ansi-yellow-intense-fg ansi-bold">         return ([tick.label1.get_window_extent(renderer)
</span><span class="ansi-green-fg">   1058</span>                  for tick in ticks if tick.label1.get_visible()],
<span class="ansi-green-fg">   1059</span>                 [tick.label2.get_window_extent(renderer)

<span class="ansi-green-intense-fg ansi-bold">~\AppData\Roaming\Python\Python38\site-packages\matplotlib\axis.py</span> in <span class="ansi-cyan-fg">&lt;listcomp&gt;</span><span class="ansi-blue-intense-fg ansi-bold">(.0)</span>
<span class="ansi-green-fg">   1055</span>     <span class="ansi-green-intense-fg ansi-bold">def</span> _get_tick_bboxes<span class="ansi-yellow-intense-fg ansi-bold">(</span>self<span class="ansi-yellow-intense-fg ansi-bold">,</span> ticks<span class="ansi-yellow-intense-fg ansi-bold">,</span> renderer<span class="ansi-yellow-intense-fg ansi-bold">)</span><span class="ansi-yellow-intense-fg ansi-bold">:</span>
<span class="ansi-green-fg">   1056</span>         <span class="ansi-blue-intense-fg ansi-bold">&#34;&#34;&#34;Return lists of bboxes for ticks&#39; label1&#39;s and label2&#39;s.&#34;&#34;&#34;</span>
<span class="ansi-green-intense-fg ansi-bold">-&gt; 1057</span><span class="ansi-yellow-intense-fg ansi-bold">         return ([tick.label1.get_window_extent(renderer)
</span><span class="ansi-green-fg">   1058</span>                  for tick in ticks if tick.label1.get_visible()],
<span class="ansi-green-fg">   1059</span>                 [tick.label2.get_window_extent(renderer)

<span class="ansi-green-intense-fg ansi-bold">~\AppData\Roaming\Python\Python38\site-packages\matplotlib\text.py</span> in <span class="ansi-cyan-fg">get_window_extent</span><span class="ansi-blue-intense-fg ansi-bold">(self, renderer, dpi)</span>
<span class="ansi-green-fg">    901</span> 
<span class="ansi-green-fg">    902</span>         <span class="ansi-green-intense-fg ansi-bold">with</span> cbook<span class="ansi-yellow-intense-fg ansi-bold">.</span>_setattr_cm<span class="ansi-yellow-intense-fg ansi-bold">(</span>self<span class="ansi-yellow-intense-fg ansi-bold">.</span>figure<span class="ansi-yellow-intense-fg ansi-bold">,</span> dpi<span class="ansi-yellow-intense-fg ansi-bold">=</span>dpi<span class="ansi-yellow-intense-fg ansi-bold">)</span><span class="ansi-yellow-intense-fg ansi-bold">:</span>
<span class="ansi-green-intense-fg ansi-bold">--&gt; 903</span><span class="ansi-yellow-intense-fg ansi-bold">             </span>bbox<span class="ansi-yellow-intense-fg ansi-bold">,</span> info<span class="ansi-yellow-intense-fg ansi-bold">,</span> descent <span class="ansi-yellow-intense-fg ansi-bold">=</span> self<span class="ansi-yellow-intense-fg ansi-bold">.</span>_get_layout<span class="ansi-yellow-intense-fg ansi-bold">(</span>self<span class="ansi-yellow-intense-fg ansi-bold">.</span>_renderer<span class="ansi-yellow-intense-fg ansi-bold">)</span>
<span class="ansi-green-fg">    904</span>             x<span class="ansi-yellow-intense-fg ansi-bold">,</span> y <span class="ansi-yellow-intense-fg ansi-bold">=</span> self<span class="ansi-yellow-intense-fg ansi-bold">.</span>get_unitless_position<span class="ansi-yellow-intense-fg ansi-bold">(</span><span class="ansi-yellow-intense-fg ansi-bold">)</span>
<span class="ansi-green-fg">    905</span>             x<span class="ansi-yellow-intense-fg ansi-bold">,</span> y <span class="ansi-yellow-intense-fg ansi-bold">=</span> self<span class="ansi-yellow-intense-fg ansi-bold">.</span>get_transform<span class="ansi-yellow-intense-fg ansi-bold">(</span><span class="ansi-yellow-intense-fg ansi-bold">)</span><span class="ansi-yellow-intense-fg ansi-bold">.</span>transform<span class="ansi-yellow-intense-fg ansi-bold">(</span><span class="ansi-yellow-intense-fg ansi-bold">(</span>x<span class="ansi-yellow-intense-fg ansi-bold">,</span> y<span class="ansi-yellow-intense-fg ansi-bold">)</span><span class="ansi-yellow-intense-fg ansi-bold">)</span>

<span class="ansi-green-intense-fg ansi-bold">~\AppData\Roaming\Python\Python38\site-packages\matplotlib\text.py</span> in <span class="ansi-cyan-fg">_get_layout</span><span class="ansi-blue-intense-fg ansi-bold">(self, renderer)</span>
<span class="ansi-green-fg">    304</span> 
<span class="ansi-green-fg">    305</span>         <span class="ansi-red-intense-fg ansi-bold"># Full vertical extent of font, including ascenders and descenders:</span>
<span class="ansi-green-intense-fg ansi-bold">--&gt; 306</span><span class="ansi-yellow-intense-fg ansi-bold">         _, lp_h, lp_d = renderer.get_text_width_height_descent(
</span><span class="ansi-green-fg">    307</span>             <span class="ansi-blue-intense-fg ansi-bold">&#34;lp&#34;</span><span class="ansi-yellow-intense-fg ansi-bold">,</span> self<span class="ansi-yellow-intense-fg ansi-bold">.</span>_fontproperties<span class="ansi-yellow-intense-fg ansi-bold">,</span>
<span class="ansi-green-fg">    308</span>             ismath=&#34;TeX&#34; if self.get_usetex() else False)

<span class="ansi-green-intense-fg ansi-bold">~\AppData\Roaming\Python\Python38\site-packages\matplotlib\backends\backend_agg.py</span> in <span class="ansi-cyan-fg">get_text_width_height_descent</span><span class="ansi-blue-intense-fg ansi-bold">(self, s, prop, ismath)</span>
<span class="ansi-green-fg">    227</span>             texmanager <span class="ansi-yellow-intense-fg ansi-bold">=</span> self<span class="ansi-yellow-intense-fg ansi-bold">.</span>get_texmanager<span class="ansi-yellow-intense-fg ansi-bold">(</span><span class="ansi-yellow-intense-fg ansi-bold">)</span>
<span class="ansi-green-fg">    228</span>             fontsize <span class="ansi-yellow-intense-fg ansi-bold">=</span> prop<span class="ansi-yellow-intense-fg ansi-bold">.</span>get_size_in_points<span class="ansi-yellow-intense-fg ansi-bold">(</span><span class="ansi-yellow-intense-fg ansi-bold">)</span>
<span class="ansi-green-intense-fg ansi-bold">--&gt; 229</span><span class="ansi-yellow-intense-fg ansi-bold">             w, h, d = texmanager.get_text_width_height_descent(
</span><span class="ansi-green-fg">    230</span>                 s, fontsize, renderer=self)
<span class="ansi-green-fg">    231</span>             <span class="ansi-green-intense-fg ansi-bold">return</span> w<span class="ansi-yellow-intense-fg ansi-bold">,</span> h<span class="ansi-yellow-intense-fg ansi-bold">,</span> d

<span class="ansi-green-intense-fg ansi-bold">~\AppData\Roaming\Python\Python38\site-packages\matplotlib\texmanager.py</span> in <span class="ansi-cyan-fg">get_text_width_height_descent</span><span class="ansi-blue-intense-fg ansi-bold">(self, tex, fontsize, renderer)</span>
<span class="ansi-green-fg">    397</span>         <span class="ansi-green-intense-fg ansi-bold">else</span><span class="ansi-yellow-intense-fg ansi-bold">:</span>
<span class="ansi-green-fg">    398</span>             <span class="ansi-red-intense-fg ansi-bold"># use dviread.</span>
<span class="ansi-green-intense-fg ansi-bold">--&gt; 399</span><span class="ansi-yellow-intense-fg ansi-bold">             </span>dvifile <span class="ansi-yellow-intense-fg ansi-bold">=</span> self<span class="ansi-yellow-intense-fg ansi-bold">.</span>make_dvi<span class="ansi-yellow-intense-fg ansi-bold">(</span>tex<span class="ansi-yellow-intense-fg ansi-bold">,</span> fontsize<span class="ansi-yellow-intense-fg ansi-bold">)</span>
<span class="ansi-green-fg">    400</span>             <span class="ansi-green-intense-fg ansi-bold">with</span> dviread<span class="ansi-yellow-intense-fg ansi-bold">.</span>Dvi<span class="ansi-yellow-intense-fg ansi-bold">(</span>dvifile<span class="ansi-yellow-intense-fg ansi-bold">,</span> <span class="ansi-cyan-intense-fg ansi-bold">72</span> <span class="ansi-yellow-intense-fg ansi-bold">*</span> dpi_fraction<span class="ansi-yellow-intense-fg ansi-bold">)</span> <span class="ansi-green-intense-fg ansi-bold">as</span> dvi<span class="ansi-yellow-intense-fg ansi-bold">:</span>
<span class="ansi-green-fg">    401</span>                 page<span class="ansi-yellow-intense-fg ansi-bold">,</span> <span class="ansi-yellow-intense-fg ansi-bold">=</span> dvi

<span class="ansi-green-intense-fg ansi-bold">~\AppData\Roaming\Python\Python38\site-packages\matplotlib\texmanager.py</span> in <span class="ansi-cyan-fg">make_dvi</span><span class="ansi-blue-intense-fg ansi-bold">(self, tex, fontsize)</span>
<span class="ansi-green-fg">    289</span>             <span class="ansi-red-intense-fg ansi-bold"># and thus replace() works atomically.</span>
<span class="ansi-green-fg">    290</span>             <span class="ansi-green-intense-fg ansi-bold">with</span> TemporaryDirectory<span class="ansi-yellow-intense-fg ansi-bold">(</span>dir<span class="ansi-yellow-intense-fg ansi-bold">=</span>Path<span class="ansi-yellow-intense-fg ansi-bold">(</span>dvifile<span class="ansi-yellow-intense-fg ansi-bold">)</span><span class="ansi-yellow-intense-fg ansi-bold">.</span>parent<span class="ansi-yellow-intense-fg ansi-bold">)</span> <span class="ansi-green-intense-fg ansi-bold">as</span> tmpdir<span class="ansi-yellow-intense-fg ansi-bold">:</span>
<span class="ansi-green-intense-fg ansi-bold">--&gt; 291</span><span class="ansi-yellow-intense-fg ansi-bold">                 self._run_checked_subprocess(
</span><span class="ansi-green-fg">    292</span>                     [&#34;latex&#34;, &#34;-interaction=nonstopmode&#34;, &#34;--halt-on-error&#34;,
<span class="ansi-green-fg">    293</span>                      texfile], tex, cwd=tmpdir)

<span class="ansi-green-intense-fg ansi-bold">~\AppData\Roaming\Python\Python38\site-packages\matplotlib\texmanager.py</span> in <span class="ansi-cyan-fg">_run_checked_subprocess</span><span class="ansi-blue-intense-fg ansi-bold">(self, command, tex, cwd)</span>
<span class="ansi-green-fg">    258</span>                 &#39;found&#39;.format(command[0])) from exc
<span class="ansi-green-fg">    259</span>         <span class="ansi-green-intense-fg ansi-bold">except</span> subprocess<span class="ansi-yellow-intense-fg ansi-bold">.</span>CalledProcessError <span class="ansi-green-intense-fg ansi-bold">as</span> exc<span class="ansi-yellow-intense-fg ansi-bold">:</span>
<span class="ansi-green-intense-fg ansi-bold">--&gt; 260</span><span class="ansi-yellow-intense-fg ansi-bold">             raise RuntimeError(
</span><span class="ansi-green-fg">    261</span>                 <span class="ansi-blue-intense-fg ansi-bold">&#39;{prog} was not able to process the following string:\n&#39;</span>
<span class="ansi-green-fg">    262</span>                 <span class="ansi-blue-intense-fg ansi-bold">&#39;{tex!r}\n\n&#39;</span>

<span class="ansi-red-intense-fg ansi-bold">RuntimeError</span>: latex was not able to process the following string:
b&#39;lp&#39;

Here is the full report generated by latex:
This is pdfTeX, Version 3.141592653-2.6-1.40.22 (MiKTeX 21.3)
entering extended mode
(C:/Users/janko/.matplotlib/tex.cache/1acea6f6c115d0ec7a634ed0529287b9.tex
LaTeX2e &lt;2020-10-01&gt; patch level 4
L3 programming layer &lt;2021-02-18&gt;
(C:\Users\janko\AppData\Local\Programs\MiKTeX\tex/latex/base\article.cls
Document Class: article 2020/04/10 v1.4m Standard LaTeX document class
(C:\Users\janko\AppData\Local\Programs\MiKTeX\tex/latex/base\size10.clo))
(C:\Users\janko\AppData\Local\Programs\MiKTeX\tex/latex/type1cm\type1cm.sty)
======================================================================
starting package maintenance...
installation directory: C:\Users\janko\AppData\Local\Programs\MiKTeX
package repository: https://ftp.fau.de/ctan/systems/win32/miktex/tm/packages/

Unfortunately, the package cm-super could not be installed.
Please check the log file:
C:\Users\janko\AppData\Local\MiKTeX\miktex\log\latex.log
======================================================================


! LaTeX Error: File `type1ec.sty&#39; not found.

Type X to quit or &lt;RETURN&gt; to proceed,
or enter new name. (Default extension: sty)

Enter file name: 
! Emergency stop.
&lt;read *&gt; 
         
l.6 \usepackage
               {type1ec}
No pages of output.
Transcript written on 1acea6f6c115d0ec7a634ed0529287b9.log.


</pre>
</div>
</div>

<div class="output_area">

    <div class="prompt"></div>




<div class="output_text output_subarea ">
<pre>&lt;Figure size 432x288 with 1 Axes&gt;</pre>
</div>

</div>

</div>
</div>

</div>
<div class="cell border-box-sizing text_cell rendered"><div class="prompt input_prompt">
</div><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h3 id="Napaka-sestavljenega-trapeznega-pravila">Napaka sestavljenega trapeznega pravila<a class="anchor-link" href="#Napaka-sestavljenega-trapeznega-pravila">&#182;</a></h3>
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="prompt input_prompt">
</div><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>Napaka sestavljenega trapeznega pravila izhaja iz napake trapeznega pravila; pri tem tako napako naredimo $n$-krat.</p>

</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="prompt input_prompt">
</div><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>Ker velja $h\cdot n=b-a$, izpeljemo napako sestavljenega trapeznega pravila kot:</p>
$$E_{\textrm{trapezno sest}}=-\frac{h^2(b-a)}{12}f''(\eta),$$<p>$\eta$ je vrednost na intervalu $[a,b]$. Napaka je drugega reda $\mathcal{O}(h^2)$.</p>

</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="prompt input_prompt">
</div><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h3 id="Bolj&#353;i-pribli&#382;ek-integrala">Bolj&#353;i pribli&#382;ek integrala<a class="anchor-link" href="#Bolj&#353;i-pribli&#382;ek-integrala">&#182;</a></h3><p>V nadaljevanju si bomo pogledali t. i. <strong>Richardsonovo ekstrapolacijo</strong>, pri kateri na podlagi ocene integrala s korakom $h$ in $2h$ izračunamo boljši približek.</p>

</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="prompt input_prompt">
</div><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>V kolikor integral $I$ numerično izračunamo pri dveh različnih korakih $h$ in $2\,h$, velja:</p>
$$\int_a^b f(x)\,\textrm{d}x = I_h + E_h = I_{2h} + E_{2h},$$<p>kjer sta $I_h$ in $I_{2h}$ približka integrala s korakom $h$ in $2h$ ter $E_h$ in $E_{2h}$ oceni napake pri koraku $h$ in $2h$. Izpeljemo $I_{2h}-I_{h} = E_{h}-E_{2h}$</p>

</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="prompt input_prompt">
</div><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>Naprej zapišemo:</p>
$$E_h=-\frac{h^2(b-a)}{12}f''(\eta)=h^2\,K.$$<p>Ob predpostavki, da je $f''\left (\eta \right )$ pri koraku $h$ in $2h$ enak ($\eta$ je pri koraku $h$ in $2h$ dejansko različen), zapišemo:
$$E_{2h}=-\frac{(2h)^2(b-a)}{12}f''(\eta)=4\,h^2\,K$$</p>

</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="prompt input_prompt">
</div><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>Sledi:</p>
$$I_{2h}-I_h=-3K\,h^2.$$<p>Sedaj lahko ocenimo napako pri koraku $h$:</p>
$$E_h=h^2\,K=\frac{I_h-I_{2h}}{3}.$$
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="prompt input_prompt">
</div><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>Na podlagi ocene napake lahko izračunamo boljši numerični približek  $I_{h}^*$:
$$I_h^* = I_h + \frac{1}{3}\,(I_{h}-I_{2h})$$
ali
$$I_h^* = \frac{4}{3}\,I_h - \frac{1}{3}\,I_{2h}$$</p>

</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="prompt input_prompt">
</div><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h3 id="Numeri&#269;ni-zgled">Numeri&#269;ni zgled<a class="anchor-link" href="#Numeri&#269;ni-zgled">&#182;</a></h3>
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="prompt input_prompt">
</div><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>Predhodno smo s trapeznim pravilom že izračunali integral pri koraku $h=1$ in pri koraku $h=0,5$, rezultata sta bila:</p>

</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In&nbsp;[16]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="p">[</span><span class="n">I_trapezno</span><span class="p">,</span> <span class="n">I_trapezno_sest</span><span class="p">]</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">


<div class="output_area">

    <div class="prompt output_prompt">Out[16]:</div>




<div class="output_latex output_subarea output_execute_result">
$\displaystyle \left[ 1.33003291922963, \  1.41313769956786\right]$
</div>

</div>

</div>
</div>

</div>
<div class="cell border-box-sizing text_cell rendered"><div class="prompt input_prompt">
</div><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>S pomočjo zgornje formule izračunamo boljši približek:</p>

</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In&nbsp;[17]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">I_trapezno_boljši</span> <span class="o">=</span> <span class="mi">4</span><span class="o">/</span><span class="mi">3</span><span class="o">*</span><span class="n">I_trapezno_sest</span> <span class="o">-</span> <span class="mi">1</span><span class="o">/</span><span class="mi">3</span><span class="o">*</span><span class="n">I_trapezno</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;Točen rezultat:   </span><span class="si">{</span><span class="n">I_točno</span><span class="si">}</span><span class="se">\n</span><span class="s1">Boljši približek: </span><span class="si">{</span><span class="n">I_trapezno_boljši</span><span class="si">}</span><span class="s1">&#39;</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">


<div class="output_area">

    <div class="prompt"></div>


<div class="output_subarea output_stream output_stdout output_text">
<pre>Točen rezultat:   1.4404224209802097
Boljši približek: 1.4408392930139313
</pre>
</div>
</div>

</div>
</div>

</div>
<div class="cell border-box-sizing text_cell rendered"><div class="prompt input_prompt">
</div><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h3 id="numpy-implementacija-sestavljenega-trapeznega-pravila"><code>numpy</code> implementacija sestavljenega trapeznega pravila<a class="anchor-link" href="#numpy-implementacija-sestavljenega-trapeznega-pravila">&#182;</a></h3>
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="prompt input_prompt">
</div><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>Sestavljeno trapezno pravilo je implementirano tudi v paketu <code>numpy</code>, s funkcijo <code>numpy.trapz</code>:</p>
<div class="highlight"><pre><span></span><span class="n">trapz</span><span class="p">(</span><span class="n">y</span><span class="p">,</span> <span class="n">x</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">dx</span><span class="o">=</span><span class="mf">1.0</span><span class="p">,</span> <span class="n">axis</span><span class="o">=-</span><span class="mi">1</span><span class="p">)</span>
</pre></div>
<ul>
<li><code>y</code> predstavlja tabelo funkcijskih vrednosti, </li>
<li><code>x</code> je opcijski parameter in definira vozlišča; če parameter ni definiran, se privzame ekvidistančna vozlišča na razdalji <code>dx</code>,</li>
<li><code>dx</code> definira (konstanten) korak integracije, ima privzeto vrednost 1,</li>
<li><code>axis</code> definira <em>os</em> po kateri se integrira (v primeru, da je <code>y</code> večdimenzijsko numerično polje).</li>
</ul>
<p>Funkcija vrne izračunani integral po sestavljenem trapeznem pravilu. Več informacij lahko najdete v <a href="https://docs.scipy.org/doc/numpy/reference/generated/numpy.trapz.html">dokumentaciji</a>.</p>

</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="prompt input_prompt">
</div><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>Poglejmo si primer:</p>

</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In&nbsp;[18]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="c1">#%%timeit</span>
<span class="n">I_trapezno_np</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">trapz</span><span class="p">(</span><span class="n">y3v</span><span class="p">,</span> <span class="n">dx</span><span class="o">=</span><span class="n">h3v</span><span class="p">)</span>
<span class="n">I_trapezno_np</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">


<div class="output_area">

    <div class="prompt output_prompt">Out[18]:</div>




<div class="output_latex output_subarea output_execute_result">
$\displaystyle 1.41313769956786$
</div>

</div>

</div>
</div>

</div>
<div class="cell border-box-sizing text_cell rendered"><div class="prompt input_prompt">
</div><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h2 id="Simpsonova-in-druge-metode">Simpsonova in druge metode<a class="anchor-link" href="#Simpsonova-in-druge-metode">&#182;</a></h2>
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="prompt input_prompt">
</div><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>Zgoraj smo si pogledali trapezno pravilo, ki temelji na linearni interpolacijski funkciji na posameznem podintervalu. Z interpolacijo višjega reda lahko izpeljemo še druge integracijske metode.</p>

</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="prompt input_prompt">
</div><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>Izračunati moramo:
$$\int_{a}^b f(x)\,dx.$$</p>

</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="prompt input_prompt">
</div><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>Tabeliramo podintegralsko funkcijo $f(x)$ in tabelo interpoliramo z Lagrangevim interpolacijskim polinomom $P_n(x)$ stopnje $n$:</p>
$$P_n(x)=\sum_{i=0}^{n}\,f(x_i)\,l_i(x),$$<p>kjer so $y_i=f(x_i)$ funkcijske vrednosti v vozliščih $x_i$ in je Lagrangev polinom $l_i$ definiran kot:</p>
$$l_i(x)=\prod_{j=0, j\ne i}^n \frac{x-x_j}{x_i-x_j}.$$
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="prompt input_prompt">
</div><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>Za numerični izračun integrala $\int_{a}^b f(x)\,dx$ (meje so: $a=x_0$, $b=x_n$) namesto funkcije $f(x)$ vstavimo v integral interpolacijski polinom $P_n(x)$:</p>
$$I=\int_{x_0}^{x_{n}} P_n(x)\,dx=\int_{x_0}^{x_{n}} \sum_{i=0}^{n}\,f(x_i)\,l_i(x)\,dx.$$
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="prompt input_prompt">
</div><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>Ker je integriranje linearna operacija, lahko zamenjamo integriranje in vsoto:</p>
$$I=\sum_{i=0}^{n}\,f(x_i)\,\underbrace{\int_{x_0}^{x_{n}} l_i(x)\,dx}_{A_i}.$$<p>Lagrangev polinom integriramo in dobimo uteži $A_i$:</p>
$$A_i = \int_{x_0}^{x_{n}} l_i(x)\,dx$$
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="prompt input_prompt">
</div><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h3 id="Izpeljava-trapeznega-pravila-z-uporabo-Lagrangevih-polinomov">Izpeljava trapeznega pravila z uporabo Lagrangevih polinomov<a class="anchor-link" href="#Izpeljava-trapeznega-pravila-z-uporabo-Lagrangevih-polinomov">&#182;</a></h3>
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="prompt input_prompt">
</div><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>Poglejmo si kako z Lagrangevim interpolacijskim polinomom prve stopnje strojno izpeljemo uteži $A_i$ v primeru trapeznega pravila.</p>
<p>Najprej v simbolni obliki definirajmo spremenljivko <code>x</code>, vozlišči <code>x0</code> in <code>x1</code> ter korak <code>h</code>:</p>

</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In&nbsp;[19]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">x</span><span class="p">,</span> <span class="n">x0</span><span class="p">,</span> <span class="n">x1</span><span class="p">,</span> <span class="n">h</span> <span class="o">=</span> <span class="n">sym</span><span class="o">.</span><span class="n">symbols</span><span class="p">(</span><span class="s1">&#39;x x0, x1, h&#39;</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

</div>
<div class="cell border-box-sizing text_cell rendered"><div class="prompt input_prompt">
</div><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>Pripravimo Python funkcijo, ki v simbolni obliki vrne seznam $n$ koeficientov Lagrangevih polinomov $[l_0(x), l_1(x),\dots, l_{n-1}(x)]$ stopnje $n-1$:</p>

</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In&nbsp;[20]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="k">def</span> <span class="nf">lagrange</span><span class="p">(</span><span class="n">n</span><span class="p">,</span> <span class="n">x</span><span class="p">,</span> <span class="n">vozlišča_predpona</span><span class="o">=</span><span class="s1">&#39;x&#39;</span><span class="p">):</span>
    <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">vozlišča_predpona</span><span class="p">,</span> <span class="nb">str</span><span class="p">):</span>
        <span class="n">vozlišča</span> <span class="o">=</span> <span class="n">sym</span><span class="o">.</span><span class="n">symbols</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;</span><span class="si">{</span><span class="n">vozlišča_predpona</span><span class="si">}</span><span class="s1">:</span><span class="si">{</span><span class="n">n</span><span class="si">}</span><span class="s1">&#39;</span><span class="p">)</span> 
    <span class="n">coeffs</span> <span class="o">=</span> <span class="p">[]</span>
    <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="n">n</span><span class="p">):</span>
        <span class="n">numer</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="n">denom</span> <span class="o">=</span> <span class="p">[]</span>

        <span class="k">for</span> <span class="n">j</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="n">n</span><span class="p">):</span>
            <span class="k">if</span> <span class="n">i</span> <span class="o">==</span> <span class="n">j</span><span class="p">:</span>
                <span class="k">continue</span>

            <span class="n">numer</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">x</span>    <span class="o">-</span> <span class="n">vozlišča</span><span class="p">[</span><span class="n">j</span><span class="p">])</span>
            <span class="n">denom</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">vozlišča</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">-</span> <span class="n">vozlišča</span><span class="p">[</span><span class="n">j</span><span class="p">])</span>
        
        <span class="n">numer</span> <span class="o">=</span> <span class="n">sym</span><span class="o">.</span><span class="n">Mul</span><span class="p">(</span><span class="o">*</span><span class="n">numer</span><span class="p">)</span>
        <span class="n">denom</span> <span class="o">=</span> <span class="n">sym</span><span class="o">.</span><span class="n">Mul</span><span class="p">(</span><span class="o">*</span><span class="n">denom</span><span class="p">)</span>

        <span class="n">coeffs</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">numer</span><span class="o">/</span><span class="n">denom</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">coeffs</span>    
</pre></div>

    </div>
</div>
</div>

</div>
<div class="cell border-box-sizing text_cell rendered"><div class="prompt input_prompt">
</div><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>Najprej poglejmo Lagrangeva polinoma za linearno interpolacijo ($n=2$):</p>

</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In&nbsp;[21]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">lag</span> <span class="o">=</span> <span class="n">lagrange</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span> <span class="n">x</span><span class="p">)</span>
<span class="n">lag</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">


<div class="output_area">

    <div class="prompt output_prompt">Out[21]:</div>




<div class="output_latex output_subarea output_execute_result">
$\displaystyle \left[ \frac{x - x_{1}}{x_{0} - x_{1}}, \  \frac{x - x_{0}}{- x_{0} + x_{1}}\right]$
</div>

</div>

</div>
</div>

</div>
<div class="cell border-box-sizing text_cell rendered"><div class="prompt input_prompt">
</div><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>Sedaj Lagrangev polinom $l_0(x)$ integriramo čez celotni interval:</p>

</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In&nbsp;[22]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">int0</span> <span class="o">=</span> <span class="n">sym</span><span class="o">.</span><span class="n">integrate</span><span class="p">(</span><span class="n">lag</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">x0</span><span class="p">,</span> <span class="n">x1</span><span class="p">))</span>
<span class="n">int0</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">


<div class="output_area">

    <div class="prompt output_prompt">Out[22]:</div>




<div class="output_latex output_subarea output_execute_result">
$\displaystyle - \frac{x_{0}^{2}}{2 x_{0} - 2 x_{1}} + \frac{x_{0} x_{1}}{x_{0} - x_{1}} + \frac{x_{1}^{2}}{2 x_{0} - 2 x_{1}} - \frac{x_{1}^{2}}{x_{0} - x_{1}}$
</div>

</div>

</div>
</div>

</div>
<div class="cell border-box-sizing text_cell rendered"><div class="prompt input_prompt">
</div><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>Izraz poenostavimo in dobimo:</p>

</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In&nbsp;[23]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">int1</span> <span class="o">=</span> <span class="n">int0</span><span class="o">.</span><span class="n">factor</span><span class="p">()</span>
<span class="n">int1</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">


<div class="output_area">

    <div class="prompt output_prompt">Out[23]:</div>




<div class="output_latex output_subarea output_execute_result">
$\displaystyle - \frac{x_{0} - x_{1}}{2}$
</div>

</div>

</div>
</div>

</div>
<div class="cell border-box-sizing text_cell rendered"><div class="prompt input_prompt">
</div><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>Ker je širina podintervala konstantna je $x_1=h_0+h$, izvedemo zamenjavo:</p>

</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In&nbsp;[24]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">zamenjave</span> <span class="o">=</span> <span class="p">{</span><span class="n">x1</span><span class="p">:</span> <span class="n">x0</span><span class="o">+</span><span class="n">h</span><span class="p">}</span>
<span class="n">int1</span><span class="o">.</span><span class="n">subs</span><span class="p">(</span><span class="n">zamenjave</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">


<div class="output_area">

    <div class="prompt output_prompt">Out[24]:</div>




<div class="output_latex output_subarea output_execute_result">
$\displaystyle \frac{h}{2}$
</div>

</div>

</div>
</div>

</div>
<div class="cell border-box-sizing text_cell rendered"><div class="prompt input_prompt">
</div><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>Zgornje korake za Lagrangev polinom  $l_0(x)$ lahko posplošimo za seznam Lagrangevih polinomov:</p>

</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In&nbsp;[25]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">x</span><span class="p">,</span> <span class="n">x0</span><span class="p">,</span> <span class="n">x1</span><span class="p">,</span> <span class="n">h</span> <span class="o">=</span> <span class="n">sym</span><span class="o">.</span><span class="n">symbols</span><span class="p">(</span><span class="s1">&#39;x, x0, x1, h&#39;</span><span class="p">)</span>
<span class="n">zamenjave</span> <span class="o">=</span> <span class="p">{</span><span class="n">x1</span><span class="p">:</span> <span class="n">x0</span><span class="o">+</span><span class="n">h</span><span class="p">}</span>
<span class="n">A_trapez</span> <span class="o">=</span> <span class="p">[</span><span class="n">sym</span><span class="o">.</span><span class="n">integrate</span><span class="p">(</span><span class="n">li</span><span class="p">,</span> <span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">x0</span><span class="p">,</span> <span class="n">x1</span><span class="p">))</span><span class="o">.</span><span class="n">factor</span><span class="p">()</span><span class="o">.</span><span class="n">subs</span><span class="p">(</span><span class="n">zamenjave</span><span class="p">)</span> 
            <span class="k">for</span> <span class="n">li</span> <span class="ow">in</span> <span class="n">lagrange</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span> <span class="n">x</span><span class="p">)]</span>  <span class="c1"># za vsak lagrangev polimom `li` v seznamu lagrange(2,x)</span>
<span class="n">A_trapez</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">


<div class="output_area">

    <div class="prompt output_prompt">Out[25]:</div>




<div class="output_latex output_subarea output_execute_result">
$\displaystyle \left[ \frac{h}{2}, \  \frac{h}{2}\right]$
</div>

</div>

</div>
</div>

</div>
<div class="cell border-box-sizing text_cell rendered"><div class="prompt input_prompt">
</div><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>Izpeljali smo uteži, ki smo jih uporabili pri trapezni metodi:</p>
$$A_0=h/2\qquad A_1=h/2.$$
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="prompt input_prompt">
</div><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>Trapezno pravilo je:</p>
$$I_{\textrm{trapezno}}=\frac{h}{2}\left(y_0+y_1\right)$$<p>Ocena napake je (vir: Burden, Faires, Burden: Numerical Analysis 10th Ed):
$$E_{\textrm{trapezno}}= -\frac{h^3}{12}f''(\xi).$$</p>

</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="prompt input_prompt">
</div><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h3 id="Izra&#269;un-ute&#382;i-za-Simpsonovo-pravilo">Izra&#269;un ute&#382;i za Simpsonovo pravilo<a class="anchor-link" href="#Izra&#269;un-ute&#382;i-za-Simpsonovo-pravilo">&#182;</a></h3>
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="prompt input_prompt">
</div><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>Potem ko smo zgoraj pokazali strnjen izračun za trapezno pravilo, lahko podobno izvedemo za kvadratno interpolacijo čez tri točke ($n=3$).</p>
<p>Izračun uteži je analogen zgornjemu:</p>

</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In&nbsp;[26]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">x</span><span class="p">,</span> <span class="n">x0</span><span class="p">,</span> <span class="n">x1</span><span class="p">,</span> <span class="n">x2</span><span class="p">,</span> <span class="n">h</span> <span class="o">=</span> <span class="n">sym</span><span class="o">.</span><span class="n">symbols</span><span class="p">(</span><span class="s1">&#39;x, x0, x1, x2, h&#39;</span><span class="p">)</span>
<span class="n">zamenjave</span> <span class="o">=</span> <span class="p">{</span><span class="n">x1</span><span class="p">:</span> <span class="n">x0</span><span class="o">+</span><span class="n">h</span><span class="p">,</span> <span class="n">x2</span><span class="p">:</span> <span class="n">x0</span><span class="o">+</span><span class="mi">2</span><span class="o">*</span><span class="n">h</span><span class="p">}</span>
<span class="n">A_Simpson1_3</span> <span class="o">=</span> <span class="p">[</span><span class="n">sym</span><span class="o">.</span><span class="n">integrate</span><span class="p">(</span><span class="n">li</span><span class="p">,</span> <span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">x0</span><span class="p">,</span> <span class="n">x2</span><span class="p">))</span><span class="o">.</span><span class="n">factor</span><span class="p">()</span><span class="o">.</span><span class="n">subs</span><span class="p">(</span><span class="n">zamenjave</span><span class="p">)</span><span class="o">.</span><span class="n">factor</span><span class="p">()</span> 
             <span class="k">for</span> <span class="n">li</span> <span class="ow">in</span> <span class="n">lagrange</span><span class="p">(</span><span class="mi">3</span><span class="p">,</span> <span class="n">x</span><span class="p">)]</span>
<span class="n">A_Simpson1_3</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">


<div class="output_area">

    <div class="prompt output_prompt">Out[26]:</div>




<div class="output_latex output_subarea output_execute_result">
$\displaystyle \left[ \frac{h}{3}, \  \frac{4 h}{3}, \  \frac{h}{3}\right]$
</div>

</div>

</div>
</div>

</div>
<div class="cell border-box-sizing text_cell rendered"><div class="prompt input_prompt">
</div><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>Simpsonovo pravilo (to pravilo se imenuje tudi Simpsonovo 1/3 pravilo) je:</p>
$$I_{\textrm{Simpsonovo}}=\frac{h}{3}\left(y_0+4\,y_1+y_2\right)$$<p>Ocena napake je (vir: Burden, Faires, Burden: Numerical Analysis 10th Ed):
$$E_{\textrm{Simpsonovo}}= -\frac{h^5}{90}f^{(4)}(\xi).$$</p>
<p>Pri tem je treba izpostaviti, da je napaka lokalno 5 reda  $\mathcal{O}(h^5)$ in definirana z neznano vrednostjo četrtega odvoda $f^{(4)}(\xi)$, posledično je to pravilo točno za polinome stopnje 3 ali manj.</p>

</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="prompt input_prompt">
</div><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>Primer uporabe:</p>

</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In&nbsp;[27]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">I_Simps</span> <span class="o">=</span> <span class="n">h3v</span><span class="o">/</span><span class="mi">3</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">sum</span><span class="p">(</span><span class="n">y3v</span> <span class="o">*</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">4</span><span class="p">,</span> <span class="mi">1</span><span class="p">])</span>
<span class="n">I_Simps</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">


<div class="output_area">

    <div class="prompt output_prompt">Out[27]:</div>




<div class="output_latex output_subarea output_execute_result">
$\displaystyle 1.44083929301393$
</div>

</div>

</div>
</div>

</div>
<div class="cell border-box-sizing text_cell rendered"><div class="prompt input_prompt">
</div><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>Pripravimo sliko. Ker Simsonovo pravilo temelji na kvadratni interpolaciji, moramo naprej pripraviti interpolacijski polinom (pomagamo si s <code>scipy.interpolate</code>):</p>

</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In&nbsp;[28]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="kn">from</span> <span class="nn">scipy</span> <span class="kn">import</span> <span class="n">interpolate</span>
</pre></div>

    </div>
</div>
</div>

</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In&nbsp;[29]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="k">def</span> <span class="nf">fig_Simpsonovo</span><span class="p">():</span>
    <span class="n">y_interpolate</span> <span class="o">=</span> <span class="n">interpolate</span><span class="o">.</span><span class="n">lagrange</span><span class="p">(</span><span class="n">x3v</span><span class="p">,</span> <span class="n">y3v</span><span class="p">)</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">fill_between</span><span class="p">(</span><span class="n">xg</span><span class="p">,</span> <span class="n">y_interpolate</span><span class="p">(</span><span class="n">xg</span><span class="p">),</span> <span class="n">alpha</span><span class="o">=</span><span class="mf">0.25</span><span class="p">,</span> <span class="n">facecolor</span><span class="o">=</span><span class="s1">&#39;r&#39;</span><span class="p">)</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">vlines</span><span class="p">(</span><span class="n">x3v</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="n">y3v</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;r&#39;</span><span class="p">,</span> <span class="n">linestyles</span><span class="o">=</span><span class="s1">&#39;dashed&#39;</span><span class="p">,</span> <span class="n">lw</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">annotate</span><span class="p">(</span><span class="s1">&#39;$I_{</span><span class="se">\\</span><span class="s1">textrm</span><span class="si">{Simpsonovo}</span><span class="s1">}$&#39;</span><span class="p">,</span> <span class="p">(</span><span class="mf">1.2</span><span class="p">,</span> <span class="mf">0.5</span><span class="p">),</span> <span class="n">fontsize</span><span class="o">=</span><span class="mi">22</span><span class="p">)</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">annotate</span><span class="p">(</span><span class="s1">&#39;Napaka&#39;</span><span class="p">,</span> <span class="n">fontsize</span><span class="o">=</span><span class="mi">20</span><span class="p">,</span> <span class="n">xy</span><span class="o">=</span><span class="p">(</span><span class="mf">1.75</span><span class="p">,</span> <span class="mf">1.7</span><span class="p">),</span> <span class="n">xytext</span><span class="o">=</span><span class="p">(</span><span class="mf">1.4</span><span class="p">,</span> <span class="mf">1.8</span><span class="p">),</span>
            <span class="n">arrowprops</span><span class="o">=</span><span class="nb">dict</span><span class="p">(</span><span class="n">facecolor</span><span class="o">=</span><span class="s1">&#39;gray&#39;</span><span class="p">,</span> <span class="n">shrink</span><span class="o">=</span><span class="mf">0.05</span><span class="p">))</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">annotate</span><span class="p">(</span><span class="s1">&#39;Napaka&#39;</span><span class="p">,</span> <span class="n">fontsize</span><span class="o">=</span><span class="mi">20</span><span class="p">,</span> <span class="n">xy</span><span class="o">=</span><span class="p">(</span><span class="mf">1.2</span><span class="p">,</span> <span class="mf">1.1</span><span class="p">),</span> <span class="n">xytext</span><span class="o">=</span><span class="p">(</span><span class="mf">1.</span><span class="p">,</span> <span class="mf">1.4</span><span class="p">),</span>
            <span class="n">arrowprops</span><span class="o">=</span><span class="nb">dict</span><span class="p">(</span><span class="n">facecolor</span><span class="o">=</span><span class="s1">&#39;gray&#39;</span><span class="p">,</span> <span class="n">shrink</span><span class="o">=</span><span class="mf">0.05</span><span class="p">))</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">xg</span><span class="p">,</span> <span class="n">yg</span><span class="p">,</span> <span class="n">lw</span><span class="o">=</span><span class="mi">3</span><span class="p">,</span> <span class="n">alpha</span><span class="o">=</span><span class="mf">0.5</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s1">&#39;$x\,\sin(x)$&#39;</span><span class="p">)</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">x3v</span><span class="p">,</span> <span class="n">y3v</span><span class="p">,</span> <span class="s1">&#39;o&#39;</span><span class="p">,</span> <span class="n">alpha</span><span class="o">=</span><span class="mf">0.5</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="sa">f</span><span class="s1">&#39;$h=</span><span class="si">{</span><span class="n">h3v</span><span class="si">}</span><span class="s1">$&#39;</span><span class="p">)</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">legend</span><span class="p">(</span><span class="n">loc</span><span class="o">=</span><span class="p">(</span><span class="mf">1.01</span><span class="p">,</span> <span class="mi">0</span><span class="p">))</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">ylim</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">2</span><span class="p">)</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>

    </div>
</div>
</div>

</div>
<div class="cell border-box-sizing text_cell rendered"><div class="prompt input_prompt">
</div><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>Prikažemo:</p>

</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In&nbsp;[&nbsp;]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">fig_Simpsonovo</span><span class="p">()</span>
</pre></div>

    </div>
</div>
</div>

</div>
<div class="cell border-box-sizing text_cell rendered"><div class="prompt input_prompt">
</div><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h3 id="scipy.integrate.newton_cotes"><code>scipy.integrate.newton_cotes</code><a class="anchor-link" href="#scipy.integrate.newton_cotes">&#182;</a></h3><p>Koeficiente integracijskega pristopa Newton-Cotes pridobimo tudi s pomočjo <code>scipy.integrate.newton_cotes()</code> <a href="https://docs.scipy.org/doc/scipy/reference/generated/scipy.integrate.newton_cotes.html#scipy.integrate.newton_cotes">dokumentacija</a>:</p>
<div class="highlight"><pre><span></span><span class="n">newton_cotes</span><span class="p">(</span><span class="n">rn</span><span class="p">,</span> <span class="n">equal</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span>
</pre></div>
<p>kjer sta parametra:</p>
<ul>
<li><code>rn</code>, ki definira število podintervalov (mogoč je tudi nekonstanten korak, glejte <a href="https://docs.scipy.org/doc/scipy/reference/generated/scipy.integrate.newton_cotes.html#scipy.integrate.newton_cotes">dokumentacijo</a>),</li>
<li><code>equal</code>, ki definira ali se zahteva konstantno široke podintervale.</li>
</ul>
<p>Funkcija vrne terko, pri čemer prvi element predstavlja numerično polje uteži in drugi člen oceno napake.</p>

</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="prompt input_prompt">
</div><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>Poglejmo si primer:</p>

</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In&nbsp;[&nbsp;]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="kn">from</span> <span class="nn">scipy</span> <span class="kn">import</span> <span class="n">integrate</span>
<span class="n">integrate</span><span class="o">.</span><span class="n">newton_cotes</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

</div>
<div class="cell border-box-sizing text_cell rendered"><div class="prompt input_prompt">
</div><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h3 id="Izra&#269;un-ute&#382;i-za-Simpsonovo-3/8-pravilo">Izra&#269;un ute&#382;i za Simpsonovo 3/8 pravilo<a class="anchor-link" href="#Izra&#269;un-ute&#382;i-za-Simpsonovo-3/8-pravilo">&#182;</a></h3>
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="prompt input_prompt">
</div><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>Nadaljujemo lahko s kubično interpolacijo čez štiri točke ($n=4$):</p>

</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In&nbsp;[&nbsp;]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">x</span><span class="p">,</span> <span class="n">x0</span><span class="p">,</span> <span class="n">x1</span><span class="p">,</span> <span class="n">x2</span><span class="p">,</span> <span class="n">x3</span><span class="p">,</span> <span class="n">h</span> <span class="o">=</span> <span class="n">sym</span><span class="o">.</span><span class="n">symbols</span><span class="p">(</span><span class="s1">&#39;x, x0, x1, x2, x3, h&#39;</span><span class="p">)</span>
<span class="n">zamenjave</span> <span class="o">=</span> <span class="p">{</span><span class="n">x1</span><span class="p">:</span> <span class="n">x0</span><span class="o">+</span><span class="n">h</span><span class="p">,</span> <span class="n">x2</span><span class="p">:</span> <span class="n">x0</span><span class="o">+</span><span class="mi">2</span><span class="o">*</span><span class="n">h</span><span class="p">,</span> <span class="n">x3</span><span class="p">:</span> <span class="n">x0</span><span class="o">+</span><span class="mi">3</span><span class="o">*</span><span class="n">h</span><span class="p">}</span>
<span class="n">A_Simpson3_8</span> <span class="o">=</span> <span class="p">[</span><span class="n">sym</span><span class="o">.</span><span class="n">integrate</span><span class="p">(</span><span class="n">li</span><span class="p">,</span> <span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">x0</span><span class="p">,</span> <span class="n">x3</span><span class="p">))</span><span class="o">.</span><span class="n">factor</span><span class="p">()</span><span class="o">.</span><span class="n">subs</span><span class="p">(</span><span class="n">zamenjave</span><span class="p">)</span><span class="o">.</span><span class="n">factor</span><span class="p">()</span> 
                <span class="k">for</span> <span class="n">li</span> <span class="ow">in</span> <span class="n">lagrange</span><span class="p">(</span><span class="mi">4</span><span class="p">,</span> <span class="n">x</span><span class="p">)]</span>
<span class="n">A_Simpson3_8</span>
</pre></div>

    </div>
</div>
</div>

</div>
<div class="cell border-box-sizing text_cell rendered"><div class="prompt input_prompt">
</div><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>Simpsonovo 3/8 pravilo je:</p>
$$I_{\textrm{Simpsonovo 3/8}}=\frac{3h}{8}\left(y_0+3\,y_1+3\,y_2+y_3\right)$$<p>Ocena napake je (vir: Burden, Faires, Burden: Numerical Analysis 10th Ed):
$$E_{\textrm{Simpsonovo 3/8}}= -\frac{3\,h^5}{80}f^{(4)}(\xi).$$</p>

</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="prompt input_prompt">
</div><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>Poglejmo si primer uporabe. Uporabimo pripravljeno tabelo vrednosti funkcije v štirih točkah:</p>

</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In&nbsp;[&nbsp;]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">y4v</span>
</pre></div>

    </div>
</div>
</div>

</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In&nbsp;[&nbsp;]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">I_Simps38</span> <span class="o">=</span> <span class="mi">3</span><span class="o">*</span><span class="n">h4v</span><span class="o">/</span><span class="mi">8</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">sum</span><span class="p">(</span><span class="n">y4v</span> <span class="o">*</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">1</span><span class="p">])</span>
<span class="n">I_Simps38</span>
</pre></div>

    </div>
</div>
</div>

</div>
<div class="cell border-box-sizing text_cell rendered"><div class="prompt input_prompt">
</div><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>Pripravimo še prikaz:</p>

</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In&nbsp;[&nbsp;]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="k">def</span> <span class="nf">fig_Simpsonovo38</span><span class="p">():</span>
    <span class="n">y_interpolate</span> <span class="o">=</span> <span class="n">interpolate</span><span class="o">.</span><span class="n">lagrange</span><span class="p">(</span><span class="n">x4v</span><span class="p">,</span> <span class="n">y4v</span><span class="p">)</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">fill_between</span><span class="p">(</span><span class="n">xg</span><span class="p">,</span> <span class="n">y_interpolate</span><span class="p">(</span><span class="n">xg</span><span class="p">),</span> <span class="n">alpha</span><span class="o">=</span><span class="mf">0.25</span><span class="p">,</span> <span class="n">facecolor</span><span class="o">=</span><span class="s1">&#39;r&#39;</span><span class="p">)</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">vlines</span><span class="p">(</span><span class="n">x4v</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="n">y4v</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;r&#39;</span><span class="p">,</span> <span class="n">linestyles</span><span class="o">=</span><span class="s1">&#39;dashed&#39;</span><span class="p">,</span> <span class="n">lw</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">annotate</span><span class="p">(</span><span class="s1">&#39;$I_{</span><span class="se">\\</span><span class="s1">textrm{Simpsonovo 3/8}}$&#39;</span><span class="p">,</span> <span class="p">(</span><span class="mf">1.2</span><span class="p">,</span> <span class="mf">0.5</span><span class="p">),</span> <span class="n">fontsize</span><span class="o">=</span><span class="mi">22</span><span class="p">)</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">annotate</span><span class="p">(</span><span class="s1">&#39;Napaka&#39;</span><span class="p">,</span> <span class="n">fontsize</span><span class="o">=</span><span class="mi">20</span><span class="p">,</span> <span class="n">xy</span><span class="o">=</span><span class="p">(</span><span class="mf">1.75</span><span class="p">,</span> <span class="mf">1.7</span><span class="p">),</span> <span class="n">xytext</span><span class="o">=</span><span class="p">(</span><span class="mf">1.4</span><span class="p">,</span> <span class="mf">1.8</span><span class="p">),</span>
            <span class="n">arrowprops</span><span class="o">=</span><span class="nb">dict</span><span class="p">(</span><span class="n">facecolor</span><span class="o">=</span><span class="s1">&#39;gray&#39;</span><span class="p">,</span> <span class="n">shrink</span><span class="o">=</span><span class="mf">0.05</span><span class="p">))</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">annotate</span><span class="p">(</span><span class="s1">&#39;Napaka&#39;</span><span class="p">,</span> <span class="n">fontsize</span><span class="o">=</span><span class="mi">20</span><span class="p">,</span> <span class="n">xy</span><span class="o">=</span><span class="p">(</span><span class="mf">1.5</span><span class="p">,</span> <span class="mf">1.47</span><span class="p">),</span> <span class="n">xytext</span><span class="o">=</span><span class="p">(</span><span class="mf">1.1</span><span class="p">,</span> <span class="mf">1.6</span><span class="p">),</span>
            <span class="n">arrowprops</span><span class="o">=</span><span class="nb">dict</span><span class="p">(</span><span class="n">facecolor</span><span class="o">=</span><span class="s1">&#39;gray&#39;</span><span class="p">,</span> <span class="n">shrink</span><span class="o">=</span><span class="mf">0.05</span><span class="p">))</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">annotate</span><span class="p">(</span><span class="s1">&#39;Napaka&#39;</span><span class="p">,</span> <span class="n">fontsize</span><span class="o">=</span><span class="mi">20</span><span class="p">,</span> <span class="n">xy</span><span class="o">=</span><span class="p">(</span><span class="mf">1.2</span><span class="p">,</span> <span class="mf">1.1</span><span class="p">),</span> <span class="n">xytext</span><span class="o">=</span><span class="p">(</span><span class="mf">1.</span><span class="p">,</span> <span class="mf">1.4</span><span class="p">),</span>
            <span class="n">arrowprops</span><span class="o">=</span><span class="nb">dict</span><span class="p">(</span><span class="n">facecolor</span><span class="o">=</span><span class="s1">&#39;gray&#39;</span><span class="p">,</span> <span class="n">shrink</span><span class="o">=</span><span class="mf">0.05</span><span class="p">))</span>    
    <span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">xg</span><span class="p">,</span> <span class="n">yg</span><span class="p">,</span> <span class="n">lw</span><span class="o">=</span><span class="mi">3</span><span class="p">,</span> <span class="n">alpha</span><span class="o">=</span><span class="mf">0.5</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s1">&#39;$x\,\sin(x)$&#39;</span><span class="p">)</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">x4v</span><span class="p">,</span> <span class="n">y4v</span><span class="p">,</span> <span class="s1">&#39;o&#39;</span><span class="p">,</span> <span class="n">alpha</span><span class="o">=</span><span class="mf">0.5</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="sa">f</span><span class="s1">&#39;$h=</span><span class="si">{</span><span class="n">h4v</span><span class="si">:</span><span class="s1">.6f</span><span class="si">}</span><span class="s1">$&#39;</span><span class="p">)</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">legend</span><span class="p">(</span><span class="n">loc</span><span class="o">=</span><span class="p">(</span><span class="mf">1.01</span><span class="p">,</span> <span class="mi">0</span><span class="p">))</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">ylim</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">2</span><span class="p">)</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>

    </div>
</div>
</div>

</div>
<div class="cell border-box-sizing text_cell rendered"><div class="prompt input_prompt">
</div><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>Prikažemo:</p>

</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In&nbsp;[&nbsp;]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">fig_Simpsonovo38</span><span class="p">()</span> 
</pre></div>

    </div>
</div>
</div>

</div>
<div class="cell border-box-sizing text_cell rendered"><div class="prompt input_prompt">
</div><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h2 id="Sestavljeno-Simpsonovo-pravilo">Sestavljeno Simpsonovo pravilo<a class="anchor-link" href="#Sestavljeno-Simpsonovo-pravilo">&#182;</a></h2>
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="prompt input_prompt">
</div><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>Interval $[a, b]$ razdelimo na sodo število $n$ podintervalov enake širine $h=(b - a)/n$, s čimer so definirana vozlišča $x_i=a+i\,h$ za $i=0,1,\dots,n$. V tem primeru zapišemo sestavljeno Simpsonovo pravilo:</p>
$$\int_{a}^{b}f(x)\,\textrm{d}x=
\frac{h}{3}\left(
f(x_0)
+4\sum_{i=1}^{n/2}f(x_{2i-1})
+2\sum_{i=1}^{n/2-1}f(x_{2i})
+f(x_n)
\right)
\underbrace{
-\frac{b-a}{180}h^4\,f^{(4)}(\eta)
}_{E_{\textrm{Sestavljeno Simpsonovo 1/3}}}
,$$
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="prompt input_prompt">
</div><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>kjer je $\eta$ neznana vrednost na intervalu $[a, b]$. Napaka je četrtega reda $\mathcal{O}(h^4)$.</p>

</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="prompt input_prompt">
</div><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>Numerična implementacija:</p>

</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In&nbsp;[&nbsp;]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="k">def</span> <span class="nf">simpsonovo_sest</span><span class="p">(</span><span class="n">y</span><span class="p">,</span> <span class="n">h</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Sestavljeno Simpsonovo pravilo integriranja.</span>

<span class="sd">    :param y: funkcijske vrednosti</span>
<span class="sd">    :param h: korak integriranja</span>
<span class="sd">    &quot;&quot;&quot;</span>    
    <span class="k">return</span> <span class="n">h</span><span class="o">/</span><span class="mi">3</span> <span class="o">*</span> <span class="p">(</span><span class="n">y</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">+</span> <span class="mi">4</span><span class="o">*</span><span class="n">np</span><span class="o">.</span><span class="n">sum</span><span class="p">(</span><span class="n">y</span><span class="p">[</span><span class="mi">1</span><span class="p">:</span><span class="o">-</span><span class="mi">1</span><span class="p">:</span><span class="mi">2</span><span class="p">])</span> <span class="o">+</span> <span class="mi">2</span><span class="o">*</span><span class="n">np</span><span class="o">.</span><span class="n">sum</span><span class="p">(</span><span class="n">y</span><span class="p">[</span><span class="mi">2</span><span class="p">:</span><span class="o">-</span><span class="mi">1</span><span class="p">:</span><span class="mi">2</span><span class="p">])</span> <span class="o">+</span> <span class="n">y</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">])</span>
</pre></div>

    </div>
</div>
</div>

</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In&nbsp;[&nbsp;]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">I_Simps_sest</span> <span class="o">=</span> <span class="n">simpsonovo_sest</span><span class="p">(</span><span class="n">y5v</span><span class="p">,</span> <span class="n">h</span><span class="o">=</span><span class="n">h5v</span><span class="p">)</span>
<span class="n">I_Simps_sest</span>
</pre></div>

    </div>
</div>
</div>

</div>
<div class="cell border-box-sizing text_cell rendered"><div class="prompt input_prompt">
</div><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>Pripravimo sliko:</p>

</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In&nbsp;[&nbsp;]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="k">def</span> <span class="nf">fig_Simpsonovo_sest</span><span class="p">():</span>
    <span class="n">y_interpolate</span> <span class="o">=</span> <span class="n">interpolate</span><span class="o">.</span><span class="n">lagrange</span><span class="p">(</span><span class="n">x5v</span><span class="p">,</span> <span class="n">y5v</span><span class="p">)</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">fill_between</span><span class="p">(</span><span class="n">xg</span><span class="p">,</span> <span class="n">y_interpolate</span><span class="p">(</span><span class="n">xg</span><span class="p">),</span> <span class="n">alpha</span><span class="o">=</span><span class="mf">0.25</span><span class="p">,</span> <span class="n">facecolor</span><span class="o">=</span><span class="s1">&#39;r&#39;</span><span class="p">)</span>       
    <span class="n">plt</span><span class="o">.</span><span class="n">vlines</span><span class="p">(</span><span class="n">x5v</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="n">y5v</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;r&#39;</span><span class="p">,</span> <span class="n">linestyles</span><span class="o">=</span><span class="s1">&#39;dashed&#39;</span><span class="p">,</span> <span class="n">lw</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">annotate</span><span class="p">(</span><span class="s1">&#39;$I_{</span><span class="se">\\</span><span class="s1">textrm{Simpsonovo sestavljeno}}$&#39;</span><span class="p">,</span> <span class="p">(</span><span class="mf">1.2</span><span class="p">,</span> <span class="mf">0.5</span><span class="p">),</span> <span class="n">fontsize</span><span class="o">=</span><span class="mi">22</span><span class="p">)</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">annotate</span><span class="p">(</span><span class="s1">&#39;Napaka&#39;</span><span class="p">,</span> <span class="n">fontsize</span><span class="o">=</span><span class="mi">20</span><span class="p">,</span> <span class="n">xy</span><span class="o">=</span><span class="p">(</span><span class="mf">1.70</span><span class="p">,</span> <span class="mf">1.68</span><span class="p">),</span> <span class="n">xytext</span><span class="o">=</span><span class="p">(</span><span class="mf">1.4</span><span class="p">,</span> <span class="mf">1.8</span><span class="p">),</span>
            <span class="n">arrowprops</span><span class="o">=</span><span class="nb">dict</span><span class="p">(</span><span class="n">facecolor</span><span class="o">=</span><span class="s1">&#39;gray&#39;</span><span class="p">,</span> <span class="n">shrink</span><span class="o">=</span><span class="mf">0.05</span><span class="p">))</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">xg</span><span class="p">,</span> <span class="n">yg</span><span class="p">,</span> <span class="n">lw</span><span class="o">=</span><span class="mi">3</span><span class="p">,</span> <span class="n">alpha</span><span class="o">=</span><span class="mf">0.5</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s1">&#39;$x\,\sin(x)$&#39;</span><span class="p">)</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">x5v</span><span class="p">,</span> <span class="n">y5v</span><span class="p">,</span> <span class="s1">&#39;o&#39;</span><span class="p">,</span> <span class="n">alpha</span><span class="o">=</span><span class="mf">0.5</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="sa">f</span><span class="s1">&#39;$h=</span><span class="si">{</span><span class="n">h5v</span><span class="si">}</span><span class="s1">$&#39;</span><span class="p">)</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">legend</span><span class="p">(</span><span class="n">loc</span><span class="o">=</span><span class="p">(</span><span class="mf">1.01</span><span class="p">,</span> <span class="mi">0</span><span class="p">))</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">ylim</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">2</span><span class="p">)</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>

    </div>
</div>
</div>

</div>
<div class="cell border-box-sizing text_cell rendered"><div class="prompt input_prompt">
</div><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>Prikažemo:</p>

</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In&nbsp;[&nbsp;]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">fig_Simpsonovo_sest</span><span class="p">()</span>
</pre></div>

    </div>
</div>
</div>

</div>
<div class="cell border-box-sizing text_cell rendered"><div class="prompt input_prompt">
</div><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h3 id="Bolj&#353;a-ocena-integrala">Bolj&#353;a ocena integrala<a class="anchor-link" href="#Bolj&#353;a-ocena-integrala">&#182;</a></h3>
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="prompt input_prompt">
</div><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>Napaka sestavljene Simpsonove metode je definirana z:
$$E_{\textrm{Sestavljeno Simpsonovo 1/3}}= 
-\frac{b-a}{180}h^4\,f^{(4)}(\eta),$$
kjer je $\eta$ neznana vrednost na intervalu $[a, b]$.</p>

</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="prompt input_prompt">
</div><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>Izboljšano oceno integrala določimo na podoben način kakor pri sestavljeni trapezni metodi; integral $I$ ocenjujemo pri dveh različnih korakih $h$ in $2\,h$, velja natančno:</p>
$$\int_a^b f(x)\,\textrm{d}x = I_h + E_h = I_{2h} + E_{2h},$$<p>kjer je $I_h$ približek integrala s korakom $h$ in $E_h$ ocena napake pri koraku $h$; analogno velja za $I_{2h}$ in $E_{2h}$.</p>

</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="prompt input_prompt">
</div><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>Če predpostavimo, da je $f^{(4)}\left (\eta \right )$ v obeh primerih enak, lahko določimo razliko $I_{2h}-I_{h} = E_{h}-E_{2h}$.</p>

</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="prompt input_prompt">
</div><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>Naprej zapišemo:</p>
$$E_h=-\frac{b-a}{180}h^4\,f^{(4)}(\eta)=h^4\,K.$$<p>Ob predpostavki, da je $f^{(4)}\left (\eta \right )$ pri koraku $h$ in $2h$ enak ($\eta$ je pri koraku $h$ in $2h$ dejansko različen), zapišemo:</p>
$$E_{2h}=-\frac{(b-a)}{180}(2h)^4\,f^{(4)}(\eta)=16\,h^4\,K$$
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="prompt input_prompt">
</div><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>Sledi:</p>
$$I_{2h}-I_h=-15K\,h^4.$$<p>Sedaj lahko ocenimo napako pri koraku $h$:</p>
$$E_h=h^4\,K=\frac{I_h-I_{2h}}{15}.$$
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="prompt input_prompt">
</div><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>Na podlagi ocene napake lahko izračunamo boljši približek  $I_{h}^*$:</p>
$$I_h^* = I_h + \frac{1}{15}\,(I_{h}-I_{2h})$$<p>ali</p>
$$I_h^* = \frac{16}{15}\,I_h - \frac{1}{15}\,I_{2h}$$
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="prompt input_prompt">
</div><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h3 id="Numeri&#269;ni-zgled">Numeri&#269;ni zgled<a class="anchor-link" href="#Numeri&#269;ni-zgled">&#182;</a></h3>
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="prompt input_prompt">
</div><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>Predhodno smo s Simpsonovim pravilom že izračunali integral pri koraku $h=0,5$ in pri koraku $h=0,25$, rezultata sta bila:</p>

</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In&nbsp;[&nbsp;]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="p">[</span><span class="n">I_Simps</span><span class="p">,</span> <span class="n">I_Simps_sest</span><span class="p">]</span>
</pre></div>

    </div>
</div>
</div>

</div>
<div class="cell border-box-sizing text_cell rendered"><div class="prompt input_prompt">
</div><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>S pomočjo zgornje formule izračunamo boljši približek:</p>

</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In&nbsp;[&nbsp;]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">I_Simps_boljši</span> <span class="o">=</span> <span class="mi">16</span><span class="o">/</span><span class="mi">15</span><span class="o">*</span><span class="n">I_Simps_sest</span> <span class="o">-</span> <span class="mi">1</span><span class="o">/</span><span class="mi">15</span><span class="o">*</span><span class="n">I_Simps</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;Točen rezultat:   </span><span class="si">{</span><span class="n">I_točno</span><span class="si">}</span><span class="se">\n</span><span class="s1">Boljši približek: </span><span class="si">{</span><span class="n">I_Simps_boljši</span><span class="si">}</span><span class="s1">&#39;</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

</div>
<div class="cell border-box-sizing text_cell rendered"><div class="prompt input_prompt">
</div><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>Pridobimo boljši numerični približek, izgubimo pa oceno napake!</p>

</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="prompt input_prompt">
</div><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h3 id="Simpsonova-metoda-v-scipy.integrate.simps">Simpsonova metoda v <code>scipy.integrate.simps</code><a class="anchor-link" href="#Simpsonova-metoda-v-scipy.integrate.simps">&#182;</a></h3>
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="prompt input_prompt">
</div><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>V <code>scipy</code> je implementirano sestavljeno Simpsonovo pravilo v <code>scipy.integrate.simps()</code> (<a href="https://docs.scipy.org/doc/scipy/reference/generated/scipy.integrate.simps.html">dokumentacija</a>):</p>
<div class="highlight"><pre><span></span><span class="n">simps</span><span class="p">(</span><span class="n">y</span><span class="p">,</span> <span class="n">x</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">dx</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">axis</span><span class="o">=-</span><span class="mi">1</span><span class="p">,</span> <span class="n">even</span><span class="o">=</span><span class="s1">&#39;avg&#39;</span><span class="p">)</span>
</pre></div>
<p>kjer so parametri:</p>
<ul>
<li><code>y</code> tabela funkcijskih vrednosti, ki jih integriramo,</li>
<li><code>x</code> vozlišča, gre za opcijski parameter, če je <code>x=None</code>, se predpostavi ekvidistantne podintervale širine <code>dx</code>,</li>
<li><code>dx</code> širina ekvidistantnih podintervalov oz korak integriranja,</li>
<li><code>axis</code> os integriranja (pomembno v primeru večdimenzijskega numeričnega polja)</li>
<li><code>even</code> je lahko {<code>'avg'</code>, <code>'first'</code>, <code>'last'</code>} in definira način integriranja v primeru lihega števila podintervalov.</li>
</ul>

</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="prompt input_prompt">
</div><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>Poglejmo si primer, najprej uvozimo funkcijo <code>simps</code>:</p>

</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In&nbsp;[&nbsp;]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="kn">from</span> <span class="nn">scipy.integrate</span> <span class="kn">import</span> <span class="n">simps</span>
</pre></div>

    </div>
</div>
</div>

</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In&nbsp;[&nbsp;]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="c1">#%%timeit</span>
<span class="n">simps</span><span class="p">(</span><span class="n">y5v</span><span class="p">,</span> <span class="n">dx</span><span class="o">=</span><span class="n">h5v</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

</div>
<div class="cell border-box-sizing text_cell rendered"><div class="prompt input_prompt">
</div><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h2 id="Rombergova-metoda*">Rombergova metoda*<a class="anchor-link" href="#Rombergova-metoda*">&#182;</a></h2>
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="prompt input_prompt">
</div><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>Rombergova metoda temelji na Richardsonovi ekstrapolaciji. Predpostavimo, da integral $\int_a^b f(x)\textrm{d}x$ integriramo na intervalu $[a,b]$, ki ga razdelimo na $2^{n-1}$ podintervalov ($n=1,2,4,8, \dots$).</p>
<p>Rezultat trapeznega pravila pri $n=1$ označimo z $R_{\underbrace{1}_{n},\underbrace{1}_{j}}$, pri čemer $j$ označuje natančnost pridobljenega rezultata $\mathcal{O}(h^{2j})$.</p>

</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="prompt input_prompt">
</div><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>Če uporabimo trapezno integracijsko pravilo pri $n=1,2,4 \dots$ podintervalih, izračunamo:</p>
<ul>
<li>$R_{1,1}$, korak $h_1=h$, red natančnosti $\mathcal{O}(h_1^2)$,</li>
<li>$R_{2,1}$, korak $h_2=h/2$, red natančnosti $\mathcal{O}(h_2^2)$,</li>
<li>$R_{3,1}$, korak $h_3=h/4$, red natančnosti $\mathcal{O}(h_3^2)$,</li>
<li>$R_{4,1}$, korak $h_4=h/8$, red natančnosti $\mathcal{O}(h_4^2)$,</li>
<li>$\dots$</li>
<li>$R_{n,1}$, korak $h_4=h/(2^{n-1})$, red natančnosti $\mathcal{O}(h_n^2)$.</li>
</ul>

</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="prompt input_prompt">
</div><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>Na podlagi Richardsonove ekstrapolacije izračunamo boljši približek</p>
<ul>
<li>$R_{2,2} = R_{2,1} + \frac{1}{3}\left(R_{2,1}-R_{1,1}\right)$, korak $h_2=h/2$, red natančnosti $\mathcal{O}(h_2^4)$,</li>
<li>$R_{3,2} = R_{3,1} + \frac{1}{3}\left(R_{3,1}-R_{2,1}\right)$, korak $h_3=h/4$, red natančnosti $\mathcal{O}(h_3^4)$,</li>
<li>$\dots$</li>
<li>$R_{n,2} = R_{n,1} + \frac{1}{3}\left(R_{n,1}-R_{n-1,1}\right)$, korak $h_n=h/(2^{n-1})$, red natančnosti $\mathcal{O}(h_n^4)$.</li>
</ul>

</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="prompt input_prompt">
</div><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>Nato nadaljujemo z Richardsonovo ekstrapolacijo:</p>
<ul>
<li>$R_{3,3} = R_{3,2} + \frac{1}{15}\left(R_{3,2}-R_{2,2}\right)$, korak $h_3=h/4$, red natančnosti $\mathcal{O}(h_3^6)$,</li>
<li>$\dots$</li>
<li>$R_{n,3} = R_{n,2} + \frac{1}{15}\left(R_{n,2}-R_{n-1,2}\right)$, korak $h_n=h/(2^{n-1})$, red natančnosti $\mathcal{O}(h_n^6)$.</li>
</ul>

</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="prompt input_prompt">
</div><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>Richardsonovo extrapolacijo lahko posplošimo:</p>
<ul>
<li>$R_{n,j} = R_{n,j-1} + \frac{1}{4^{j-1}-1}\left(R_{n,j-1}-R_{n-1,j-1}\right)$, korak $h_n=h/(2^{n-1})$, red natančnosti $\mathcal{O}(h_n^{2j})$</li>
</ul>

</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="prompt input_prompt">
</div><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>Pri tem je boljši približek $R_{2,2}$ pri koraku $h/2$ enak rezultatu, ki ga dobimo po Simpsonovi metodi pri koraku $h/2$. Podobno je boljši približek $R_{3,2}$ pri koraku $h/4$ enak numeričnemu integralu Simpsonove metode pri koraku $h/4$. In je dalje $R_{3,3}$ enak popravljenemu približku Simpsonove metode pri koraku $h/4$.</p>

</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="prompt input_prompt">
</div><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>Pripravimo numerične podatke:</p>

</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In&nbsp;[&nbsp;]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">x9v</span><span class="p">,</span> <span class="n">h9v</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">9</span><span class="p">,</span> <span class="n">retstep</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>  <span class="c1"># korak h9v = 0.125 (9 vozlišč)</span>
<span class="n">y9v</span> <span class="o">=</span> <span class="n">x9v</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">sin</span><span class="p">(</span><span class="n">x9v</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

</div>
<div class="cell border-box-sizing text_cell rendered"><div class="prompt input_prompt">
</div><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>Poglejmo si primer od zgoraj. Najprej s sestavljeno trapezno metodo izračunamo integral pri različnih korakih (drugi red napake):</p>

</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In&nbsp;[&nbsp;]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="c1"># O(h^2)</span>
<span class="n">R1_1</span> <span class="o">=</span> <span class="n">trapezno_sest</span><span class="p">(</span><span class="n">y9v</span><span class="p">[::</span><span class="mi">8</span><span class="p">],</span> <span class="mi">8</span><span class="o">*</span><span class="n">h9v</span><span class="p">)</span> <span class="c1"># h=1.0</span>
<span class="n">R2_1</span> <span class="o">=</span> <span class="n">trapezno_sest</span><span class="p">(</span><span class="n">y9v</span><span class="p">[::</span><span class="mi">4</span><span class="p">],</span> <span class="mi">4</span><span class="o">*</span><span class="n">h9v</span><span class="p">)</span> <span class="c1"># h=0.5</span>
<span class="n">R3_1</span> <span class="o">=</span> <span class="n">trapezno_sest</span><span class="p">(</span><span class="n">y9v</span><span class="p">[::</span><span class="mi">2</span><span class="p">],</span> <span class="mi">2</span><span class="o">*</span><span class="n">h9v</span><span class="p">)</span> <span class="c1"># h=0.25</span>
<span class="n">R4_1</span> <span class="o">=</span> <span class="n">trapezno_sest</span><span class="p">(</span><span class="n">y9v</span><span class="p">,</span> <span class="n">h9v</span><span class="p">)</span> <span class="c1"># h=0.125</span>
<span class="p">[</span><span class="n">R1_1</span><span class="p">,</span> <span class="n">R2_1</span><span class="p">,</span> <span class="n">R3_1</span><span class="p">,</span> <span class="n">R4_1</span><span class="p">]</span>
</pre></div>

    </div>
</div>
</div>

</div>
<div class="cell border-box-sizing text_cell rendered"><div class="prompt input_prompt">
</div><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>Nato izračunamo boljše približke (dobimo četrti red napake):</p>

</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In&nbsp;[&nbsp;]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="c1"># O(h^4)</span>
<span class="n">R2_2</span> <span class="o">=</span> <span class="n">R2_1</span> <span class="o">+</span> <span class="mi">1</span><span class="o">/</span><span class="mi">3</span> <span class="o">*</span> <span class="p">(</span><span class="n">R2_1</span> <span class="o">-</span> <span class="n">R1_1</span><span class="p">)</span>
<span class="n">R3_2</span> <span class="o">=</span> <span class="n">R3_1</span> <span class="o">+</span> <span class="mi">1</span><span class="o">/</span><span class="mi">3</span> <span class="o">*</span> <span class="p">(</span><span class="n">R3_1</span> <span class="o">-</span> <span class="n">R2_1</span><span class="p">)</span>
<span class="n">R4_2</span> <span class="o">=</span> <span class="n">R4_1</span> <span class="o">+</span> <span class="mi">1</span><span class="o">/</span><span class="mi">3</span> <span class="o">*</span> <span class="p">(</span><span class="n">R4_1</span> <span class="o">-</span> <span class="n">R3_1</span><span class="p">)</span>
<span class="p">[</span><span class="n">R2_2</span><span class="p">,</span> <span class="n">R3_2</span><span class="p">,</span> <span class="n">R4_2</span><span class="p">]</span>
</pre></div>

    </div>
</div>
</div>

</div>
<div class="cell border-box-sizing text_cell rendered"><div class="prompt input_prompt">
</div><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>Rezultati predstavljajo rezultat Simpsonove metode pri koraku $h=0,5$, $h=0,25$ in $h=0.125$:</p>

</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In&nbsp;[&nbsp;]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="p">[</span><span class="n">simpsonovo_sest</span><span class="p">(</span><span class="n">y9v</span><span class="p">[::</span><span class="mi">4</span><span class="p">],</span> <span class="mi">4</span><span class="o">*</span><span class="n">h9v</span><span class="p">),</span> <span class="n">simpsonovo_sest</span><span class="p">(</span><span class="n">y9v</span><span class="p">[::</span><span class="mi">2</span><span class="p">],</span> <span class="mi">2</span><span class="o">*</span><span class="n">h9v</span><span class="p">),</span> <span class="n">simpsonovo_sest</span><span class="p">(</span><span class="n">y9v</span><span class="p">,</span> <span class="n">h9v</span><span class="p">)]</span>
</pre></div>

    </div>
</div>
</div>

</div>
<div class="cell border-box-sizing text_cell rendered"><div class="prompt input_prompt">
</div><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>Ponovno izračunamo boljše približke (dobimo šesti red napake):</p>

</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In&nbsp;[&nbsp;]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="c1"># O(h6)</span>
<span class="n">R3_3</span> <span class="o">=</span> <span class="n">R3_2</span> <span class="o">+</span> <span class="mi">1</span><span class="o">/</span><span class="mi">15</span> <span class="o">*</span> <span class="p">(</span><span class="n">R3_2</span> <span class="o">-</span> <span class="n">R2_2</span><span class="p">)</span>
<span class="n">R4_3</span> <span class="o">=</span> <span class="n">R4_2</span> <span class="o">+</span> <span class="mi">1</span><span class="o">/</span><span class="mi">15</span> <span class="o">*</span> <span class="p">(</span><span class="n">R4_2</span> <span class="o">-</span> <span class="n">R3_2</span><span class="p">)</span>

<span class="p">[</span><span class="n">R3_3</span><span class="p">,</span> <span class="n">R4_3</span><span class="p">]</span>
</pre></div>

    </div>
</div>
</div>

</div>
<div class="cell border-box-sizing text_cell rendered"><div class="prompt input_prompt">
</div><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>Rezultat predstavlja boljši rezultat Simpsonove pri koraku $h=0,25$ in $h=0.125$:</p>

</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In&nbsp;[&nbsp;]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">a4h</span><span class="p">,</span> <span class="n">a2h</span><span class="p">,</span> <span class="n">ah</span> <span class="o">=</span> <span class="p">[</span><span class="n">simpsonovo_sest</span><span class="p">(</span><span class="n">y9v</span><span class="p">[::</span><span class="mi">4</span><span class="p">],</span> <span class="mi">4</span><span class="o">*</span><span class="n">h9v</span><span class="p">),</span> <span class="n">simpsonovo_sest</span><span class="p">(</span><span class="n">y9v</span><span class="p">[::</span><span class="mi">2</span><span class="p">],</span> <span class="mi">2</span><span class="o">*</span><span class="n">h9v</span><span class="p">),</span> <span class="n">simpsonovo_sest</span><span class="p">(</span><span class="n">y9v</span><span class="p">,</span> <span class="n">h9v</span><span class="p">)]</span>
<span class="p">[</span><span class="mi">16</span><span class="o">/</span><span class="mi">15</span><span class="o">*</span><span class="n">a2h</span><span class="o">-</span><span class="mi">1</span><span class="o">/</span><span class="mi">15</span><span class="o">*</span><span class="n">a4h</span><span class="p">,</span> <span class="mi">16</span><span class="o">/</span><span class="mi">15</span><span class="o">*</span><span class="n">ah</span><span class="o">-</span><span class="mi">1</span><span class="o">/</span><span class="mi">15</span><span class="o">*</span><span class="n">a2h</span><span class="p">]</span>
</pre></div>

    </div>
</div>
</div>

</div>
<div class="cell border-box-sizing text_cell rendered"><div class="prompt input_prompt">
</div><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>Ponovno izračunamo boljše približke (dobimo osmi red napake):</p>

</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In&nbsp;[&nbsp;]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="c1"># O(h8)</span>
<span class="n">R4_4</span> <span class="o">=</span> <span class="n">R4_3</span> <span class="o">+</span> <span class="mi">1</span><span class="o">/</span><span class="mi">63</span> <span class="o">*</span> <span class="p">(</span><span class="n">R4_3</span> <span class="o">-</span> <span class="n">R3_3</span><span class="p">)</span>
<span class="n">R4_4</span>
</pre></div>

    </div>
</div>
</div>

</div>
<div class="cell border-box-sizing text_cell rendered"><div class="prompt input_prompt">
</div><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>Rombergova metoda nam torej ponuja visoko natančnost rezultata za relativno majhno numerično ceno. Napako pa ocenimo:</p>
$$E = \left|R_{n,n}-R_{n-1,n-1}\right|.$$
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="prompt input_prompt">
</div><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h3 id="Rombergova-metoda-v-scipy.integrate.romb">Rombergova metoda v <code>scipy.integrate.romb</code><a class="anchor-link" href="#Rombergova-metoda-v-scipy.integrate.romb">&#182;</a></h3>
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="prompt input_prompt">
</div><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>V <code>scipy</code> je implementirana Rombergova metoda v <code>scipy.integrate.romb()</code> (<a href="https://docs.scipy.org/doc/scipy/reference/generated/scipy.integrate.romb.html#scipy.integrate.romb">dokumentacija</a>):</p>
<div class="highlight"><pre><span></span><span class="n">romb</span><span class="p">(</span><span class="n">y</span><span class="p">,</span> <span class="n">dx</span><span class="o">=</span><span class="mf">1.0</span><span class="p">,</span> <span class="n">axis</span><span class="o">=-</span><span class="mi">1</span><span class="p">,</span> <span class="n">show</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
</pre></div>
<p>kjer so parametri:</p>
<ul>
<li><code>y</code> tabela funkcijskih vrednosti, ki jih integriramo,</li>
<li><code>dx</code> širina ekvidistantnih podintervalov oz korak integriranja,</li>
<li><code>axis</code> or integriranja (pomembno v primeru večdimenzijskega numeričnega polja),</li>
<li><code>show</code> če je <code>True</code> prikaže elemente Richardsonove ekstrapolacije.</li>
</ul>

</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="prompt input_prompt">
</div><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>Poglejmo si primer od zgoraj:</p>

</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In&nbsp;[&nbsp;]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="kn">from</span> <span class="nn">scipy.integrate</span> <span class="kn">import</span> <span class="n">romb</span>
</pre></div>

    </div>
</div>
</div>

</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In&nbsp;[&nbsp;]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">y9v</span>
</pre></div>

    </div>
</div>
</div>

</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In&nbsp;[&nbsp;]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">romb</span><span class="p">(</span><span class="n">y9v</span><span class="p">,</span> <span class="n">dx</span><span class="o">=</span><span class="n">h9v</span><span class="p">,</span> <span class="n">show</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

</div>
<div class="cell border-box-sizing text_cell rendered"><div class="prompt input_prompt">
</div><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h1 id="Gaussov-integracijski-pristop">Gaussov integracijski pristop<a class="anchor-link" href="#Gaussov-integracijski-pristop">&#182;</a></h1>
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="prompt input_prompt">
</div><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>Newton-Cotesov pristop temelji na polinomu $n$-te stopnje in napaka je $n+1$ stopnje. To pomeni, da integracija daje točen rezultat, če je integrirana funkcija polinom stopnje $n$ ali manj.</p>

</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="prompt input_prompt">
</div><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>Gaussov integracijski pristop je v principu drugačen: cilj je integral funkcije $f(x)$ nadomestiti z uteženo vsoto vrednosti funkcije pri diskretnih vrednostih $f(x_i)$:
$$\int_a^bf(x)\,\textrm{d}x\approx \sum_{i=0}^{n-1} w_i\, f(x_i).$$
Pri tem je neznana utež $w_i$ in tudi lega vozlišča $x_i$. Za stopnje polinoma $n$ bomo potrebovali tudi več  točk $(x_i, f(x_i))$.</p>

</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="prompt input_prompt">
</div><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>V nadaljevanju bomo spoznali, da lahko zelo učinkovito izračunamo numerično točen integral. Prednost Gaussove integracije je tudi, da lahko izračuna integral funkcij s singularnostmi (npr: $\int_0^1\sin(x)/\sqrt{(x)}\,dx$).</p>

</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="prompt input_prompt">
</div><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h2 id="Gaussova-kvadratura-z-enim-vozli&#353;&#269;em">Gaussova kvadratura z enim vozli&#353;&#269;em<a class="anchor-link" href="#Gaussova-kvadratura-z-enim-vozli&#353;&#269;em">&#182;</a></h2>
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="prompt input_prompt">
</div><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>Predpostavimo, da želimo integrirati polinom stopnje $n=1$ (linearna funkcija):</p>
$$f(x)=P_1(x)=A_0+A_1\,x.$$
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="prompt input_prompt">
</div><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>Izračunajmo:</p>
$$\int_a^bP_1(x)\,\textrm{d}x=\left(A_0\,x+A_1\,\frac{x^2}{2}\right)_a^b=-A_0\,a+A_0\,b-\frac{A_1\,a^2}{2}+\frac{A_1\,b^2}{2}.$$
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="prompt input_prompt">
</div><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>Po drugi strani pa želimo integral izračunati glede na ustrezno uteženo $w_0$ vrednost funkcije $f(x_0)$ v neznanem vozlišču $x_0$ (samo eno vozlišče!):</p>
$$\int_a^bP_1(x)\,\textrm{d}x = w_0\,P_1(x_0)= w_0\,A_0+w_0\,A_1\,x_0.$$
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="prompt input_prompt">
</div><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>Z enačenjem zgornjih izrazov izpeljemo:</p>
$$-A_0\,a+A_0\,b-\frac{A_1\,a^2}{2}+\frac{A_1\,b^2}{2}=w_0\,A_0+w_0\,A_1\,x_0.$$
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="prompt input_prompt">
</div><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>$A_0$ in $A_1$ sta koeficienta linearne funkcije, ki lahko zavzame poljubne vrednosti, zato velja:</p>
$$A_0\,\left(-a+b-w_0\right)=0\qquad\textrm{in}\qquad A_1\left(-\frac{a^2}{2}+\frac{b^2}{2}-w_0\,x_0\right)=0.$$
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="prompt input_prompt">
</div><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>Gre za sistem linearnih enačb z rešitvijo:</p>
$$w_0= b-a, \qquad x_0=\frac{b+a}{2}.$$<p>Če je integrirana funkcija linearna, bomo samo na podlagi vrednosti v eni točki izračunali pravo vrednost!</p>

</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="prompt input_prompt">
</div><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>Da je Gaussov integracijski pristop neodvisen od mej integriranja $a$, $b$, pa uvedemo standardne meje.</p>

</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="prompt input_prompt">
</div><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h3 id="Standardne-meje:-$a=-1$-in-$b=1$">Standardne meje: $a=-1$ in $b=1$<a class="anchor-link" href="#Standardne-meje:-$a=-1$-in-$b=1$">&#182;</a></h3><p>Zaradi splošnosti meje $x\in[a,b]$ transformiramo v $\xi\in[-1, +1]$ s pomočjo:</p>
$$x=\frac{b+a}{2}+\frac{b-a}{2}\xi$$<p>in 
$$\textrm{d}x=\frac{b-a}{2}\textrm{d}\xi.$$</p>

</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="prompt input_prompt">
</div><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>Velja:</p>
$$\int_a^bf(x)\,\textrm{d}x=\int_{-1}^1 g\left(\xi\right)\,\textrm{d}\xi,$$<p>kjer je:</p>
$$g(\xi)=\frac{b-a}{2}\,f\left(\frac{b+a}{2}+\frac{b-a}{2}\xi\right).$$
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="prompt input_prompt">
</div><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>V primeru standardnih mej je pri eni Gaussovi točki utež $w_0=2$ in $x_0=0$ vrednost, pri kateri moramo izračunati funkcijo $f(x_0)$.</p>

</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="prompt input_prompt">
</div><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h3 id="Strojno-izpeljevanje-ute&#382;i-in-Gaussove-to&#269;ke">Strojno izpeljevanje ute&#382;i in Gaussove to&#269;ke<a class="anchor-link" href="#Strojno-izpeljevanje-ute&#382;i-in-Gaussove-to&#269;ke">&#182;</a></h3>
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="prompt input_prompt">
</div><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>Definirajmo simbole in nastavimo enačbo:</p>

</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In&nbsp;[&nbsp;]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">A0</span><span class="p">,</span> <span class="n">A1</span><span class="p">,</span> <span class="n">x</span><span class="p">,</span> <span class="n">a</span><span class="p">,</span> <span class="n">b</span><span class="p">,</span> <span class="n">w0</span><span class="p">,</span> <span class="n">x0</span> <span class="o">=</span> <span class="n">sym</span><span class="o">.</span><span class="n">symbols</span><span class="p">(</span><span class="s1">&#39;A0, A1, x, a, b, w0, x0&#39;</span><span class="p">)</span> <span class="c1"># simboli</span>
<span class="n">P1</span> <span class="o">=</span> <span class="n">A0</span> <span class="o">+</span> <span class="n">A1</span><span class="o">*</span><span class="n">x</span>                                                   <span class="c1"># linearni polinom</span>
<span class="n">eq</span> <span class="o">=</span> <span class="n">sym</span><span class="o">.</span><span class="n">Eq</span><span class="p">(</span><span class="n">P1</span><span class="o">.</span><span class="n">integrate</span><span class="p">((</span><span class="n">x</span><span class="p">,</span> <span class="n">a</span><span class="p">,</span> <span class="n">b</span><span class="p">))</span><span class="o">.</span><span class="n">expand</span><span class="p">(),</span> <span class="n">w0</span><span class="o">*</span><span class="n">P1</span><span class="o">.</span><span class="n">subs</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">x0</span><span class="p">))</span> <span class="c1"># teoretični integral = ocen z utežmi</span>
<span class="n">eq</span>
</pre></div>

    </div>
</div>
</div>

</div>
<div class="cell border-box-sizing text_cell rendered"><div class="prompt input_prompt">
</div><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>Pripravimo dve enačbi (za prvo predpostavimo $A_0=0, A_1=1$, za drugo predpostavimo $A_0=1, A_1=0$) ter rešimo sistem za <code>w0</code> in <code>x0</code>:</p>

</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In&nbsp;[&nbsp;]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">sym</span><span class="o">.</span><span class="n">solve</span><span class="p">([</span><span class="n">eq</span><span class="o">.</span><span class="n">subs</span><span class="p">(</span><span class="n">A0</span><span class="p">,</span> <span class="mi">0</span><span class="p">)</span><span class="o">.</span><span class="n">subs</span><span class="p">(</span><span class="n">A1</span><span class="p">,</span> <span class="mi">1</span><span class="p">),</span> <span class="n">eq</span><span class="o">.</span><span class="n">subs</span><span class="p">(</span><span class="n">A1</span><span class="p">,</span> <span class="mi">0</span><span class="p">)</span><span class="o">.</span><span class="n">subs</span><span class="p">(</span><span class="n">A0</span><span class="p">,</span> <span class="mi">1</span><span class="p">)],</span> <span class="p">[</span><span class="n">w0</span><span class="p">,</span> <span class="n">x0</span><span class="p">])</span>
</pre></div>

    </div>
</div>
</div>

</div>
<div class="cell border-box-sizing text_cell rendered"><div class="prompt input_prompt">
</div><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>Za dodatno razlago priporočam <a href="https://www.youtube.com/watch?v=iQ5-4hx25Rw">video posnetek</a>.</p>

</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="prompt input_prompt">
</div><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h2 id="Gaussova-integracijska-metoda-z-ve&#269;-vozli&#353;&#269;i">Gaussova integracijska metoda z ve&#269; vozli&#353;&#269;i<a class="anchor-link" href="#Gaussova-integracijska-metoda-z-ve&#269;-vozli&#353;&#269;i">&#182;</a></h2>
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="prompt input_prompt">
</div><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>Izpeljati želimo Gaussovo integracijsko metodo, ki bo upoštevala na intervalu $[a,b]$ $v$ vozlišč in bo točno izračunala integral polinomov do stopnje $n=2v-1$. Veljati mora:</p>
$$\int_a^bP_{2v-1}(x)\,\textrm{d}x = \sum_{i=0}^{v-1} w_i\,P_{2v-1}(x_i).$$<p>Pri izpeljavi se bomo omejili na standardne meje $a=-1$, $b=1$,</p>

</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="prompt input_prompt">
</div><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>kjer je polinom stopnje $n=2v-1$ definiran kot:
$$P_{2v-1}(x)=\sum_{i=0}^{2v-1} A_i\,x^i.$$</p>

</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="prompt input_prompt">
</div><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>Z dvema Gaussovima točkama/vozliščema točno izračunamo integral polinoma do tretjega reda, s tremi Gausovimi vozlišči pa točno izračunamo integral polinoma do petega reda!</p>

</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="prompt input_prompt">
</div><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h3 id="Strojno-izpeljevanje">Strojno izpeljevanje<a class="anchor-link" href="#Strojno-izpeljevanje">&#182;</a></h3><p>Pripravimo si najprej simbolni zapis polinoma in ustreznih spremenljivk:</p>

</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In&nbsp;[&nbsp;]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="k">def</span> <span class="nf">P_etc</span><span class="p">(</span><span class="n">n</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">A</span><span class="o">=</span><span class="s1">&#39;A&#39;</span><span class="p">,</span> <span class="n">x</span><span class="o">=</span><span class="s1">&#39;x&#39;</span><span class="p">):</span>                       <span class="c1"># n je stopnja polinoma</span>
    <span class="n">Ai</span> <span class="o">=</span> <span class="n">sym</span><span class="o">.</span><span class="n">symbols</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;</span><span class="si">{</span><span class="n">A</span><span class="si">}</span><span class="s1">:</span><span class="si">{</span><span class="n">n</span><span class="o">+</span><span class="mi">1</span><span class="si">}</span><span class="s1">&#39;</span><span class="p">)</span>  <span class="c1"># seznam A_i</span>
    <span class="n">x</span> <span class="o">=</span> <span class="n">sym</span><span class="o">.</span><span class="n">symbols</span><span class="p">(</span><span class="n">x</span><span class="p">)</span>                              <span class="c1"># spremenljivka x</span>
    <span class="k">return</span> <span class="n">Ai</span><span class="p">,</span> <span class="n">x</span><span class="p">,</span> <span class="nb">sum</span><span class="p">([</span><span class="n">Ai</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">*</span><span class="n">x</span><span class="o">**</span><span class="n">i</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">n</span><span class="o">+</span><span class="mi">1</span><span class="p">)])</span>
</pre></div>

    </div>
</div>
</div>

</div>
<div class="cell border-box-sizing text_cell rendered"><div class="prompt input_prompt">
</div><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>Sedaj pa poiščimo uteži $w_i$ in vozlišča $x_i$ za primer dveh Gaussovih vozlišč; polinom je torej tretje stopnje.</p>

</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In&nbsp;[&nbsp;]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">v</span> <span class="o">=</span> <span class="mi">2</span> <span class="c1"># število vozlišč</span>
<span class="n">Ai</span><span class="p">,</span> <span class="n">x</span><span class="p">,</span> <span class="n">P</span> <span class="o">=</span> <span class="n">P_etc</span><span class="p">(</span><span class="n">n</span><span class="o">=</span><span class="mi">2</span><span class="o">*</span><span class="n">v</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span>
<span class="n">xi</span> <span class="o">=</span> <span class="n">sym</span><span class="o">.</span><span class="n">symbols</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;x:</span><span class="si">{</span><span class="n">v</span><span class="si">}</span><span class="s1">&#39;</span><span class="p">)</span> <span class="c1"># seznam x_i</span>
<span class="n">wi</span> <span class="o">=</span> <span class="n">sym</span><span class="o">.</span><span class="n">symbols</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;w:</span><span class="si">{</span><span class="n">v</span><span class="si">}</span><span class="s1">&#39;</span><span class="p">)</span> <span class="c1"># seznam w_i</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;Vozlišča: </span><span class="si">{</span><span class="n">xi</span><span class="si">}</span><span class="se">\n</span><span class="s1">Uteži:    </span><span class="si">{</span><span class="n">wi</span><span class="si">}</span><span class="s1">&#39;</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

</div>
<div class="cell border-box-sizing text_cell rendered"><div class="prompt input_prompt">
</div><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>Polinom:</p>

</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In&nbsp;[&nbsp;]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">P</span>
</pre></div>

    </div>
</div>
</div>

</div>
<div class="cell border-box-sizing text_cell rendered"><div class="prompt input_prompt">
</div><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>Podobno kakor zgoraj za eno vozlišče, tukaj definirajmo enačbe:</p>

</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In&nbsp;[&nbsp;]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">eqs</span> <span class="o">=</span> <span class="p">[</span><span class="n">sym</span><span class="o">.</span><span class="n">Eq</span><span class="p">(</span><span class="n">P</span><span class="o">.</span><span class="n">integrate</span><span class="p">((</span><span class="n">x</span><span class="p">,</span> <span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">))</span><span class="o">.</span><span class="n">coeff</span><span class="p">(</span><span class="n">A_</span><span class="p">),</span>\
              <span class="nb">sum</span><span class="p">([</span><span class="n">wi</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">*</span><span class="n">P</span><span class="o">.</span><span class="n">subs</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">xi</span><span class="p">[</span><span class="n">i</span><span class="p">])</span> \
                   <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">v</span><span class="p">)])</span><span class="o">.</span><span class="n">expand</span><span class="p">()</span><span class="o">.</span><span class="n">coeff</span><span class="p">(</span><span class="n">A_</span><span class="p">))</span> \
       <span class="k">for</span> <span class="n">A_</span> <span class="ow">in</span> <span class="n">Ai</span><span class="p">]</span>
<span class="n">eqs</span>
</pre></div>

    </div>
</div>
</div>

</div>
<div class="cell border-box-sizing text_cell rendered"><div class="prompt input_prompt">
</div><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>Rešimo jih za za neznane $x_i$ in $w_i$:</p>

</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In&nbsp;[&nbsp;]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">sol</span> <span class="o">=</span> <span class="n">sym</span><span class="o">.</span><span class="n">solve</span><span class="p">(</span><span class="n">eqs</span><span class="p">,</span> <span class="n">sym</span><span class="o">.</span><span class="n">flatten</span><span class="p">((</span><span class="n">xi</span><span class="p">,</span> <span class="n">wi</span><span class="p">)))</span>
<span class="n">sol</span>
</pre></div>

    </div>
</div>
</div>

</div>
<div class="cell border-box-sizing text_cell rendered"><div class="prompt input_prompt">
</div><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>Določili smo seznam dveh (enakih) rešitev.</p>
<p>Najprej sta definirani vozlišči: $x_0=-\sqrt{3}/3$ in $x_1=\sqrt{3}/3$, katerima pripadata uteži $w_0=w_1=1$.</p>
<p>Koda zgoraj je izpeljana v splošnem - število vozlišč <code>v</code> lahko povečate ter izračunate vozlišča ter pripadajoče uteži.</p>

</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="prompt input_prompt">
</div><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>Spodaj je podana tabela vozlišč in uteži za eno, dve in tri vozlišča (za meje $a=-1$, $b=1$):</p>
<p><strong>Število točk 1:</strong></p>
<table>
<thead><tr>
<th style="text-align:center">$i$</th>
<th style="text-align:center">Vozlišče  $x_i$</th>
<th style="text-align:center">Utež $w_i$</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:center">0</td>
<td style="text-align:center">0</td>
<td style="text-align:center">2</td>
</tr>
</tbody>
</table>
<p><strong>Število točk 2:</strong></p>
<table>
<thead><tr>
<th style="text-align:center">$i$</th>
<th style="text-align:center">Vozlišče  $x_i$</th>
<th style="text-align:center">Utež $w_i$</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:center">0</td>
<td style="text-align:center">$-\frac{\sqrt{3}}{3}$</td>
<td style="text-align:center">1</td>
</tr>
<tr>
<td style="text-align:center">1</td>
<td style="text-align:center">$+\frac{\sqrt{3}}{3}$</td>
<td style="text-align:center">1</td>
</tr>
</tbody>
</table>

</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="prompt input_prompt">
</div><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p><strong>Število točk 3:</strong></p>
<table>
<thead><tr>
<th style="text-align:center">$i$</th>
<th style="text-align:center">Vozlišče  $x_i$</th>
<th style="text-align:center">Utež $w_i$</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:center">0</td>
<td style="text-align:center">$-\frac{\sqrt{15}}{5}$</td>
<td style="text-align:center">$\frac{5}{9}$</td>
</tr>
<tr>
<td style="text-align:center">1</td>
<td style="text-align:center">$0$</td>
<td style="text-align:center">$\frac{8}{9}$</td>
</tr>
<tr>
<td style="text-align:center">2</td>
<td style="text-align:center">$\frac{\sqrt{15}}{5}$</td>
<td style="text-align:center">$\frac{5}{9}$</td>
</tr>
</tbody>
</table>
<p>Za več vozlišč in tudi oceno napake, glejte <a href="http://mathworld.wolfram.com/Legendre-GaussQuadrature.html">Mathworld  Legendre-Gauss Quadrature</a>.</p>

</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="prompt input_prompt">
</div><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>Za primer treh Gaussovih točk numerični integral izračunamo (standardne meje):</p>
$$I_{\textrm{Gauss3}}= \frac{5}{9}\,f\left(-\frac{\sqrt{15}}{5}\right) + \frac{8}{9}\,f\left(0\right)+\frac{5}{9}\,f\left(\frac{\sqrt{15}}{5}\right).$$
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="prompt input_prompt">
</div><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h3 id="Numeri&#269;na-implementacija">Numeri&#269;na implementacija<a class="anchor-link" href="#Numeri&#269;na-implementacija">&#182;</a></h3>
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="prompt input_prompt">
</div><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>Numerična implementacija (vključno s transformacijo mej) za eno, dve ali tri vozlišča:</p>

</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In&nbsp;[&nbsp;]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="k">def</span> <span class="nf">Gaussova</span><span class="p">(</span><span class="n">fun</span><span class="p">,</span> <span class="n">a</span><span class="p">,</span> <span class="n">b</span><span class="p">,</span> <span class="n">vozlišč</span><span class="o">=</span><span class="mi">1</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot; </span>
<span class="sd">    Gaussova integracijska metoda.</span>

<span class="sd">    :param fun: objekt funkcije, ki jo integriramo</span>
<span class="sd">    :param a:   spodnja meja</span>
<span class="sd">    :param b:   zgornja meja</span>
<span class="sd">    :param vozlišča: število vozlišč (1, 2 ali 3)</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">def</span> <span class="nf">g</span><span class="p">(</span><span class="n">xi</span><span class="p">):</span> <span class="c1"># funkcija za transformacijo mej</span>
        <span class="k">return</span> <span class="p">(</span><span class="n">b</span><span class="o">-</span><span class="n">a</span><span class="p">)</span><span class="o">/</span><span class="mi">2</span> <span class="o">*</span> <span class="n">fun</span><span class="p">((</span><span class="n">b</span><span class="o">+</span><span class="n">a</span> <span class="o">+</span><span class="n">xi</span> <span class="o">*</span> <span class="p">(</span><span class="n">b</span><span class="o">-</span><span class="n">a</span><span class="p">))</span><span class="o">/</span><span class="mi">2</span><span class="p">)</span>
    
    <span class="k">if</span> <span class="n">vozlišč</span> <span class="o">==</span> <span class="mi">1</span><span class="p">:</span>
        <span class="k">return</span> <span class="mi">2</span><span class="o">*</span><span class="n">g</span><span class="p">(</span><span class="mf">0.</span><span class="p">)</span>
    <span class="k">elif</span> <span class="n">vozlišč</span> <span class="o">==</span> <span class="mi">2</span><span class="p">:</span>
        <span class="k">return</span> <span class="mf">1.</span> <span class="o">*</span> <span class="n">g</span><span class="p">(</span><span class="o">-</span><span class="n">np</span><span class="o">.</span><span class="n">sqrt</span><span class="p">(</span><span class="mi">3</span><span class="p">)</span><span class="o">/</span><span class="mi">3</span><span class="p">)</span> <span class="o">+</span> <span class="mf">1.</span> <span class="o">*</span> <span class="n">g</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">sqrt</span><span class="p">(</span><span class="mi">3</span><span class="p">)</span><span class="o">/</span><span class="mi">3</span><span class="p">)</span>        
    <span class="k">elif</span> <span class="n">vozlišč</span> <span class="o">==</span> <span class="mi">3</span><span class="p">:</span>
        <span class="k">return</span> <span class="mi">5</span><span class="o">/</span><span class="mi">9</span> <span class="o">*</span> <span class="n">g</span><span class="p">(</span><span class="o">-</span><span class="n">np</span><span class="o">.</span><span class="n">sqrt</span><span class="p">(</span><span class="mi">15</span><span class="p">)</span><span class="o">/</span><span class="mi">5</span><span class="p">)</span> <span class="o">+</span><span class="mi">8</span><span class="o">/</span><span class="mi">9</span> <span class="o">*</span> <span class="n">g</span><span class="p">(</span><span class="mf">0.</span><span class="p">)</span> <span class="o">+</span> <span class="mi">5</span><span class="o">/</span><span class="mi">9</span> <span class="o">*</span> <span class="n">g</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">sqrt</span><span class="p">(</span><span class="mi">15</span><span class="p">)</span><span class="o">/</span><span class="mi">5</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

</div>
<div class="cell border-box-sizing text_cell rendered"><div class="prompt input_prompt">
</div><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>Poglejmo si zgled. Najprej definirajmo funkcijo, ki jo želimo integrirati:</p>

</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In&nbsp;[&nbsp;]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="k">def</span> <span class="nf">f</span><span class="p">(</span><span class="n">x</span><span class="p">):</span>
    <span class="k">return</span> <span class="n">x</span><span class="o">*</span><span class="n">np</span><span class="o">.</span><span class="n">sin</span><span class="p">(</span><span class="n">x</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

</div>
<div class="cell border-box-sizing text_cell rendered"><div class="prompt input_prompt">
</div><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>Sedaj pa funkcijo (v konkretnem primeru <code>f</code>) in ne vrednosti (npr. <code>f(0.)</code>) posredujemo funkciji <code>Gaussova</code>. Najprej za eno vozlišče, nato dve in tri:</p>

</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In&nbsp;[&nbsp;]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">Gaussova</span><span class="p">(</span><span class="n">fun</span><span class="o">=</span><span class="n">f</span><span class="p">,</span> <span class="n">a</span><span class="o">=</span><span class="mf">1.</span><span class="p">,</span> <span class="n">b</span><span class="o">=</span><span class="mf">2.</span><span class="p">,</span> <span class="n">vozlišč</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In&nbsp;[&nbsp;]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">Gaussova</span><span class="p">(</span><span class="n">fun</span><span class="o">=</span><span class="n">f</span><span class="p">,</span> <span class="n">a</span><span class="o">=</span><span class="mf">1.</span><span class="p">,</span> <span class="n">b</span><span class="o">=</span><span class="mf">2.</span><span class="p">,</span> <span class="n">vozlišč</span><span class="o">=</span><span class="mi">2</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In&nbsp;[&nbsp;]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">Gaussova</span><span class="p">(</span><span class="n">fun</span><span class="o">=</span><span class="n">f</span><span class="p">,</span> <span class="n">a</span><span class="o">=</span><span class="mf">1.</span><span class="p">,</span> <span class="n">b</span><span class="o">=</span><span class="mf">2.</span><span class="p">,</span> <span class="n">vozlišč</span><span class="o">=</span><span class="mi">3</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

</div>
<div class="cell border-box-sizing text_cell rendered"><div class="prompt input_prompt">
</div><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h3 id="scipy.integrate.fixed_quad"><code>scipy.integrate.fixed_quad</code><a class="anchor-link" href="#scipy.integrate.fixed_quad">&#182;</a></h3><p>Znotraj <code>scipy</code> je Gaussova integracijska metoda implementirana v okviru funkcije <code>scipy.integrate.fixed_quad()</code> (<a href="https://docs.scipy.org/doc/scipy/reference/generated/scipy.integrate.fixed_quad.html">dokumentacija</a>):</p>
<div class="highlight"><pre><span></span><span class="n">fixed_quad</span><span class="p">(</span><span class="n">func</span><span class="p">,</span> <span class="n">a</span><span class="p">,</span> <span class="n">b</span><span class="p">,</span> <span class="n">args</span><span class="o">=</span><span class="p">(),</span> <span class="n">n</span><span class="o">=</span><span class="mi">5</span><span class="p">)</span>
</pre></div>
<p>kjer so parametri:</p>
<ul>
<li><code>func</code> je ime funkcije, ki jo kličemo,</li>
<li><code>a</code> je spodnja meja,</li>
<li><code>b</code> je zgornja meja,</li>
<li><code>args</code> je terka morebitnih dodatnih argumentov funkcije <code>func</code>,</li>
<li><code>n</code> je število vozlišč Gaussove integracije, privzeto <code>n=5</code>.</li>
</ul>
<p>Funkcija vrne terko z rezultatom integriranja <code>val</code> in vrednost <code>None</code>: <code>(val, None)</code></p>

</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="prompt input_prompt">
</div><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>Poglejmo primer od zgoraj:</p>

</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In&nbsp;[&nbsp;]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="kn">from</span> <span class="nn">scipy.integrate</span> <span class="kn">import</span> <span class="n">fixed_quad</span>
<span class="n">fixed_quad</span><span class="p">(</span><span class="n">f</span><span class="p">,</span> <span class="n">a</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">b</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span> <span class="n">n</span><span class="o">=</span><span class="mi">3</span><span class="p">)[</span><span class="mi">0</span><span class="p">]</span>
</pre></div>

    </div>
</div>
</div>

</div>
<div class="cell border-box-sizing text_cell rendered"><div class="prompt input_prompt">
</div><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>Rezultat je enak predhodnemu:</p>

</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In&nbsp;[&nbsp;]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">Gaussova</span><span class="p">(</span><span class="n">fun</span><span class="o">=</span><span class="n">f</span><span class="p">,</span> <span class="n">a</span><span class="o">=</span><span class="mf">1.</span><span class="p">,</span> <span class="n">b</span><span class="o">=</span><span class="mf">2.</span><span class="p">,</span> <span class="n">vozlišč</span><span class="o">=</span><span class="mi">3</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

</div>
<div class="cell border-box-sizing text_cell rendered"><div class="prompt input_prompt">
</div><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h1 id="scipy.integrate"><code>scipy.integrate</code><a class="anchor-link" href="#scipy.integrate">&#182;</a></h1>
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="prompt input_prompt">
</div><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p><code>scipy.integrate</code> je močno orodje za numerično integriranje (glejte <a href="https://docs.scipy.org/doc/scipy/reference/integrate.html">dokumentacijo</a>). V nadaljevanju si bomo pogledali nekatere funkcije.</p>
<h2 id="Intergracijske-funkcije,-ki-zahtevajo-definicijsko-funkcijo:">Intergracijske funkcije, ki zahtevajo definicijsko <em>funkcijo</em>:<a class="anchor-link" href="#Intergracijske-funkcije,-ki-zahtevajo-definicijsko-funkcijo:">&#182;</a></h2><ul>
<li><code>quad(func, a, b[, args, full_output, ...])</code>  izračuna določeni integral <code>func(x)</code> v mejah [<code>a</code>, <code>b</code>],</li>
<li><code>dblquad(func, a, b, gfun, hfun[, args, ...])</code>    izračuna določeni integral <code>func(x,y)</code>,</li>
<li><code>tplquad(func, a, b, gfun, hfun, qfun, rfun)</code> izračuna določeni integral <code>func(x,y,z)</code>,</li>
<li><code>nquad(func, ranges[, args, opts, full_output])</code>  izračuna določeni integral $n$ dimenzijske funkcije <code>func( ...)</code>,</li>
<li><code>romberg(function, a, b[, args, tol, rtol, ...])</code> integracija Romberg za funkcijo <code>function</code>,</li>
</ul>

</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="prompt input_prompt">
</div><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h3 id="scipy.integrate.quad"><code>scipy.integrate.quad</code><a class="anchor-link" href="#scipy.integrate.quad">&#182;</a></h3><p>Poglejmo si zelo uporabno funkcijo za integriranje, <code>scipy.integrate.quad()</code> (<a href="https://docs.scipy.org/doc/scipy/reference/generated/scipy.integrate.quad.html#scipy.integrate.quad">dokumentacija</a>):</p>
<div class="highlight"><pre><span></span><span class="n">quad</span><span class="p">(</span><span class="n">func</span><span class="p">,</span> <span class="n">a</span><span class="p">,</span> <span class="n">b</span><span class="p">,</span> <span class="n">args</span><span class="o">=</span><span class="p">(),</span> <span class="n">full_output</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">epsabs</span><span class="o">=</span><span class="mf">1.49e-08</span><span class="p">,</span> <span class="n">epsrel</span><span class="o">=</span><span class="mf">1.49e-08</span><span class="p">,</span> <span class="n">limit</span><span class="o">=</span><span class="mi">50</span><span class="p">,</span> 
     <span class="n">points</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">weight</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">wvar</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">wopts</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">maxp1</span><span class="o">=</span><span class="mi">50</span><span class="p">,</span> <span class="n">limlst</span><span class="o">=</span><span class="mi">50</span><span class="p">)</span>
</pre></div>
<p>Izbrani parametri so:</p>
<ul>
<li><code>func</code> Python funkcija, ki jo integriramo,</li>
<li><code>a</code> spodnja meja integriranja (lahko se uporabi <code>np.inf</code> za mejo v neskončnosti),</li>
<li><code>b</code> zgornja meja integriranja (lahko se uporabi <code>np.inf</code> za mejo v neskončnosti),</li>
<li><code>full_output</code> za prikaz vseh rezultatov, privzeto 0,</li>
<li><code>epsabs</code> dovoljena absolutna napaka,</li>
<li><code>epsrel</code> dovoljena relativna napaka.</li>
</ul>

</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="prompt input_prompt">
</div><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>Poglejmo primer od zgoraj:</p>

</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In&nbsp;[&nbsp;]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="kn">from</span> <span class="nn">scipy</span> <span class="kn">import</span> <span class="n">integrate</span>
</pre></div>

    </div>
</div>
</div>

</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In&nbsp;[&nbsp;]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">integrate</span><span class="o">.</span><span class="n">quad</span><span class="p">(</span><span class="n">f</span><span class="p">,</span> <span class="n">a</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">b</span><span class="o">=</span><span class="mi">2</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

</div>
<div class="cell border-box-sizing text_cell rendered"><div class="prompt input_prompt">
</div><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h3 id="scipy.integrate.dblquad"><code>scipy.integrate.dblquad</code><a class="anchor-link" href="#scipy.integrate.dblquad">&#182;</a></h3><p>Gre za podobno funkcijo kot <code>quad</code>, vendar za integriranje po dveh spremenljivkah (<a href="https://docs.scipy.org/doc/scipy/reference/generated/scipy.integrate.dblquad.html#scipy.integrate.dblquad">dokumentacija</a>).
Funkcija <code>scipy.integrate.dblquad()</code> izračuna dvojni integral <code>func(y, x)</code> v mejah od <code>x = [a, b]</code> in <code>y = [gfun(x), hfun(x)]</code>.</p>
<div class="highlight"><pre><span></span><span class="n">dblquad</span><span class="p">(</span><span class="n">func</span><span class="p">,</span> <span class="n">a</span><span class="p">,</span> <span class="n">b</span><span class="p">,</span> <span class="n">gfun</span><span class="p">,</span> <span class="n">hfun</span><span class="p">,</span> <span class="n">args</span><span class="o">=</span><span class="p">(),</span> <span class="n">epsabs</span><span class="o">=</span><span class="mf">1.49e-08</span><span class="p">,</span> <span class="n">epsrel</span><span class="o">=</span><span class="mf">1.49e-08</span><span class="p">)</span>
</pre></div>
<p>Izbrani parametri so:</p>
<ul>
<li><code>func</code> je Python funkcija, ki jo integriramo,</li>
<li><code>a</code> je spodnja meja integriranja <code>x</code> (lahko se uporabi <code>np.inf</code> za mejo v neskončnosti),</li>
<li><code>b</code> je zgornja meja integriranja <code>x</code> (lahko se uporabi <code>np.inf</code> za mejo v neskončnosti),</li>
<li><code>gfun</code> je Python funkcija, ki definira spodnjo mejo <code>y</code> v odvisnosti od <code>x</code>,</li>
<li><code>hfun</code> je Python funkcija, ki definira zgornjo mejo <code>y</code> v odvisnosti od <code>x</code>.</li>
</ul>

</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="prompt input_prompt">
</div><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>Poglejmo primer izračuna površine polkroga s polmerom 1:</p>
$$\int_{-1}^{1}\left(\int_0^{\sqrt{1-x^2}}1\,\textrm{d}y\right)\,\textrm{d}x=\frac{\pi}{2}$$
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="prompt input_prompt">
</div><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>Definirajmo ustrezne Python funkcije in izračunajmo rezultat:</p>

</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In&nbsp;[&nbsp;]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="k">def</span> <span class="nf">func</span><span class="p">(</span><span class="n">y</span><span class="p">,</span> <span class="n">x</span><span class="p">):</span> <span class="c1"># integracijska funkcija je enostavna, konstanta = 1!</span>
    <span class="k">return</span> <span class="mf">1.</span>
<span class="k">def</span> <span class="nf">gfun</span><span class="p">(</span><span class="n">x</span><span class="p">):</span>    <span class="c1"># spodnja meja = 0</span>
    <span class="k">return</span> <span class="mf">0.</span>
<span class="k">def</span> <span class="nf">hfun</span><span class="p">(</span><span class="n">x</span><span class="p">):</span>    <span class="c1"># zgornja meja</span>
    <span class="k">return</span> <span class="n">np</span><span class="o">.</span><span class="n">sqrt</span><span class="p">(</span><span class="mi">1</span><span class="o">-</span><span class="n">x</span><span class="o">**</span><span class="mi">2</span><span class="p">)</span>
<span class="n">integrate</span><span class="o">.</span><span class="n">dblquad</span><span class="p">(</span><span class="n">func</span><span class="o">=</span><span class="n">func</span><span class="p">,</span> <span class="n">a</span><span class="o">=-</span><span class="mi">1</span><span class="p">,</span> <span class="n">b</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">gfun</span><span class="o">=</span><span class="n">gfun</span><span class="p">,</span> <span class="n">hfun</span><span class="o">=</span><span class="n">hfun</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

</div>
<div class="cell border-box-sizing text_cell rendered"><div class="prompt input_prompt">
</div><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h2 id="Intergracijske-funkcije,-ki-zahtevajo-tabelo-vrednosti:">Intergracijske funkcije, ki zahtevajo tabelo vrednosti:<a class="anchor-link" href="#Intergracijske-funkcije,-ki-zahtevajo-tabelo-vrednosti:">&#182;</a></h2><ul>
<li><code>trapz(y[, x, dx, axis])</code> sestavljeno trapezno pravilo,</li>
<li><code>cumtrapz(y[, x, dx, axis, initial])</code> kumulativni integral podintegralske funkcije (vrne rezultat v vsakem vozlišču),</li>
<li><code>simps(y[, x, dx, axis, even])</code>   Simpsonova metoda,</li>
<li><code>romb(y[, dx, axis, show])</code>   Rombergova metoda.</li>
</ul>

</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="prompt input_prompt">
</div><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>Tukaj si bomo na primeru ogledali funkcijo <code>cumtrapz</code>. Kot primer si, ko na maso $m=1$ (enote izpustimo) deluje sila $F=\sin(t)$. Iz 2. Newtonovega zakona sledi: $F=m\,\ddot x$. Pospešek integriramo, da izračunamo hitrost; nato integriramo še enkrat za pomik. Definirajmo najprej funkcijo za pospešek:</p>

</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In&nbsp;[&nbsp;]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="k">def</span> <span class="nf">pospešek</span><span class="p">(</span><span class="n">t</span><span class="p">):</span>
    <span class="n">F</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">sin</span><span class="p">(</span><span class="n">t</span><span class="p">)</span>
    <span class="n">m</span> <span class="o">=</span> <span class="mi">1</span>
    <span class="k">return</span> <span class="n">F</span><span class="o">/</span><span class="n">m</span>
</pre></div>

    </div>
</div>
</div>

</div>
<div class="cell border-box-sizing text_cell rendered"><div class="prompt input_prompt">
</div><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>Zanima nas dogajanje v času 3 sekund:</p>

</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In&nbsp;[&nbsp;]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">t</span><span class="p">,</span> <span class="n">h</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">100</span><span class="p">,</span> <span class="n">retstep</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

</div>
<div class="cell border-box-sizing text_cell rendered"><div class="prompt input_prompt">
</div><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>Izračunajmo tabelo pospeškov ter nato integrirajmo za hitrost (pri tem je pomembno, da definiramo začetno vrednost):</p>

</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In&nbsp;[&nbsp;]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">a</span> <span class="o">=</span> <span class="n">pospešek</span><span class="p">(</span><span class="n">t</span><span class="p">)</span>
<span class="n">v</span> <span class="o">=</span> <span class="n">integrate</span><span class="o">.</span><span class="n">cumtrapz</span><span class="p">(</span><span class="n">y</span><span class="o">=</span><span class="n">a</span><span class="p">,</span> <span class="n">dx</span><span class="o">=</span><span class="n">h</span><span class="p">,</span> <span class="n">initial</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

</div>
<div class="cell border-box-sizing text_cell rendered"><div class="prompt input_prompt">
</div><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>Hitrost sedaj še enkrat integrirajmo, da izračunamo pot:</p>

</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In&nbsp;[&nbsp;]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">s</span> <span class="o">=</span> <span class="n">integrate</span><span class="o">.</span><span class="n">cumtrapz</span><span class="p">(</span><span class="n">y</span><span class="o">=</span><span class="n">v</span><span class="p">,</span> <span class="n">dx</span><span class="o">=</span><span class="n">h</span><span class="p">,</span> <span class="n">initial</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

</div>
<div class="cell border-box-sizing text_cell rendered"><div class="prompt input_prompt">
</div><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>Prikažimo rezultat:</p>

</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In&nbsp;[&nbsp;]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">t</span><span class="p">,</span> <span class="n">a</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s1">&#39;Pospesek&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">t</span><span class="p">,</span> <span class="n">v</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s1">&#39;Hitrost&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">t</span><span class="p">,</span> <span class="n">s</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s1">&#39;Pot&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">xlabel</span><span class="p">(</span><span class="s1">&#39;$t$ [s]&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">legend</span><span class="p">();</span>
</pre></div>

    </div>
</div>
</div>

</div>
<div class="cell border-box-sizing text_cell rendered"><div class="prompt input_prompt">
</div><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h1 id="Nekaj-vpra&#353;anj-za-razmislek!">Nekaj vpra&#353;anj za razmislek!<a class="anchor-link" href="#Nekaj-vpra&#353;anj-za-razmislek!">&#182;</a></h1>
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="prompt input_prompt">
</div><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<ol>
<li>Na sliki (vir: J. Slavič: Dinamika, meh. nihanja ..., 2014) je prikazan trikotnik s stranicami dolžine $a$, $b$, z debelino $h$ in gostoto $\rho$.
<img src="./fig/Slavic_2014_str_242_slika_5.4.png" width=200>
V simbolni obliki določite masni vztrajnostni moment glede na prikazano os $y$:
$$J_{yy}=\int_0^b y^2\,\rho\,h\,(a-a/b\,y)\,\textrm{d}y.$$
Upoštevajte tudi: $m=a\,b\,h\,\rho/2$. Za izmišljene vrednosti izračunajte numerični rezultat.</li>
<li>Izračunajte integral tudi numerično. Uporabite <code>scipy.integrate</code> in integrirajte glede na pravila: trapezno, Simpsonovo 1/3. Rezultat primerjajte tudi z Gaussovo kvadraturo.
Raziščite natančnost in hitrost metod.</li>
<li>Preštudirajte <code>scipy.special.legendre</code>, ki vam vrne objekt <code>orthopoly1d</code>. Ta objekt ima metodo <code>weights</code>, ki vrne seznam <code>[x, w, mu0]</code> vrednosti, ki jih uporabimo pri Gaussovi kvadraturi. (Če vsega ne razumete, ne skrbite preveč, bo asistent pokazal/komentiral). Opazite lahko, da smo vrednosti izpeljali na predavanjih!</li>
<li>S pomočjo zgoraj pridobljenih uteži in vozlišč izračunajte integral s pomočjo Gaussove kvadrature: $\sum_iw_i\,f(x_i)$. Pazite na transformacijo mej.</li>
<li>Preprost integral $\int_0^2x^2\,dx$ izrabite za prikaz trapeznega in Simpsonovega 1/3 pravila (osnovno pravilo, ne sestavljeno). Uteži izračunajte z uporabo <code>scipy</code>.</li>
<li>Integral predhodne točke razširite za sestavljeno trapezno pravilo (lastna koda). Prikažite vpliv števila podintervalov, primerjajte napako izračuna s predhodnim številom podintervalov in prikažite konvergenco.</li>
<li>Integral predhodne točke razširite za sestavljeno Simpsonovo 1/3 pravilo (lastna koda). Prikažite vpliv števila podintervalov, primerjajte napako izračuna s predhodnim številom podintervalov in prikažite konvergenco.</li>
<li>Z različnimi metodami izračunajte integrala (namig: vse metode niso primerne):
$$\int_1^2\frac{\sin(x)}{\sqrt{x}}.$$</li>
<li>S pomočjo numeričnega integriranja določite ekvivalentno silo porazdeljene obremenitve ($Q$) ter njeno prijemališče vzdolž nosilca ($x_Q$) dolžine $L = 2\,$m. Konstanta obremenitve: $q_0 = 5\,$kN/m.
<img src="./fig/nal-num_integriranje_1-1.jpg" width=350>
Rešitev: 
ekvivalentna obremenitev $Q = \int_0^L{q(x) \mathrm{d}x}$, pozicija (težišče) $x_Q = \frac{ \int_0^L{x\,q(x) \mathrm{d}x} }{ \int_0^L{q(x) \mathrm{d}x} }$</li>
</ol>

</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="prompt input_prompt">
</div><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h1 id="Dodatno">Dodatno<a class="anchor-link" href="#Dodatno">&#182;</a></h1>
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="prompt input_prompt">
</div><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<ol>
<li>Obravnavajte prikazan enoosni primer, obremenjen s porazdeljeno obremenitvijo $n(x)$ ter točkovno silo $F=10\,$kN. Dolžina palice je $L = 2\,$m, konstanta $n_0 = 15\,$kN/m in $EA = 200000\,\mathrm{MPa} \times 50×50\, \mathrm{mm^2}$.
<img src="./fig/nal-num_integriranje_2-2.jpg" width=350>
Naloga: <ol>
<li>S pomočjo simbolnega integriranja določite funkcijo notranje osne sile $N(x)$.</li>
<li>S pomočjo numeričnega integriranja izračunajte pomik prostega konca palice $u_0$.</li>
</ol>
</li>
</ol>

</div>
</div>
</div>
 


<script type="text/javascript">if (!document.getElementById('mathjaxscript_pelican_#%@#$@#')) {
    var mathjaxscript = document.createElement('script');
    mathjaxscript.id = 'mathjaxscript_pelican_#%@#$@#';
    mathjaxscript.type = 'text/javascript';
    mathjaxscript.src = '//cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.1/MathJax.js?config=TeX-AMS-MML_HTMLorMML';
    mathjaxscript[(window.opera ? "innerHTML" : "text")] =
        "MathJax.Hub.Config({" +
        "    config: ['MMLorHTML.js']," +
        "    TeX: { extensions: ['AMSmath.js','AMSsymbols.js','noErrors.js','noUndefined.js'], equationNumbers: { autoNumber: 'AMS' } }," +
        "    jax: ['input/TeX','input/MathML','output/HTML-CSS']," +
        "    extensions: ['tex2jax.js','mml2jax.js','MathMenu.js','MathZoom.js']," +
        "    displayAlign: 'center'," +
        "    displayIndent: '0em'," +
        "    showMathMenu: true," +
        "    tex2jax: { " +
        "        inlineMath: [ ['$','$'] ], " +
        "        displayMath: [ ['$$','$$'] ]," +
        "        processEscapes: true," +
        "        preview: 'TeX'," +
        "    }, " +
        "    'HTML-CSS': { " +
        " linebreaks: { automatic: true, width: '95% container' }, " +
        "        styles: { '.MathJax_Display, .MathJax .mo, .MathJax .mi, .MathJax .mn': {color: 'black ! important'} }" +
        "    } " +
        "}); ";
    (document.body || document.getElementsByTagName('head')[0]).appendChild(mathjaxscript);
}
</script>

        </div>

    </article>
</div>
        </div>
<!--
    <footer>
      <p>
        © 2012-2017 Janko Slavič, license <a href="https://github.com/jankoslavic/pypinm/blob/master/LICENSE"> </a>
        unless otherwise noted.
        Generated by <a href= "http://docs.getpelican.com/">Pelican</a>.
      </p>
    </footer>
-->
    </body>
</html>